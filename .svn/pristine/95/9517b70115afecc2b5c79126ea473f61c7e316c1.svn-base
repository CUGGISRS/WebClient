(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about"],{"0920":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("生产管理")]),r("el-breadcrumb-item",[e._v("加工批次管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("加工基地名称:")]),r("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择加工基地"},model:{value:e.params.baseId,callback:function(t){e.$set(e.params,"baseId",t)},expression:"params.baseId"}},e._l(e.productionBaseOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("div",{staticClass:"query-item"},[r("span",[e._v("追溯码:")]),r("el-input",{staticStyle:{width:"220px"},attrs:{clearable:"",placeholder:"请输入追溯码"},model:{value:e.params.productBatchNumber,callback:function(t){e.$set(e.params,"productBatchNumber",t)},expression:"params.productBatchNumber"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("开始时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择开始时间"},model:{value:e.params.startDateS,callback:function(t){e.$set(e.params,"startDateS",t)},expression:"params.startDateS"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("结束时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择结束时间"},model:{value:e.params.endDateE,callback:function(t){e.$set(e.params,"endDateE",t)},expression:"params.endDateE"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"加工基地名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getName(t.row.baseId))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"追溯码",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.productBatchNumber)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"开始时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.startDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"结束时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.endDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"加工数量",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.processAmount+e.getDictionaryName(t.row.processAmountUnit))+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"加工批次信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"120px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工基地名称:",prop:"baseId"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择加工基地"},model:{value:e.row.baseId,callback:function(t){e.$set(e.row,"baseId",t)},expression:"row.baseId"}},e._l(e.productionBaseOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"追溯码:"}},[r("el-input",{attrs:{readonly:"",placeholder:"自动生成追溯码"},model:{value:e.row.productBatchNumber,callback:function(t){e.$set(e.row,"productBatchNumber",t)},expression:"row.productBatchNumber"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开始时间:",prop:"startDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择开始时间"},model:{value:e.row.startDate,callback:function(t){e.$set(e.row,"startDate",t)},expression:"row.startDate"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"结束时间:",prop:"endDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择结束时间"},model:{value:e.row.endDate,callback:function(t){e.$set(e.row,"endDate",t)},expression:"row.endDate"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工数量:",prop:"processAmount"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入加工数量"},on:{blur:e.processAmountChange},model:{value:e.row.processAmount,callback:function(t){e.$set(e.row,"processAmount",t)},expression:"row.processAmount"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工数量单位:",prop:"processAmountUnit"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择加工数量单位"},model:{value:e.row.processAmountUnit,callback:function(t){e.$set(e.row,"processAmountUnit",t)},expression:"row.processAmountUnit"}},e._l(e.amountUnitOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工方式:",prop:"processAmount"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入加工方式"},model:{value:e.row.processWay,callback:function(t){e.$set(e.row,"processWay",t)},expression:"row.processWay"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工材料来源:",prop:"sourceRadio"}},[r("el-radio",{attrs:{label:1,disabled:e.isDisabled},model:{value:e.row.sourceRadio,callback:function(t){e.$set(e.row,"sourceRadio",t)},expression:"row.sourceRadio"}},[e._v("收获")]),r("el-radio",{attrs:{label:2,disabled:e.isDisabled},model:{value:e.row.sourceRadio,callback:function(t){e.$set(e.row,"sourceRadio",t)},expression:"row.sourceRadio"}},[e._v("收购")])],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"产品名称:"}},[r("el-select",{attrs:{disabled:1!==e.row.sourceRadio,clearable:"",placeholder:"请选择产品"},model:{value:e.row.harvestId,callback:function(t){e.$set(e.row,"harvestId",t)},expression:"row.harvestId"}},e._l(e.harvestOptions,(function(t){return r("el-option",{key:t.id,attrs:{label:e.getProductName(t.productId),value:t.id}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购物名称:"}},[r("el-select",{attrs:{disabled:2!==e.row.sourceRadio,clearable:"",placeholder:"请选择收购物"},model:{value:e.row.buyId,callback:function(t){e.$set(e.row,"buyId",t)},expression:"row.buyId"}},e._l(e.buyOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品名称:",prop:"productDetailId"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择商品"},model:{value:e.row.productDetailId,callback:function(t){e.$set(e.row,"productDetailId",t)},expression:"row.productDetailId"}},e._l(e.productDetailOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"产品加工",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleProcessPicturePreview,"on-remove":e.handleProcessPictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeProcessPicturePhoto,"file-list":e.fileProcessPictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogProcessPictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogProcessPictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogProcessPictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgProcessPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileProcessPictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("fb6a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){var e=this,t=function(t,r,a){r?1!==r||e.row.harvestId?2!==r||e.row.buyId?a():a(new Error("请选择收购物!")):a(new Error("请选择产品!")):a(new Error("请选择加工材料来源!"))};return{params:{page:null,limit:null,baseId:null,productBatchNumber:null,startDateS:null,endDateE:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},isDisabled:!1,rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,activeName:"first",dialogShow:!1,selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],picProcessPictureListPhoto:[],dialogProcessPictureImageUrl:"",dialogProcessPictureVisible:!1,imgProcessPictureLists:[],fileProcessPictureLists:[],productionBaseOptions:[],harvestOptions:[],buyOptions:[],productOptions:[],productDetailOptions:[],amountUnitOptions:[],rules:{baseId:[{required:!0,message:"请选择加工基地",trigger:"blur"}],startDate:[{required:!0,message:"请选择开始时间",trigger:"blur"}],endDate:[{required:!0,message:"请选择结束时间",trigger:"blur"}],processAmount:[{required:!0,message:"请输入加工数量",trigger:"blur"}],processAmountUnit:[{required:!0,message:"请选择加工数量单位",trigger:"blur"}],productDetailId:[{required:!0,message:"请选择商品",trigger:"blur"}],sourceRadio:[{required:!0,validator:t,trigger:"blur"}]}}},created:function(){var e=this;this.getAmountUnitDictionary(),this.getBaseDictionary(),this.getHarvestDictionary(),this.getBuytDictionary(),this.getProductDictionary(),this.getProductDetailDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAmountUnitDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"数量单位"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取数量单位失败！"}));case 6:e.amountUnitOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getBaseDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/BaseInfo/pageByEId",{params:{baseType:"加工基地",enterpriseId:window.sessionStorage.getItem("enterpriseId")}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取生产基地数据失败！"}));case 6:e.productionBaseOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getHarvestDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/Harvest/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取采收数据失败！"}));case 6:e.harvestOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getBuytDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/BuyInfo/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),sysModule:2}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取收购数据失败！"}));case 6:e.buyOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getProductDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/Product/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取产品数据失败！"}));case 6:e.productOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getProductDetailDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/ProductDetail/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),sysModule:2}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取商品数据失败！"}));case 6:e.productDetailOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/ProcessBatch/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取加工批次数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogProcessPictureImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleProcessPicturePreview:function(e){this.dialogProcessPictureImageUrl=e.url,this.dialogProcessPictureVisible=!0},handleProcessPictureRemove:function(e,t){for(var r in this.picProcessPictureListPhoto)this.picProcessPictureListPhoto[r].key===e.uid&&this.picProcessPictureListPhoto.splice(r,1);this.fileProcessPictureLists=t},handleChangeProcessPicturePhoto:function(e,t){this.fileProcessPictureLists=t},fileProcessPictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgProcessPictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.picProcessPictureListPhoto=[],this.imgProcessPictureLists=[],this.fileProcessPictureLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.isDisabled=!0,this.row.delFileIds=[],e.productBatchNumberPictureList&&0!==e.productBatchNumberPictureList.length){this.imgProcessPictureLists=e.productBatchNumberPictureList;for(var t=0;t<this.imgProcessPictureLists.length;t++)this.srcList.push(this.baseUrl+this.imgProcessPictureLists[t].url)}e.harvestId?this.$set(this.row,"sourceRadio",1):this.$set(this.row,"sourceRadio",2),this.dialogShow=!0,this.flag="edit"},addRow:function(){this.isDisabled=!1,this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/ProcessBatch/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除加工批次失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除加工批次成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;1===this.row.sourceRadio?this.row.buyId=null:this.row.harvestId=null,this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"productBatchNumberPictureList"===i||"sourceRadio"===i||null!==s&&a.append(i,s);if(null!=e.fileProcessPictureLists)for(n=0;n<e.fileProcessPictureLists.length;n++)a.append("productBatchNumberPictureFiles\t",e.fileProcessPictureLists[n].raw);if("add"!==e.flag){t.next=17;break}return t.next=8,e.$http.post("zsSys/ProcessBatch/addDataAndFile",a);case 8:if(o=t.sent,l=o.data,200===l.status){t.next=12;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增加工批次失败！"}));case 12:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增加工批次成功！"}),t.next=27;break;case 17:if("edit"!==e.flag){t.next=27;break}return t.next=20,e.$http.put("zsSys/ProcessBatch/updateDataAndFile",a);case 20:if(c=t.sent,u=c.data,200===u.status){t.next=24;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改加工批次失败！"}));case 24:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改加工批次成功！"});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},processAmountChange:function(e){this.$set(this.row,"processAmount",e.target.value)},getName:function(e){for(var t=0;t<this.productionBaseOptions.length;t++)if(e===this.productionBaseOptions[t].id)return this.productionBaseOptions[t].name},getProductName:function(e){for(var t=0;t<this.productOptions.length;t++)if(e===this.productOptions[t].id)return this.productOptions[t].name},getDictionaryName:function(e){for(var t=0;t<this.amountUnitOptions.length;t++)if(e===this.amountUnitOptions[t].code)return this.amountUnitOptions[t].name}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"9b2d1364",null);t["default"]=u.exports},"0f5f":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("生产管理")]),r("el-breadcrumb-item",[e._v("采收管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("产品名称:")]),r("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",clearable:"",placeholder:"请选择产品"},model:{value:e.params.productId,callback:function(t){e.$set(e.params,"productId",t)},expression:"params.productId"}},e._l(e.productOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("div",{staticClass:"query-item"},[r("span",[e._v("收获时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择收获时间"},model:{value:e.params.harvestDateS,callback:function(t){e.$set(e.params,"harvestDateS",t)},expression:"params.harvestDateS"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"产品名称","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getName(t.row.productId))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收购码",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.traceCode)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收获数量",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.harvestAmount+e.getDictionaryName(t.row.harvestAmountUnit))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收获方式",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.harvestWay)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收获时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.harvestDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"天气状况",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.weather)+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"采收信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"120px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"产品名称:",prop:"productId"}},[r("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择产品"},model:{value:e.row.productId,callback:function(t){e.$set(e.row,"productId",t)},expression:"row.productId"}},e._l(e.productOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获方式:",prop:"harvestWay"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择收获方式"},model:{value:e.row.harvestWay,callback:function(t){e.$set(e.row,"harvestWay",t)},expression:"row.harvestWay"}},e._l(e.harvestWayOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获数量:",prop:"harvestAmount"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入收获数量"},on:{blur:e.harvestAmountChange},model:{value:e.row.harvestAmount,callback:function(t){e.$set(e.row,"harvestAmount",t)},expression:"row.harvestAmount"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获数量单位:",prop:"harvestAmountUnit"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择收获数量单位"},model:{value:e.row.harvestAmountUnit,callback:function(t){e.$set(e.row,"harvestAmountUnit",t)},expression:"row.harvestAmountUnit"}},e._l(e.amountUnitOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获时间:",prop:"harvestDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择收获时间"},model:{value:e.row.harvestDate,callback:function(t){e.$set(e.row,"harvestDate",t)},expression:"row.harvestDate"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"天气状况:",prop:"weather"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入天气状况"},model:{value:e.row.weather,callback:function(t){e.$set(e.row,"weather",t)},expression:"row.weather"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购码:"}},[r("el-input",{attrs:{readonly:"",placeholder:"自动生成收购码"},model:{value:e.row.traceCode,callback:function(t){e.$set(e.row,"traceCode",t)},expression:"row.traceCode"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"收获图片",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleHarvestPicturePreview,"on-remove":e.handleHarvestPictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeHarvestPicturePhoto,"file-list":e.fileHarvestPictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogHarvestPictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogHarvestPictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogHarvestPictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgHarvestPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileHarvestPictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("fb6a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,productId:null,harvestDateS:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,activeName:"first",dialogShow:!1,selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],picHarvestPictureListPhoto:[],dialogHarvestPictureImageUrl:"",dialogHarvestPictureVisible:!1,imgHarvestPictureLists:[],fileHarvestPictureLists:[],amountUnitOptions:[],harvestWayOptions:["机器收割","人工收割"],productOptions:[],rules:{productId:[{required:!0,message:"请选择产品",trigger:"blur"}],harvestWay:[{required:!0,message:"请选择收获方式",trigger:"blur"}],harvestAmount:[{required:!0,message:"请输入收获数量",trigger:"blur"}],harvestAmountUnit:[{required:!0,message:"请选择收获数量单位",trigger:"blur"}],harvestDate:[{required:!0,message:"请选择收获时间",trigger:"blur"}]}}},created:function(){var e=this;this.getAmountUnitDictionary(),this.getProductDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAmountUnitDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"数量单位"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取数量单位失败！"}));case 6:e.amountUnitOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getProductDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/Product/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取产品数据失败！"}));case 6:e.productOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/Harvest/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取采收数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogHarvestPictureImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleHarvestPicturePreview:function(e){this.dialogHarvestPictureImageUrl=e.url,this.dialogHarvestPictureVisible=!0},handleHarvestPictureRemove:function(e,t){for(var r in this.picHarvestPictureListPhoto)this.picHarvestPictureListPhoto[r].key===e.uid&&this.picHarvestPictureListPhoto.splice(r,1);this.fileHarvestPictureLists=t},handleChangeHarvestPicturePhoto:function(e,t){this.fileHarvestPictureLists=t},fileHarvestPictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgHarvestPictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.picHarvestPictureListPhoto=[],this.imgHarvestPictureLists=[],this.fileHarvestPictureLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.row.delFileIds=[],e.harvestPictureList&&0!==e.harvestPictureList.length){this.imgHarvestPictureLists=e.harvestPictureList;for(var t=0;t<this.imgHarvestPictureLists.length;t++)this.srcList.push(this.baseUrl+this.imgHarvestPictureLists[t].url)}this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/Harvest/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除采收失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除采收成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"harvestPictureList"===i||null!==s&&a.append(i,s);if(null!=e.fileHarvestPictureLists)for(n=0;n<e.fileHarvestPictureLists.length;n++)a.append("harvestPictureFiles\t",e.fileHarvestPictureLists[n].raw);if("add"!==e.flag){t.next=17;break}return t.next=8,e.$http.post("zsSys/Harvest/addDataAndFile",a);case 8:if(o=t.sent,l=o.data,200===l.status){t.next=12;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增采收失败！"}));case 12:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增采收成功！"}),t.next=27;break;case 17:if("edit"!==e.flag){t.next=27;break}return t.next=20,e.$http.put("zsSys/Harvest/updateDataAndFile",a);case 20:if(c=t.sent,u=c.data,200===u.status){t.next=24;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改采收失败！"}));case 24:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改采收成功！"});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},harvestAmountChange:function(e){this.$set(this.row,"harvestAmount",e.target.value)},getName:function(e){for(var t=0;t<this.productOptions.length;t++)if(e===this.productOptions[t].id)return this.productOptions[t].name},getDictionaryName:function(e){for(var t=0;t<this.amountUnitOptions.length;t++)if(e===this.amountUnitOptions[t].code)return this.amountUnitOptions[t].name}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"c28c1186",null);t["default"]=u.exports},1099:function(e,t,r){},1276:function(e,t,r){"use strict";var a=r("d784"),i=r("44e7"),s=r("825a"),n=r("1d80"),o=r("4840"),l=r("8aa5"),c=r("50c4"),u=r("14c3"),d=r("9263"),p=r("d039"),h=[].push,g=Math.min,m=4294967295,f=!p((function(){return!RegExp(m,"y")}));a("split",2,(function(e,t,r){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,r){var a=String(n(this)),s=void 0===r?m:r>>>0;if(0===s)return[];if(void 0===e)return[a];if(!i(e))return t.call(a,e,s);var o,l,c,u=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,f=new RegExp(e.source,p+"g");while(o=d.call(f,a)){if(l=f.lastIndex,l>g&&(u.push(a.slice(g,o.index)),o.length>1&&o.index<a.length&&h.apply(u,o.slice(1)),c=o[0].length,g=l,u.length>=s))break;f.lastIndex===o.index&&f.lastIndex++}return g===a.length?!c&&f.test("")||u.push(""):u.push(a.slice(g)),u.length>s?u.slice(0,s):u}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t,[function(t,r){var i=n(this),s=void 0==t?void 0:t[e];return void 0!==s?s.call(t,i,r):a.call(String(i),t,r)},function(e,i){var n=r(a,e,this,i,a!==t);if(n.done)return n.value;var d=s(e),p=String(this),h=o(d,RegExp),b=d.unicode,w=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(f?"y":"g"),v=new h(f?d:"^(?:"+d.source+")",w),y=void 0===i?m:i>>>0;if(0===y)return[];if(0===p.length)return null===u(v,p)?[p]:[];var _=0,P=0,x=[];while(P<p.length){v.lastIndex=f?P:0;var k,L=u(v,f?p:p.slice(P));if(null===L||(k=g(c(v.lastIndex+(f?0:P)),p.length))===_)P=l(p,P,b);else{if(x.push(p.slice(_,P)),x.length===y)return x;for(var C=1;C<=L.length-1;C++)if(x.push(L[C]),x.length===y)return x;P=_=k}}return x.push(p.slice(_)),x}]}),!f)},"14c3":function(e,t,r){var a=r("c6b6"),i=r("9263");e.exports=function(e,t){var r=e.exec;if("function"===typeof r){var s=r.call(e,t);if("object"!==typeof s)throw TypeError("RegExp exec method returned something other than an Object or null");return s}if("RegExp"!==a(e))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(e,t)}},1892:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("产品管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("产品名称:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入产品名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("开始时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择开始时间"},model:{value:e.params.startDateS,callback:function(t){e.$set(e.params,"startDateS",t)},expression:"params.startDateS"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("结束时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择结束时间"},model:{value:e.params.endDateE,callback:function(t){e.$set(e.params,"endDateE",t)},expression:"params.endDateE"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")]),r("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-setting"},on:{click:e.showProductSetting}},[e._v("商品配置")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"产品名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"种植基地名称","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getBaseName(t.row.baseId))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"开始时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.startDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"结束时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.endDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品详情",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{staticStyle:{cursor:"pointer"},attrs:{effect:"dark"},on:{click:function(r){return e.showDetail(t.row.productDetailId)}}},[e._v(" "+e._s(e.getProductName(t.row.productDetailId))+" ")])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"产品信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"110px",rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"产品名称:",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入产品名称"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"基地名称:",prop:"baseId"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择种植基地"},model:{value:e.row.baseId,callback:function(t){e.$set(e.row,"baseId",t)},expression:"row.baseId"}},e._l(e.plantingBaseOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开始时间:",prop:"startDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择开始时间"},model:{value:e.row.startDate,callback:function(t){e.$set(e.row,"startDate",t)},expression:"row.startDate"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"结束时间:",prop:"endDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择结束时间"},model:{value:e.row.endDate,callback:function(t){e.$set(e.row,"endDate",t)},expression:"row.endDate"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品选择:",prop:"productDetailId"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择商品"},model:{value:e.row.productDetailId,callback:function(t){e.$set(e.row,"productDetailId",t)},expression:"row.productDetailId"}},e._l(e.productRows,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"商品配置",center:"",visible:e.dialogProductRowsShow,width:"1000px"},on:{close:e.closeProductRowsDialog,"update:visible":function(t){e.dialogProductRowsShow=t}}},[r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addProductRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteProductList}},[e._v("删除")])],1),r("el-table",{ref:"myTable2",attrs:{data:e.productRows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight2},on:{"selection-change":e.handleSelectionChange2}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.productCurrentPage-1)*e.productPageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editProductRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品条码",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.code)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"商品类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getDictionaryName(t.row.type))+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.productCurrentPage,"page-sizes":[10,20,30,40],"page-size":e.productPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.productTotal},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"商品详情",center:"",visible:e.dialogProductShow,width:"1000px"},on:{close:e.closeProductDialog,"update:visible":function(t){e.dialogProductShow=t}}},[r("el-form",{ref:"productRow",staticClass:"demo-ruleForm",attrs:{model:e.productRow,"label-width":"110px",rules:e.rules2}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品名称:",prop:"name"}},[r("el-input",{attrs:{readonly:e.isReadonly,clearable:"",maxlength:"50",placeholder:"请输入商品名称"},model:{value:e.productRow.name,callback:function(t){e.$set(e.productRow,"name",t)},expression:"productRow.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品类型:",prop:"type"}},[r("el-select",{attrs:{readonly:e.isReadonly,clearable:"",placeholder:"请选择商品类型"},model:{value:e.productRow.type,callback:function(t){e.$set(e.productRow,"type",t)},expression:"productRow.type"}},e._l(e.typeOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品条码:",prop:"code"}},[r("el-input",{attrs:{readonly:e.isReadonly,clearable:"",maxlength:"50",placeholder:"请输入商品条码"},model:{value:e.productRow.code,callback:function(t){e.$set(e.productRow,"code",t)},expression:"productRow.code"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品规格:",prop:"specs"}},[r("el-input",{attrs:{readonly:e.isReadonly,clearable:"",maxlength:"50",placeholder:"请输入商品规格"},model:{value:e.productRow.specs,callback:function(t){e.$set(e.productRow,"specs",t)},expression:"productRow.specs"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品用途:",prop:"purpose"}},[r("el-input",{attrs:{readonly:e.isReadonly,clearable:"",maxlength:"50",placeholder:"请输入商品用途"},model:{value:e.productRow.purpose,callback:function(t){e.$set(e.productRow,"purpose",t)},expression:"productRow.purpose"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品保质期:",prop:"shelfLife"}},[r("el-input",{attrs:{readonly:e.isReadonly,clearable:"",maxlength:"50",placeholder:"请输入商品保质期"},model:{value:e.productRow.shelfLife,callback:function(t){e.$set(e.productRow,"shelfLife",t)},expression:"productRow.shelfLife"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"商品介绍:",prop:"introduce"}},[r("el-input",{attrs:{readonly:e.isReadonly,type:"textarea",rows:2,placeholder:"请输入商品介绍",maxlength:"255"},model:{value:e.productRow.introduce,callback:function(t){e.$set(e.productRow,"introduce",t)},expression:"productRow.introduce"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"商品图片",name:"second"}},[r("el-upload",{style:{display:e.visible},attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleProductPicturePreview,"on-remove":e.handleProductPictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeProductPicturePhoto,"file-list":e.fileProductPictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogProductPictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogProductPictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogProductPictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgProductPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top",style:{display:e.visible2}},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileProductPictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1),r("el-tab-pane",{attrs:{label:"商品证书",name:"third"}},[r("el-upload",{style:{display:e.visible},attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest02,"list-type":"picture-card","on-preview":e.handleProductCertificatePreview,"on-remove":e.handleProductCertificateRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeProductCertificatePhoto,"file-list":e.fileProductCertificateLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogProductCertificateVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogProductCertificateVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogProductCertificateImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgProductCertificateLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top",style:{display:e.visible2}},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileProductCertificateDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList02}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{style:{display:e.visible},attrs:{type:"info"},on:{click:function(t){e.dialogProductShow=!1}}},[e._v("取 消")]),r("el-button",{style:{display:e.visible},attrs:{type:"success"},on:{click:e.submitProductRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("fb6a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,name:null,startDateS:null,endDateE:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},params2:{page:null,limit:null,sysModule:2,enterpriseId:window.sessionStorage.getItem("enterpriseId")},rows:[],row:{},productRows:[],productRow:{},flag:"",flag2:"",currentPage:1,total:0,pageSize:20,productCurrentPage:1,productTotal:0,productPageSize:10,curHeight:0,curHeight2:0,activeName:"first",dialogShow:!1,dialogProductRowsShow:!1,dialogProductShow:!1,isReadonly:!1,visible:"inline",visible2:"block",selectRows:[],selectRows2:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],srcList02:[],picProductPictureListPhoto:[],dialogProductPictureImageUrl:"",dialogProductPictureVisible:!1,imgProductPictureLists:[],fileProductPictureLists:[],picProductCertificateListPhoto:[],dialogProductCertificateImageUrl:"",dialogProductCertificateVisible:!1,imgProductCertificateLists:[],fileProductCertificateLists:[],plantingBaseOptions:[],typeOptions:[],rules:{name:[{required:!0,message:"请输入产品名称",trigger:"blur"}],baseId:[{required:!0,message:"请选择种植基地",trigger:"blur"}],startDate:[{required:!0,message:"请选择开始时间",trigger:"blur"}],endDate:[{required:!0,message:"请选择结束时间",trigger:"blur"}],productDetailId:[{required:!0,message:"请选择商品",trigger:"blur"}]},rules2:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],type:[{required:!0,message:"请选择商品类型",trigger:"blur"}]}}},created:function(){var e=this;this.getTypeDictionary(),this.getBaseDictionary(),this.getAllList(),this.getAllProductList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getTypeDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"种植产品类型",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取产品类型失败！"}));case 6:e.typeOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getBaseDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/BaseInfo/pageByEId",{params:{baseType:"种植基地",enterpriseId:window.sessionStorage.getItem("enterpriseId")}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取种植基地数据失败！"}));case 6:e.plantingBaseOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/Product/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取产品数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},getAllProductList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params2.page=e.productCurrentPage,e.params2.limit=e.productPageSize,t.next=4,e.$http.get("zsSys/ProductDetail/pageByEId",{params:e.params2});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取商品数据失败！"}));case 8:e.productRows=a.data.rows,e.productTotal=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleSizeChange2:function(e){this.productPageSize=e,this.getAllProductList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},handleCurrentChange2:function(e){this.productCurrentPage=e,this.getAllProductList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380,this.curHeight2=e-520},handleSelectionChange:function(e){this.selectRows=e},handleSelectionChange2:function(e){this.selectRows2=e},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogProductPictureImageUrl=this.result}},httpRequest02:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogProductCertificateImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleProductPicturePreview:function(e){this.dialogProductPictureImageUrl=e.url,this.dialogProductPictureVisible=!0},handleProductPictureRemove:function(e,t){for(var r in this.picProductPictureListPhoto)this.picProductPictureListPhoto[r].key===e.uid&&this.picProductPictureListPhoto.splice(r,1);this.fileProductPictureLists=t},handleChangeProductPicturePhoto:function(e,t){this.fileProductPictureLists=t},fileProductPictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.productRow.delFileIds.push(t),r.imgProductPictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},handleProductCertificatePreview:function(e){this.dialogProductCertificateImageUrl=e.url,this.dialogProductCertificateVisible=!0},handleProductCertificateRemove:function(e,t){for(var r in this.picProductCertificateListPhoto)this.picProductCertificateListPhoto[r].key===e.uid&&this.picProductCertificateListPhoto.splice(r,1);this.fileProductCertificateLists=t},handleChangeProductCertificatePhoto:function(e,t){this.fileProductCertificateLists=t},fileProductCertificateDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.productRow.delFileIds.push(t),r.imgProductCertificateLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.getAllList(),this.$refs.row.clearValidate()},closeProductRowsDialog:function(){this.$refs.myTable2.clearSelection()},closeProductDialog:function(){this.productRow={},this.srcList=[],this.srcList02=[],this.picProductPictureListPhoto=[],this.picProductCertificateListPhoto=[],this.imgProductPictureLists=[],this.imgProductCertificateLists=[],this.fileProductPictureLists=[],this.fileProductCertificateLists=[],this.activeName="first",this.getAllProductList(),this.$refs.productRow.clearValidate()},showProductSetting:function(){this.dialogProductRowsShow=!0},showDetail:function(e){for(var t=0;t<this.productRows.length;t++)if(e===this.productRows[t].id){if(this.productRow=this.productRows[t],0!==this.productRows[t].pictureList.length){this.imgProductPictureLists=this.productRows[t].pictureList;for(var r=0;r<this.imgProductPictureLists.length;r++)this.srcList.push(this.baseUrl+this.imgProductPictureLists[r].url)}if(0!==this.productRows[t].certificateList.length){this.imgProductCertificateLists=this.productRows[t].certificateList;for(var a=0;a<this.imgProductCertificateLists.length;a++)this.srcList02.push(this.baseUrl+this.imgProductCertificateLists[a].url)}this.dialogProductShow=!0,this.visible="none",this.visible2="none",this.isReadonly=!0}},editRow:function(e){this.row=e,this.dialogShow=!0,this.flag="edit",void 0==this.getProductName(e.productDetailId)&&(this.row.productDetailId="")},editProductRow:function(e){if(this.visible="inline",this.visible2="block",this.isReadonly=!1,this.productRow=e,this.productRow.delFileIds=[],e.pictureList&&0!==e.pictureList.length){this.imgProductPictureLists=e.pictureList;for(var t=0;t<this.imgProductPictureLists.length;t++)this.srcList.push(this.baseUrl+this.imgProductPictureLists[t].url)}if(e.certificateList&&0!==e.certificateList.length){this.imgProductCertificateLists=e.certificateList;for(var r=0;r<this.imgProductCertificateLists.length;r++)this.srcList02.push(this.baseUrl+this.imgProductCertificateLists[r].url)}this.dialogProductShow=!0,this.flag2="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},addProductRow:function(){this.visible="inline",this.visible2="block",this.isReadonly=!1,this.dialogProductShow=!0,this.flag2="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/Product/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除产品失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除产品成功！"}),e.$refs.myTable.clearSelection(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},deleteProductList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows2.length;a++)i=e.selectRows2[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/ProductDetail/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除商品失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除商品成功！"}),e.$refs.myTable2.clearSelection(),e.getAllProductList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"pictureList"===i||null!==s&&a.append(i,s);if("add"!==e.flag){t.next=16;break}return t.next=7,e.$http.post("zsSys/Product/addDataAndFile",a);case 7:if(n=t.sent,o=n.data,200===o.status){t.next=11;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增产品失败！"}));case 11:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增产品成功！"}),t.next=26;break;case 16:if("edit"!==e.flag){t.next=26;break}return t.next=19,e.$http.put("zsSys/Product/updateDataAndFile",a);case 19:if(l=t.sent,c=l.data,200===c.status){t.next=23;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改产品失败！"}));case 23:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改产品成功！"});case 26:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),submitProductRow:Object(n["a"])((function(){var e=this;this.productRow.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.productRow.sysModule=2,this.$refs.productRow.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.productRow)s=e.productRow[i],"pictureList"===i||"certificateList"===i||null!==s&&a.append(i,s);if(null!=e.fileProductPictureLists)for(n=0;n<e.fileProductPictureLists.length;n++)a.append("pictureFiles",e.fileProductPictureLists[n].raw);if(null!=e.fileProductCertificateLists)for(o=0;o<e.fileProductCertificateLists.length;o++)a.append("certificateFiles",e.fileProductCertificateLists[o].raw);if("add"!==e.flag2){t.next=18;break}return t.next=9,e.$http.post("zsSys/ProductDetail/addDataAndFile",a);case 9:if(l=t.sent,c=l.data,200===c.status){t.next=13;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增商品失败！"}));case 13:e.getAllProductList(),e.dialogProductShow=!1,e.$message({duration:2e3,type:"success",message:"新增商品成功！"}),t.next=28;break;case 18:if("edit"!==e.flag2){t.next=28;break}return t.next=21,e.$http.put("zsSys/ProductDetail/updateDataAndFile",a);case 21:if(u=t.sent,d=u.data,200===d.status){t.next=25;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改商品失败！"}));case 25:e.getAllProductList(),e.dialogProductShow=!1,e.$message({duration:2e3,type:"success",message:"修改商品成功！"});case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},getDictionaryName:function(e){for(var t=0;t<this.typeOptions.length;t++)if(e===this.typeOptions[t].code)return this.typeOptions[t].name},getBaseName:function(e){for(var t=0;t<this.plantingBaseOptions.length;t++)if(e===this.plantingBaseOptions[t].id)return this.plantingBaseOptions[t].name},getProductName:function(e){for(var t=0;t<this.productRows.length;t++)if(e===this.productRows[t].id)return this.productRows[t].name}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"915f4d2a",null);t["default"]=u.exports},"1b48":function(e,t,r){},"1da1":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("d3b7");function a(e,t,r,a,i,s,n){try{var o=e[s](n),l=o.value}catch(c){return void r(c)}o.done?t(l):Promise.resolve(l).then(a,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,s){var n=e.apply(t,r);function o(e){a(n,i,s,o,l,"next",e)}function l(e){a(n,i,s,o,l,"throw",e)}o(void 0)}))}}},"1dde":function(e,t,r){var a=r("d039"),i=r("b622"),s=r("2d00"),n=i("species");e.exports=function(e){return s>=51||!a((function(){var t=[],r=t.constructor={};return r[n]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},"1feb":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"register_container"},[r("div",{staticClass:"register_box"},[e._m(0),r("el-form",{ref:"registerFormRef",staticClass:"register_form",style:e.curHeight,attrs:{model:e.registerForm,"label-width":"160px",rules:e.registerFormRules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"username",label:"用户名:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"由字母或数字组成，4-18位"},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"password",label:"密码:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50","show-password":"",placeholder:"由字母、数字组成，6-16位"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"checkPwd",label:"确认密码:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50","show-password":"",placeholder:"请再次输入密码"},model:{value:e.registerForm.checkPwd,callback:function(t){e.$set(e.registerForm,"checkPwd",t)},expression:"registerForm.checkPwd"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"name",label:"企业名称:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"由1-20个汉字组成"},model:{value:e.registerForm.name,callback:function(t){e.$set(e.registerForm,"name",t)},expression:"registerForm.name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"businessType",label:"企业类型:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择企业类型"},model:{value:e.registerForm.businessType,callback:function(t){e.$set(e.registerForm,"businessType",t)},expression:"registerForm.businessType"}},e._l(e.businessTypeOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"socialCode",label:"统一社会信用代码:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"由18位组成"},model:{value:e.registerForm.socialCode,callback:function(t){e.$set(e.registerForm,"socialCode",t)},expression:"registerForm.socialCode"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"district",label:"行政区规划:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择行政区"},model:{value:e.registerForm.district,callback:function(t){e.$set(e.registerForm,"district",t)},expression:"registerForm.district"}},e._l(e.districtOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"registerAddress",label:"注册地址:"}},[r("el-input",{attrs:{clearable:"",maxlength:"255",placeholder:"营业执照上的地址"},model:{value:e.registerForm.registerAddress,callback:function(t){e.$set(e.registerForm,"registerAddress",t)},expression:"registerForm.registerAddress"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"organizationForm",label:"组织形式:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择组织形式"},model:{value:e.registerForm.organizationForm,callback:function(t){e.$set(e.registerForm,"organizationForm",t)},expression:"registerForm.organizationForm"}},e._l(e.organizationFormOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"subjectAttribute",label:"主体属性:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择主体属性"},model:{value:e.registerForm.subjectAttribute,callback:function(t){e.$set(e.registerForm,"subjectAttribute",t)},expression:"registerForm.subjectAttribute"}},e._l(e.subjectAttributeOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"establishDate",label:"企业成立日期:"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"选择企业成立日期"},model:{value:e.registerForm.establishDate,callback:function(t){e.$set(e.registerForm,"establishDate",t)},expression:"registerForm.establishDate"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"registerMoney",label:"注册资金(万元):"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入注册资金",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')"},on:{blur:e.registerMoneyChange},model:{value:e.registerForm.registerMoney,callback:function(t){e.$set(e.registerForm,"registerMoney",t)},expression:"registerForm.registerMoney"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"contactPerson",label:"联系人:"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入联系人姓名"},model:{value:e.registerForm.contactPerson,callback:function(t){e.$set(e.registerForm,"contactPerson",t)},expression:"registerForm.contactPerson"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"phone",label:"联系人手机号:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入联系人手机号",onkeyup:"value=value.replace(/[^\\d]/g,'')"},on:{blur:e.phoneChange},model:{value:e.registerForm.phone,callback:function(t){e.$set(e.registerForm,"phone",t)},expression:"registerForm.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"mailbox",label:"电子邮箱:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入正确格式的邮箱"},model:{value:e.registerForm.mailbox,callback:function(t){e.$set(e.registerForm,"mailbox",t)},expression:"registerForm.mailbox"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"deputyName",label:"法定代表人姓名:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入法定代表人姓名"},model:{value:e.registerForm.deputyName,callback:function(t){e.$set(e.registerForm,"deputyName",t)},expression:"registerForm.deputyName"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"deputyIdCard",label:"法定代表人身份证号:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"身份证号由18位组成"},model:{value:e.registerForm.deputyIdCard,callback:function(t){e.$set(e.registerForm,"deputyIdCard",t)},expression:"registerForm.deputyIdCard"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"deputyPhone",label:"法定代表人联系电话:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入法定代表人联系电话",onkeyup:"value=value.replace(/[^\\d]/g,'')"},on:{blur:e.deputyPhoneChange},model:{value:e.registerForm.deputyPhone,callback:function(t){e.$set(e.registerForm,"deputyPhone",t)},expression:"registerForm.deputyPhone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"postcode",label:"邮政编码:"}},[r("el-input",{attrs:{clearable:"",maxlength:"6",placeholder:"请输入邮政编码",onkeyup:"value=value.replace(/[^\\d]/g,'')"},on:{blur:e.postcodeChange},model:{value:e.registerForm.postcode,callback:function(t){e.$set(e.registerForm,"postcode",t)},expression:"registerForm.postcode"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"经纬度:",prop:"longitude"}},[r("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"longitude"}},[r("el-input",{staticStyle:{width:"120px"},attrs:{readonly:"",placeholder:"请选择经度"},on:{focus:e.showMap},model:{value:e.registerForm.longitude,callback:function(t){e.$set(e.registerForm,"longitude",t)},expression:"registerForm.longitude"}})],1),r("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"latitude"}},[r("el-input",{staticStyle:{width:"120px"},attrs:{readonly:"",placeholder:"请选择纬度"},on:{focus:e.showMap},model:{value:e.registerForm.latitude,callback:function(t){e.$set(e.registerForm,"latitude",t)},expression:"registerForm.latitude"}})],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-tabs",{staticStyle:{height:"220px"},attrs:{type:"border-card"}},[r("el-tab-pane",{staticClass:"register-upload",attrs:{label:"企业形象图"}},[r("el-form-item",{attrs:{prop:"file","label-width":"0"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.updateUrl,"show-file-list":!1,"http-request":e.httpRequest01,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),r("el-tab-pane",{attrs:{label:"营业执照"}},[r("el-form-item",{attrs:{prop:"file2","label-width":"0"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest02,"list-type":"picture-card","on-preview":e.handleBusinessLicensePreview,"on-remove":e.handleBusinessLicenseRemove,"before-upload":e.beforeAvatarUpload02,"on-change":e.handleChangeBusinessLicensePhoto,"file-list":e.fileBusinessLicenseLists}},[r("i",{staticClass:"el-icon-plus"})])],1)],1),r("el-tab-pane",{attrs:{label:"法人身份证照片(请上传身份证正面照片和反面照片)"}},[r("el-form-item",{attrs:{prop:"file3","label-width":"0"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest03,"list-type":"picture-card","on-preview":e.handleCorporateIdentityCardPreview,"on-remove":e.handleCorporateIdentityCardRemove,"before-upload":e.beforeAvatarUpload02,"on-change":e.handleChangeCorporateIdentityCardPhoto,"file-list":e.fileCorporateIdentityCardLists}},[r("i",{staticClass:"el-icon-plus"})])],1)],1)],1)],1)],1)],1),r("span",{staticClass:"register_btn"},[r("el-button",{attrs:{type:"info"},on:{click:e.resetForm}},[e._v("重置")]),r("el-button",{attrs:{type:"success"},on:{click:e.register}},[e._v("注册")])],1),r("el-dialog",{attrs:{visible:e.dialogBusinessLicenseVisible,width:"70%",top:"5vh"},on:{"update:visible":function(t){e.dialogBusinessLicenseVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogBusinessLicenseImageUrl}})]),r("el-dialog",{attrs:{visible:e.dialogCorporateIdentityCardVisible,width:"70%",top:"5vh"},on:{"update:visible":function(t){e.dialogCorporateIdentityCardVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogCorporateIdentityCardImageUrl}})]),r("el-dialog",{attrs:{title:"经纬度",center:"",visible:e.dialogMapVisible,width:"50%"},on:{"update:visible":function(t){e.dialogMapVisible=t}}},[r("div",{staticClass:"container"},[r("div",{staticClass:"search-box"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKey,expression:"searchKey"}],attrs:{type:"search",id:"search"},domProps:{value:e.searchKey},on:{input:function(t){t.target.composing||(e.searchKey=t.target.value)}}}),r("button",{on:{click:e.searchByHand}},[e._v("搜索")]),r("div",{staticClass:"tip-box",attrs:{id:"searchTip"}})]),r("el-amap",{staticClass:"amap-box",attrs:{"amap-manager":e.amapManager,vid:"amap-vue",zoom:e.zoom,center:e.center,plugin:e.plugin,events:e.events}},e._l(e.markers,(function(e,t){return r("el-amap-marker",{key:t,attrs:{position:e}})})),1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogMapVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.getCoordinate}},[e._v("确 定")])],1)])],1)])},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"register_top"},[r("h2",[e._v("企业用户注册")]),r("span")])}],s=(r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o=r("8f9b"),l=new o["AMapManager"],c={data:function(){var e=this,t=this,r=function(t,r,a){r!==e.registerForm.password?a(new Error("两次输入密码不一致!")):a()},a=function(e,t,r){t&&!Object(n["c"])(t)?r(new Error("手机号不正确!")):r()},i=function(e,t,r){t&&!Object(n["b"])(t)?r(new Error("身份证号码不正确!")):r()};return{curHeight:{height:"",width:"830px",overflow:"auto"},dialogMapVisible:!1,address:null,searchKey:"",amapManager:l,markers:[],searchOption:{city:"全国",citylimit:!0},center:[121.329402,31.228667],zoom:17,lng:0,lat:0,loaded:!1,events:{init:function(){o["lazyAMapApiLoaderInstance"].load().then((function(){t.initSearch()}))},click:function(e){t.markers=[];var r=e.lnglat,a=r.lng,i=r.lat;t.lng=a,t.lat=i,t.center=[a,i],t.markers.push([a,i]);var s=new AMap.Geocoder({radius:1e3,extensions:"all"});s.getAddress([a,i],(function(e,r){"complete"===e&&"OK"===r.info&&r&&r.regeocode&&(t.address=r.regeocode.formattedAddress,t.searchKey=r.regeocode.formattedAddress,t.$nextTick())}))}},plugin:[{pName:"Geolocation",events:{init:function(e){e.getCurrentPosition((function(e,r){r&&r.position&&(t.lng=r.position.lng,t.lat=r.position.lat,t.center=[t.lng,t.lat],t.markers.push([t.lng,t.lat]),t.loaded=!0,t.$nextTick())}))}}},{pName:"ToolBar"},{pName:"PlaceSearch"}],registerForm:{},updateUrl:"#",imageUrl:"",multfileImg:null,picBusinessLicenseListPhoto:[],dialogBusinessLicenseImageUrl:"",dialogBusinessLicenseVisible:!1,fileBusinessLicenseLists:[],picCorporateIdentityCardListPhoto:[],dialogCorporateIdentityCardImageUrl:"",dialogCorporateIdentityCardVisible:!1,fileCorporateIdentityCardLists:[],businessTypeOptions:[],organizationFormOptions:[],subjectAttributeOptions:[],districtOptions:[],registerFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:4,max:18,message:"长度在 4 到 18个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16个字符",trigger:"blur"}],checkPwd:[{required:!0,message:"请确认密码",trigger:"blur"},{required:!0,validator:r,trigger:"blur"}],name:[{required:!0,message:"请输入企业名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20个字符",trigger:"blur"}],businessType:[{required:!0,message:"请选择企业类型",trigger:"blur"}],socialCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"},{min:18,max:18,message:"长度为18个字符",trigger:"blur"}],district:[{required:!0,message:"请选择行政区规划",trigger:"blur"}],organizationForm:[{required:!0,message:"请选择组织形式",trigger:"blur"}],subjectAttribute:[{required:!0,message:"请选择主体属性",trigger:"blur"}],contactPerson:[{required:!0,message:"请输入联系人",trigger:"blur"}],phone:[{required:!0,message:"请输入联系人手机号",trigger:"blur"},{required:!0,validator:a,trigger:"blur"}],deputyName:[{required:!0,message:"请输入法定代表人姓名",trigger:"blur"}],deputyIdCard:[{validator:i,trigger:"blur"}],deputyPhone:[{validator:a,trigger:"blur"}],longitude:[{required:!0,message:"请输入经度",trigger:"change"}],latitude:[{required:!0,message:"请输入纬度",trigger:"change"}],file:[{required:!0,message:"请上传企业形象图片"}],file2:[{required:!0,message:"请上传营业执照图片"}],file3:[{required:!0,message:"请上传法人身份证照片"}]}}},created:function(){var e=this;this.getBusinessTypeDictionary(),this.getOrganizationFormDictionary(),this.getSubjectAttributeDictionary(),this.getDistrictDictionary(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getBusinessTypeDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"企业类型",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业类型失败！"}));case 6:e.businessTypeOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getOrganizationFormDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"企业组织形式",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业组织形式失败！"}));case 6:e.organizationFormOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getSubjectAttributeDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"企业主体属性",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业主体属性失败！"}));case 6:e.subjectAttributeOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getDistrictDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"镇乡"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取行政区规划失败！"}));case 6:e.districtOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight.height=e-160+"px"},showMap:function(){this.dialogMapVisible=!0},getCoordinate:function(){this.$set(this.registerForm,"longitude",this.lng),this.$set(this.registerForm,"latitude",this.lat),this.dialogMapVisible=!1},initSearch:function(){var e=this,t=this.amapManager.getMap();AMapUI.loadUI(["misc/PoiPicker"],(function(r){var a=new r({input:"search",placeSearchOptions:{map:t,pageSize:10},suggestContainer:"searchTip",searchResultsContainer:"searchTip"});e.poiPicker=a,a.on("poiPicked",(function(t){var r=t.source,i=t.item;if("search"!==r)a.searchByKeyword(i.name);else{a.clearSearchResults(),e.markers=[];var s=i.location.lng,n=i.location.lat,o=i.cityname+i.adname+i.name;e.center=[s,n],e.markers.push([s,n]),e.lng=s,e.lat=n,e.address=o,e.searchKey=o}}))}))},searchByHand:function(){""!==this.searchKey&&this.poiPicker.searchByKeyword(this.searchKey)},resetForm:function(){var e=this;this.$confirm("此操作将重置表单, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.imageUrl="",e.multfileImg=null,e.fileBusinessLicenseLists=[],e.fileCorporateIdentityCardLists=[],e.registerFormRules.file=[{required:!0,message:"请上传企业形象图片"}],e.registerFormRules.file2=[{required:!0,message:"请上传营业执照图片"}],e.registerFormRules.file3=[{required:!0,message:"请上传法人身份证照片"}],e.$refs.registerFormRef.resetFields()})).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},register:Object(n["a"])((function(){var e=this;this.registerForm.sysName="X2",this.$refs.registerFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("注册信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.registerForm)s=e.registerForm[i],"checkPwd"===i||null!==s&&a.append(i,s);if(null!=e.multfileImg&&a.append("enterpriseImageFiles",e.multfileImg),null!=e.fileBusinessLicenseLists)for(n=0;n<e.fileBusinessLicenseLists.length;n++)a.append("businessLicenseFiles",e.fileBusinessLicenseLists[n].raw);if(null!=e.fileCorporateIdentityCardLists)for(o=0;o<e.fileCorporateIdentityCardLists.length;o++)a.append("deputyIdCardPhotoFiles\t",e.fileCorporateIdentityCardLists[o].raw);return t.next=9,e.$http.post("zsSys/Enterprise/addDataAndFile",a).catch((function(t){e.$message.error(t.response.data.message)}));case 9:if(l=t.sent,c=l.data,200===c.status){t.next=13;break}return t.abrupt("return",e.$message.error(c.message));case 13:e.$http.get("zsSys/Enterprise/sendPromptSms?name=".concat(e.registerForm.name)),e.$message.success("注册成功，等待审核通过，由管理员通知！"),e.$router.push("/login");case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),beforeAvatarUpload:function(e){this.multfileImg=e;var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},beforeAvatarUpload02:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},httpRequest01:function(e){var t=this,r=new FileReader,a=e.file;r.readAsDataURL(a),r.onloadend=function(){t.imageUrl=this.result,null!=t.multfileImg&&(t.registerFormRules.file=[],t.$refs.registerFormRef.clearValidate("file"))}},httpRequest02:function(e){var t=this,r=new FileReader,a=e.file;r.readAsDataURL(a),r.onloadend=function(){t.dialogBusinessLicenseImageUrl=this.result,0!=t.fileBusinessLicenseLists.length&&(t.registerFormRules.file2=[],t.$refs.registerFormRef.clearValidate("file2"))}},httpRequest03:function(e){var t=this,r=new FileReader,a=e.file;r.readAsDataURL(a),r.onloadend=function(){t.dialogCorporateIdentityCardImageUrl=this.result,0!=t.fileCorporateIdentityCardLists.length&&(t.registerFormRules.file3=[],t.$refs.registerFormRef.clearValidate("file3"))}},handleBusinessLicensePreview:function(e){this.dialogBusinessLicenseImageUrl=e.url,this.dialogBusinessLicenseVisible=!0},handleBusinessLicenseRemove:function(e,t){for(var r in this.picBusinessLicenseListPhoto)this.picBusinessLicenseListPhoto[r].key===e.uid&&this.picBusinessLicenseListPhoto.splice(r,1);this.fileBusinessLicenseLists=t,0==this.fileBusinessLicenseLists.length&&(this.registerFormRules.file2=[{required:!0,message:"请上传营业执照图片"}])},handleChangeBusinessLicensePhoto:function(e,t){this.fileBusinessLicenseLists=t},handleCorporateIdentityCardPreview:function(e){this.dialogCorporateIdentityCardImageUrl=e.url,this.dialogCorporateIdentityCardVisible=!0},handleCorporateIdentityCardRemove:function(e,t){for(var r in this.picCorporateIdentityCardListPhoto)this.picCorporateIdentityCardListPhoto[r].key===e.uid&&this.picCorporateIdentityCardListPhoto.splice(r,1);this.fileCorporateIdentityCardLists=t,0==this.fileCorporateIdentityCardLists.length&&(this.registerFormRules.file3=[{required:!0,message:"请上传法人身份证照片"}])},handleChangeCorporateIdentityCardPhoto:function(e,t){this.fileCorporateIdentityCardLists=t},postcodeChange:function(e){this.$set(this.registerForm,"postcode",e.target.value)},deputyPhoneChange:function(e){this.$set(this.registerForm,"deputyPhone",e.target.value)},phoneChange:function(e){this.$set(this.registerForm,"phone",e.target.value)},registerMoneyChange:function(e){this.$set(this.registerForm,"registerMoney",e.target.value)}}},u=c,d=(r("27a6"),r("be7f"),r("2877")),p=Object(d["a"])(u,a,i,!1,null,"73c40502",null);t["default"]=p.exports},"20af":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("生产管理")]),r("el-breadcrumb-item",[e._v("检验报告")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("追溯码:")]),r("el-select",{staticStyle:{width:"240px"},attrs:{clearable:"",filterable:"",placeholder:"请选择追溯码"},model:{value:e.params.productBatchNumber,callback:function(t){e.$set(e.params,"productBatchNumber",t)},expression:"params.productBatchNumber"}},e._l(e.productBatchOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("div",{staticClass:"query-item"},[r("span",[e._v("检验时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择检验时间"},model:{value:e.params.testDateS,callback:function(t){e.$set(e.params,"testDateS",t)},expression:"params.testDateS"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("检验结果:")]),r("el-select",{staticStyle:{width:"160px"},attrs:{clearable:"",placeholder:"请选择检验结果"},model:{value:e.params.testResult,callback:function(t){e.$set(e.params,"testResult",t)},expression:"params.testResult"}},e._l(e.inspectionOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"追溯码","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.productBatchNumber)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"检验数量",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.testAmount+e.getDictionaryName(t.row.testAmountUnit))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"检验时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.testDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"检验结果",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return["合格"===t.row.testResult?r("el-tag",{attrs:{type:"success"}},[e._v("合格")]):r("el-tag",{attrs:{type:"danger"}},[e._v("未合格")])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"产品批次检验信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"120px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"追溯码:",prop:"productBatchNumber"}},[r("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择追溯码"},model:{value:e.row.productBatchNumber,callback:function(t){e.$set(e.row,"productBatchNumber",t)},expression:"row.productBatchNumber"}},e._l(e.productBatchOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"检验时间:",prop:"testDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择检验时间"},model:{value:e.row.testDate,callback:function(t){e.$set(e.row,"testDate",t)},expression:"row.testDate"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"检验数量:",prop:"testAmount"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入检验数量"},on:{blur:e.testAmountChange},model:{value:e.row.testAmount,callback:function(t){e.$set(e.row,"testAmount",t)},expression:"row.testAmount"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"检验数量单位:",prop:"testAmountUnit"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择检验数量单位"},model:{value:e.row.testAmountUnit,callback:function(t){e.$set(e.row,"testAmountUnit",t)},expression:"row.testAmountUnit"}},e._l(e.amountUnitOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"检验结果:",prop:"testResult"}},[r("el-radio",{attrs:{label:"合格"},model:{value:e.row.testResult,callback:function(t){e.$set(e.row,"testResult",t)},expression:"row.testResult"}},[e._v("合格")]),r("el-radio",{attrs:{label:"未合格"},model:{value:e.row.testResult,callback:function(t){e.$set(e.row,"testResult",t)},expression:"row.testResult"}},[e._v("未合格")])],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"检验结果",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleInspectionPicturePreview,"on-remove":e.handleInspectionPictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeInspectionPicturePhoto,"file-list":e.fileInspectionPictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogInspectionPictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogInspectionPictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogInspectionPictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgInspectionPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileInspectionPictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("fb6a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,productBatchNumber:null,testDateS:null,testResult:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,activeName:"first",dialogShow:!1,selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],picInspectionPictureListPhoto:[],dialogInspectionPictureImageUrl:"",dialogInspectionPictureVisible:!1,imgInspectionPictureLists:[],fileInspectionPictureLists:[],productBatchOptions:[],inspectionOptions:["合格","未合格"],amountUnitOptions:[],rules:{productBatchNumber:[{required:!0,message:"请选择追溯码",trigger:"blur"}],testDate:[{required:!0,message:"请选择检验时间",trigger:"blur"}],testAmount:[{required:!0,message:"请输入检验数量",trigger:"blur"}],testAmountUnit:[{required:!0,message:"请选择检验数量单位",trigger:"blur"}],testResult:[{required:!0,message:"请选择检验结果",trigger:"blur"}]}}},created:function(){var e=this;this.getAmountUnitDictionary(),this.getProductBatchDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAmountUnitDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"数量单位"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取数量单位失败！"}));case 6:e.amountUnitOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getProductBatchDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/ProcessBatch/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取追溯码数据失败！"}));case 6:for(i=0;i<a.data.rows.length;i++)e.productBatchOptions.push(a.data.rows[i].productBatchNumber);case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/FinishProductTest/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取检验数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogInspectionPictureImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleInspectionPicturePreview:function(e){this.dialogInspectionPictureImageUrl=e.url,this.dialogInspectionPictureVisible=!0},handleInspectionPictureRemove:function(e,t){for(var r in this.picInspectionPictureListPhoto)this.picInspectionPictureListPhoto[r].key===e.uid&&this.picInspectionPictureListPhoto.splice(r,1);this.fileInspectionPictureLists=t},handleChangeInspectionPicturePhoto:function(e,t){this.fileInspectionPictureLists=t},fileInspectionPictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgInspectionPictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.picInspectionPictureListPhoto=[],this.imgInspectionPictureLists=[],this.fileInspectionPictureLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.row.delFileIds=[],e.testResultPictureList&&0!==e.testResultPictureList.length){this.imgInspectionPictureLists=e.testResultPictureList;for(var t=0;t<this.imgInspectionPictureLists.length;t++)this.srcList.push(this.baseUrl+this.imgInspectionPictureLists[t].url)}this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/FinishProductTest/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除检验失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除检验成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"testResultPictureList"===i||null!==s&&a.append(i,s);if(null!=e.fileInspectionPictureLists)for(n=0;n<e.fileInspectionPictureLists.length;n++)a.append("testResultPictureFiles",e.fileInspectionPictureLists[n].raw);if("add"!==e.flag){t.next=17;break}return t.next=8,e.$http.post("zsSys/FinishProductTest/addDataAndFile",a);case 8:if(o=t.sent,l=o.data,200===l.status){t.next=12;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增检验失败！"}));case 12:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增检验成功！"}),t.next=27;break;case 17:if("edit"!==e.flag){t.next=27;break}return t.next=20,e.$http.put("zsSys/FinishProductTest/updateDataAndFile",a);case 20:if(c=t.sent,u=c.data,200===u.status){t.next=24;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改检验失败！"}));case 24:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改检验成功！"});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},testAmountChange:function(e){this.$set(this.row,"testAmount\t",e.target.value)},getDictionaryName:function(e){for(var t=0;t<this.amountUnitOptions.length;t++)if(e===this.amountUnitOptions[t].code)return this.amountUnitOptions[t].name}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"6110612c",null);t["default"]=u.exports},"25f0":function(e,t,r){"use strict";var a=r("6eeb"),i=r("825a"),s=r("d039"),n=r("ad6d"),o="toString",l=RegExp.prototype,c=l[o],u=s((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=o;(u||d)&&a(RegExp.prototype,o,(function(){var e=i(this),t=String(e.source),r=e.flags,a=String(void 0===r&&e instanceof RegExp&&!("flags"in l)?n.call(e):r);return"/"+t+"/"+a}),{unsafe:!0})},"27a6":function(e,t,r){"use strict";r("799a")},"2a0a":function(e,t,r){},"37bb":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("追溯查询")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("追溯来源:")]),r("el-select",{staticStyle:{width:"200px"},on:{change:e.changeSelect},model:{value:e.selectSource,callback:function(t){e.selectSource=t},expression:"selectSource"}},e._l(e.selectOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.selectSource?r("div",{staticClass:"query-item"},[r("span",[e._v("追溯码:")]),r("el-input",{staticStyle:{width:"220px"},attrs:{clearable:"",placeholder:"请输入追溯码"},model:{value:e.params.productBatchNumber,callback:function(t){e.$set(e.params,"productBatchNumber",t)},expression:"params.productBatchNumber"}})],1):r("div",{staticClass:"query-item"},[r("span",[e._v("收购码:")]),r("el-input",{staticStyle:{width:"220px"},attrs:{clearable:"",placeholder:"请输入收购码"},model:{value:e.params3.traceCode,callback:function(t){e.$set(e.params3,"traceCode",t)},expression:"params3.traceCode"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),e.selectSource?r("el-table",{attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight2}},[r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}],null,!1,3951453993)}),r("el-table-column",{attrs:{align:"center",label:"追溯码","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.productBatchNumber)+" ")]}}],null,!1,822915657)}),r("el-table-column",{attrs:{align:"center",label:"加工开始时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.startDate))+" ")]}}],null,!1,554553213)}),r("el-table-column",{attrs:{align:"center",label:"加工结束时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.endDate))+" ")]}}],null,!1,3005245202)}),r("el-table-column",{attrs:{align:"center",label:"追溯信息",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",icon:"el-icon-view",type:"success"},on:{click:function(r){return e.showRow(t.row.productBatchNumber)}}},[e._v("查看")])]}}],null,!1,1849560780)}),r("el-table-column",{attrs:{align:"center",label:"追溯二维码",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",icon:"el-icon-view",type:"success"},on:{click:function(r){return e.showQRCode(t.row.productBatchNumber)}}},[e._v("查看")])]}}],null,!1,740607400)})],1):r("el-table",{attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight2}},[r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收购码","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.traceCode)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"追溯信息",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",icon:"el-icon-view",type:"success"},on:{click:function(r){return e.showRow(t.row.traceCode)}}},[e._v("查看")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"追溯二维码",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",icon:"el-icon-view",type:"success"},on:{click:function(r){return e.showQRCode(t.row.traceCode)}}},[e._v("查看")])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"追溯信息",center:"",visible:e.dialogShow,top:"12vh",width:"80%"},on:{"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"160px"}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{style:e.curHeight,attrs:{label:"产品信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[e.selectSource?r("el-form-item",{attrs:{label:"追溯码:"}},[e._v(" "+e._s(e.row.aqzs_process_batch.productBatchNumber)+" ")]):r("el-form-item",{attrs:{label:"收购码:"}},[e._v(" "+e._s(e.row.aqzs_harvest.traceCode)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"产品名称:"}},[e._v(" "+e._s(e.row.aqzs_product.name)+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开始时间:"}},[e._v(" "+e._s(e.filterTime(e.row.aqzs_product.startDate))+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"结束时间:"}},[e._v(" "+e._s(e.filterTime(e.row.aqzs_product.endDate))+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品名称:"}},[e._v(" "+e._s(e.row.aqzs_product_detail.name)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品条码:"}},[e._v(" "+e._s(e.row.aqzs_product_detail.code)+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品类型:"}},[e._v(" "+e._s(e.getDictionaryName(e.row.aqzs_product_detail.type))+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品规格:"}},[e._v(" "+e._s(e.row.aqzs_product_detail.specs)+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品用途:"}},[e._v(" "+e._s(e.row.aqzs_product_detail.purpose)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"商品保质期:"}},[e._v(" "+e._s(e.row.aqzs_product_detail.shelfLife)+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"产品介绍:"}},[e._v(" "+e._s(e.row.aqzs_product_detail.introduce)+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"产品图片:"}},[0!==e.imgProductPictureLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgProductPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0):r("div",[e._v("暂无")])])],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"产品证书:"}},[0!==e.imgProductCertificateLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgProductCertificateLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList02}})],1)})),0):r("div",[e._v("暂无")])])],1)],1)],1),r("el-tab-pane",{style:e.curHeight,attrs:{label:"基地信息",name:"second"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植基地名称:"}},[e._v(" "+e._s(e.row.aqzs_base1.name)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植基地位置:"}},[e._v(" "+e._s(e.row.aqzs_base1.address)+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植基地面积/规模(亩):"}},[e._v(" "+e._s(e.row.aqzs_base1.area)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植环境检验结果:"}},[1===e.row.aqzs_base1.isReportQualified?r("el-tag",{attrs:{type:"success"}},[e._v("合格")]):0===e.row.aqzs_base1.isReportQualified?r("el-tag",{attrs:{type:"danger"}},[e._v("不合格")]):e._e()],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植基地负责人:"}},[e._v(" "+e._s(e.row.aqzs_base1.lender)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植基地负责人电话:"}},[e._v(" "+e._s(e.row.aqzs_base1.lenderPhone)+" ")])],1)],1),e.selectSource?r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地名称:"}},[e._v(" "+e._s(e.row.aqzs_base2.name)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地位置:"}},[e._v(" "+e._s(e.row.aqzs_base2.address)+" ")])],1)],1):e._e(),e.selectSource?r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地面积/规模(亩):"}},[e._v(" "+e._s(e.row.aqzs_base2.area)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地检验结果:"}},[1===e.row.aqzs_base2.isReportQualified?r("el-tag",{attrs:{type:"success"}},[e._v("合格")]):0===e.row.aqzs_base2.isReportQualified?r("el-tag",{attrs:{type:"danger"}},[e._v("不合格")]):e._e()],1)],1)],1):e._e(),e.selectSource?r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地负责人:"}},[e._v(" "+e._s(e.row.aqzs_base2.lender)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地负责人电话:"}},[e._v(" "+e._s(e.row.aqzs_base2.lenderPhone)+" ")])],1)],1):e._e(),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"种植基地照片:"}},[0!==e.imgPlantingBaseLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgPlantingBaseLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList09}})],1)})),0):r("div",[e._v("暂无")])])],1)],1),e.selectSource?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"生产基地照片:"}},[0!==e.imgProductionBaseLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgProductionBaseLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList10}})],1)})),0):r("div",[e._v("暂无")])])],1)],1):e._e(),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"种植基地检验报告:"}},[0!==e.imgPlantingInspectionReportLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgPlantingInspectionReportLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList03}})],1)})),0):r("div",[e._v("暂无")])])],1)],1),e.selectSource?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"生产基地检验报告:"}},[0!==e.imgProductionInspectionReportLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgProductionInspectionReportLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList04}})],1)})),0):r("div",[e._v("暂无")])])],1)],1):e._e()],1),r("el-tab-pane",{style:e.curHeight,attrs:{label:"基本作业信息",name:"third"}},[r("el-table",{attrs:{data:e.row.aqzs_base_work,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"}}},[r("el-table-column",{attrs:{align:"center",label:"作业类型",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getDictionaryName3(t.row.workType))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"使用物品名称",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.workObjectName)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"使用物品类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.workObjectType)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"使用物品来源","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.workObjectSource)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"使用物品数量",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.workObjectAmount+e.getDictionaryName2(t.row.workObjectAmountUnit))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"作业开始日期",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.startDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"作业结束日期",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.endDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"天气状况",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.weather)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"作业图片",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-view"},on:{click:function(r){return e.showPhoto(t.row.workPictureList)}}},[e._v("查看")])]}}])})],1)],1),r("el-tab-pane",{style:e.curHeight,attrs:{label:"生长环境信息",name:"fourth"}},[r("el-table",{attrs:{data:e.row.xph_device_sensor,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"}}},[r("el-table-column",{attrs:{align:"center",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"success",icon:"el-icon-view"},on:{click:function(r){return e.showSensorData(t.row)}}},[e._v("查看数据")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"传感器名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"传感器最新日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lastRecordTime)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"传感器最新数值"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lastRecordData+" "+t.row.unit)+" ")]}}])})],1)],1),r("el-tab-pane",{style:e.curHeight,attrs:{label:"生产作业信息",name:"fifth"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获方式:"}},[e._v(" "+e._s(e.row.aqzs_harvest.harvestWay)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获数量:"}},[e._v(" "+e._s(e.row.aqzs_harvest.harvestAmount+e.getDictionaryName2(e.row.aqzs_harvest.harvestAmountUnit))+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获时间:"}},[e._v(" "+e._s(e.filterTime(e.row.aqzs_harvest.harvestDate))+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"天气状况:"}},[e._v(" "+e._s(e.row.aqzs_harvest.weather)+" ")])],1)],1),r("div",{style:{display:e.visible}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购码:"}},[e._v(" "+e._s(e.row.aqzs_buy.traceCode)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购产品名称:"}},[e._v(" "+e._s(e.row.aqzs_buy.name)+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购总价(元):"}},[e._v(" "+e._s(e.row.aqzs_buy.buyTotal)+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收获数量:"}},[e._v(" "+e._s(e.row.aqzs_buy.buyAmount+e.getDictionaryName2(e.row.aqzs_buy.buyAmountUnit))+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购时间:"}},[e._v(" "+e._s(e.filterTime(e.row.aqzs_buy.buyDate))+" ")])],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"描述:"}},[e._v(" "+e._s(e.row.aqzs_buy.description)+" ")])],1)],1)],1),e.selectSource?r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工开始时间:"}},[e._v(" "+e._s(e.filterTime(e.row.aqzs_process_batch.startDate))+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工结束时间:"}},[e._v(" "+e._s(e.filterTime(e.row.aqzs_process_batch.endDate))+" ")])],1)],1):e._e(),e.selectSource?r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工数量:"}},[e._v(" "+e._s(e.row.aqzs_process_batch.processAmount+e.getDictionaryName2(e.row.aqzs_process_batch.processAmountUnit))+" ")])],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"加工方式:"}},[e._v(" "+e._s(e.row.aqzs_process_batch.processWay)+" ")])],1)],1):e._e(),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"采收图片:"}},[0!==e.imgHarvestPictureLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgHarvestPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList06}})],1)})),0):r("div",[e._v("暂无")])])],1)],1),e.selectSource?r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"加工图片:"}},[0!==e.imgProcessPictureLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgProcessPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList07}})],1)})),0):r("div",[e._v("暂无")])])],1)],1):e._e(),r("el-row",{style:{display:e.visible}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"收购图片:"}},[0!==e.imgBuyPictureLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgBuyPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList11}})],1)})),0):r("div",[e._v("暂无")])])],1)],1)],1),e.selectSource?r("el-tab-pane",{style:e.curHeight,attrs:{label:"检验结果信息",name:"sixth"}},[r("el-table",{attrs:{data:e.row.aqzs_finish_product_test,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"}}},[r("el-table-column",{attrs:{align:"center",label:"追溯码","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.productBatchNumber)+" ")]}}],null,!1,822915657)}),r("el-table-column",{attrs:{align:"center",label:"检验数量",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.testAmount+e.getDictionaryName2(t.row.testAmountUnit))+" ")]}}],null,!1,2531380074)}),r("el-table-column",{attrs:{align:"center",label:"检验日期",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.testDate))+" ")]}}],null,!1,275169067)}),r("el-table-column",{attrs:{align:"center",label:"检验结果",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.weather)+" "),"合格"===t.row.testResult?r("el-tag",{attrs:{type:"success"}},[e._v("合格")]):r("el-tag",{attrs:{type:"danger"}},[e._v("不合格")])]}}],null,!1,2036895726)}),r("el-table-column",{attrs:{align:"center",label:"检验图片",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-view"},on:{click:function(r){return e.showInspectionPhoto(t.row.testResultPictureList)}}},[e._v("查看")])]}}],null,!1,1630319505)})],1)],1):e._e(),e.selectSource?r("el-tab-pane",{style:e.curHeight,attrs:{label:"销售信息",name:"seventh"}},[r("el-table",{attrs:{data:e.row.aqzs_sale,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"}}},[r("el-table-column",{attrs:{align:"center",label:"订单编号",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.orderNumber)+" ")]}}],null,!1,2245704400)}),r("el-table-column",{attrs:{align:"center",label:"销售数量",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.saleAmount+e.getDictionaryName2(t.row.saleAmountUnit))+" ")]}}],null,!1,2261205738)}),r("el-table-column",{attrs:{align:"center",label:"销售商名称",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getName(t.row.sellerId))+" ")]}}],null,!1,276550433)}),r("el-table-column",{attrs:{align:"center",label:"发货时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.sendDate))+" ")]}}],null,!1,324153761)}),r("el-table-column",{attrs:{align:"center",label:"发货人",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.sender)+" ")]}}],null,!1,3917606198)}),r("el-table-column",{attrs:{align:"center",label:"收货人",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.receiver)+" ")]}}],null,!1,2166696068)}),r("el-table-column",{attrs:{align:"center",label:"始发地","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.startPlace,placement:"top"}},[r("span",[e._v(e._s(t.row.startPlace))])])]}}],null,!1,2765081774)}),r("el-table-column",{attrs:{align:"center",label:"目的地","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.endPlace,placement:"top"}},[r("span",[e._v(e._s(t.row.endPlace))])])]}}],null,!1,2782324686)})],1)],1):e._e()],1)],1)],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"传感器数据",center:"",visible:e.dialogSensorShow,width:"1000px",top:"10vh"},on:{"update:visible":function(t){e.dialogSensorShow=t}}},[r("el-table",{staticStyle:{"margin-top":"0"},attrs:{data:e.sensorRows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight2}},[r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.sensorCurrentPage-1)*e.sensorPageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.recordTime)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:e.name},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.recordData)+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.sensorCurrentPage,"page-sizes":[10,20,30,40],"page-size":e.sensorPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.sensorTotal},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1),r("el-dialog",{attrs:{center:"",title:"基本作业图片",visible:e.dialogOperationPictureVisible,width:"80%",top:"12vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogOperationPictureVisible=t}}},[0!==e.imgOperationPictureLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgOperationPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList05}})],1)})),0):r("div",{staticStyle:{"text-align":"center","font-size":"24px"}},[e._v("暂无")])]),r("el-dialog",{attrs:{center:"",title:"检验结果图片",visible:e.dialogInspectionPictureVisible,width:"80%",top:"12vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogInspectionPictureVisible=t}}},[0!==e.imgInspectionPictureLists.length?r("div",{staticClass:"upload-div"},e._l(e.imgInspectionPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList08}})],1)})),0):r("div",{staticStyle:{"text-align":"center","font-size":"24px"}},[e._v("暂无")])]),r("el-dialog",{attrs:{center:"",title:"追溯二维码图片",visible:e.dialogQRCodeVisible,width:"300px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogQRCodeVisible=t}}},[r("div",{ref:"qrCode",attrs:{id:"qrCode"}})])],1)},i=[],s=(r("99af"),r("fb6a"),r("b0c0"),r("96cf"),r("1da1")),n=r("d044"),o=r.n(n),l={data:function(){return{params:{page:null,limit:null,productBatchNumber:"",enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},params2:{recordTimeS:null,recordTimeE:null,interval:1,sensorId:null},params3:{page:null,limit:null,traceCode:"",enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},selectSource:!0,selectOptions:[{label:"加工追溯",value:!0},{label:"采收追溯",value:!1}],rows:[],row:{aqzs_product:{},aqzs_product_detail:{},aqzs_base1:{},aqzs_base2:{},aqzs_base_work:[],xph_device_sensor:[],aqzs_harvest:{},aqzs_buy:{},aqzs_process_batch:{},aqzs_finish_product_test:[],aqzs_sale:{}},sensorRows:[],sensorRow:{},name:"",sensorCurrentPage:1,sensorTotal:0,sensorPageSize:20,visible:"block",currentPage:1,total:0,pageSize:10,curHeight:{height:0,overflow:"auto"},curHeight2:0,activeName:"first",dialogShow:!1,dialogOperationPictureVisible:!1,dialogInspectionPictureVisible:!1,dialogQRCodeVisible:!1,dialogSensorShow:!1,baseUrl:this.$baseImgUrl,typeOptions:[],amountUnitOptions:[],baseOperationOptions:[],retailerOptions:[],imgProductPictureLists:[],srcList:[],imgProductCertificateLists:[],srcList02:[],imgPlantingInspectionReportLists:[],srcList03:[],imgPlantingBaseLists:[],srcList09:[],imgProductionInspectionReportLists:[],srcList04:[],imgProductionBaseLists:[],srcList10:[],imgOperationPictureLists:[],srcList05:[],imgHarvestPictureLists:[],srcList06:[],imgProcessPictureLists:[],srcList07:[],imgBuyPictureLists:[],srcList11:[],imgInspectionPictureLists:[],srcList08:[]}},created:function(){var e=this;this.getTypeDictionary(),this.getAmountUnitDictionary(),this.getBaseOperationDictionary(),this.getRetailerDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getTypeDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"种植产品类型",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取产品类型失败！"}));case 6:e.typeOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getAmountUnitDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"数量单位"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取数量单位失败！"}));case 6:e.amountUnitOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getBaseOperationDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"种植作业类型",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取种植作业类型失败！"}));case 6:e.baseOperationOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getRetailerDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/Seller/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId")}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取销售商数据失败！"}));case 6:e.retailerOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/ProcessBatch/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取追溯码失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},getAllList2:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params3.page=e.currentPage,e.params3.limit=e.pageSize,t.next=4,e.$http.get("zsSys/Harvest/pageByEId",{params:e.params3});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取收购码失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},changeSelect:function(e){this.currentPage=1,this.pageSize=10,this.total=0,this.rows=[],e?this.getAllList():this.getAllList2()},handleSizeChange:function(e){this.pageSize=e,this.selectSource?this.getAllList():this.getAllList2()},handleSizeChange2:function(e){this.sensorPageSize=e,this.getSensroData(this.sensorRow.id)},handleCurrentChange:function(e){this.currentPage=e,this.selectSource?this.getAllList():this.getAllList2()},handleCurrentChange2:function(e){this.sensorCurrentPage=e,this.getSensroData(this.sensorRow.id)},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight.height=e-400+"px",this.curHeight2=e-333},searchRow:function(){this.currentPage=1,this.selectSource?this.getAllList():this.getAllList2()},showRow:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,i,s,n,o,l,c,u,d,p,h;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.$message({message:"正在查看追溯信息，请稍等...",type:"success",duration:6e3}),t.srcList=[],t.srcList02=[],t.srcList03=[],t.srcList04=[],t.srcList06=[],t.srcList07=[],t.srcList09=[],t.srcList10=[],t.srcList11=[],t.imgProductPictureLists=[],t.imgProductCertificateLists=[],t.imgPlantingInspectionReportLists=[],t.imgPlantingBaseLists=[],t.imgProductionInspectionReportLists=[],t.imgProductionBaseLists=[],t.imgHarvestPictureLists=[],t.imgProcessPictureLists=[],t.imgBuyPictureLists=[],r.next=21,t.$http.get("zsSys/ProcessBatch/traceByPBN",{params:{productBatchNumber:e}});case 21:if(a=r.sent,i=a.data,200===i.status){r.next=25;break}return r.abrupt("return",t.$message({duration:1e3,type:"error",message:"获取追溯数据失败！"}));case 25:if(t.row=i.data,t.params2.startTime=i.data.aqzs_product.startDate,t.params2.endTime=i.data.aqzs_product.endDate,i.data.aqzs_buy||(t.row.aqzs_buy={},t.visible="none"),i.data.aqzs_product||(t.row.aqzs_product={}),i.data.aqzs_product_detail||(t.row.aqzs_product_detail={}),i.data.aqzs_base1||(t.row.aqzs_base1={}),i.data.aqzs_base2||(t.row.aqzs_base2={}),i.data.aqzs_harvest||(t.row.aqzs_harvest={}),i.data.aqzs_process_batch||(t.row.aqzs_process_batch={}),i.data.aqzs_sale||(t.row.aqzs_sale={}),i.data.aqzs_product_detail.pictureList&&0!==i.data.aqzs_product_detail.pictureList.length)for(t.imgProductPictureLists=i.data.aqzs_product_detail.pictureList,s=0;s<t.imgProductPictureLists.length;s++)t.srcList.push(t.baseUrl+t.imgProductPictureLists[s].url);if(i.data.aqzs_product_detail.certificateList&&0!==i.data.aqzs_product_detail.certificateList.length)for(t.imgProductCertificateLists=i.data.aqzs_product_detail.certificateList,n=0;n<t.imgProductCertificateLists.length;n++)t.srcList02.push(t.baseUrl+t.imgProductCertificateLists[n].url);if(i.data.aqzs_base1.reportPictureList&&0!==i.data.aqzs_base1.reportPictureList.length)for(t.imgPlantingInspectionReportLists=i.data.aqzs_base1.reportPictureList,o=0;o<t.imgPlantingInspectionReportLists.length;o++)t.srcList03.push(t.baseUrl+t.imgPlantingInspectionReportLists[o].url);if(i.data.aqzs_base1.basePictureList&&0!==i.data.aqzs_base1.basePictureList.length)for(t.imgPlantingBaseLists=i.data.aqzs_base1.basePictureList,l=0;l<t.imgPlantingBaseLists.length;l++)t.srcList09.push(t.baseUrl+t.imgPlantingBaseLists[l].url);if(i.data.aqzs_base2.reportPictureList&&0!==i.data.aqzs_base2.reportPictureList.length)for(t.imgProductionInspectionReportLists=i.data.aqzs_base2.reportPictureList,c=0;c<t.imgProductionInspectionReportLists.length;c++)t.srcList04.push(t.baseUrl+t.imgProductionInspectionReportLists[c].url);if(i.data.aqzs_base2.basePictureList&&0!==i.data.aqzs_base2.basePictureList.length)for(t.imgProductionBaseLists=i.data.aqzs_base2.basePictureList,u=0;u<t.imgProductionBaseLists.length;u++)t.srcList10.push(t.baseUrl+t.imgProductionBaseLists[u].url);if(i.data.aqzs_harvest.harvestPictureList&&0!==i.data.aqzs_harvest.harvestPictureList.length)for(t.imgHarvestPictureLists=i.data.aqzs_harvest.harvestPictureList,d=0;d<t.imgHarvestPictureLists.length;d++)t.srcList06.push(t.baseUrl+t.imgHarvestPictureLists[d].url);if(i.data.aqzs_process_batch.productBatchNumberPictureList&&0!==i.data.aqzs_process_batch.productBatchNumberPictureList.length)for(t.imgProcessPictureLists=i.data.aqzs_process_batch.productBatchNumberPictureList,p=0;p<t.imgProcessPictureLists.length;p++)t.srcList07.push(t.baseUrl+t.imgProcessPictureLists[p].url);if(i.data.aqzs_buy.buyPictureList&&0!==i.data.aqzs_buy.buyPictureList.length)for(t.imgBuyPictureLists=i.data.aqzs_buy.buyPictureList,h=0;h<t.imgBuyPictureLists.length;h++)t.srcList11.push(t.baseUrl+t.imgBuyPictureLists[h].url);t.activeName="first",t.dialogShow=!0;case 47:case"end":return r.stop()}}),r)})))()},getSensroData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.params2.page=t.sensorCurrentPage,t.params2.limit=t.sensorPageSize,t.params2.recordTimeS=t.row.aqzs_product.startDate,t.params2.recordTimeE=t.row.aqzs_product.endDate,t.params2.sensorId=e,r.next=7,t.$http.get("zsSys/DeviceSensorData/pageBySId",{params:t.params2});case 7:a=r.sent,i=a.data,t.sensorRows=i.data.rows,t.sensorTotal=i.data.total;case 11:case"end":return r.stop()}}),r)})))()},showSensorData:function(e){this.sensorRows=[],this.sensorRow=e,this.name=e.unit?"".concat(e.name,"(").concat(e.unit,")"):e.name,this.getSensroData(e.id),this.dialogSensorShow=!0},showPhoto:function(e){if(this.srcList05=[],this.imgOperationPictureLists=[],0!==e.length){this.imgOperationPictureLists=e;for(var t=0;t<this.imgOperationPictureLists.length;t++)this.srcList05.push(this.baseUrl+this.imgOperationPictureLists[t].url)}this.dialogOperationPictureVisible=!0},showInspectionPhoto:function(e){if(this.srcList08=[],this.imgInspectionPictureLists=[],0!==e.length){this.imgInspectionPictureLists=e;for(var t=0;t<this.imgInspectionPictureLists.length;t++)this.srcList08.push(this.baseUrl+this.imgInspectionPictureLists[t].url)}this.dialogInspectionPictureVisible=!0},showQRCode:function(e){var t=this;this.dialogQRCodeVisible=!0,this.$nextTick((function(){new o.a(t.$refs.qrCode,{text:t.$baseQrUrl+"zsxx_System/html/retrospect-detail/mobile-retrospect.html?"+e,width:200,height:200,colorDark:"#333333",colorLight:"#ffffff",correctLevel:o.a.CorrectLevel.L})}))},closeDialog:function(){this.$refs.qrCode.innerHTML=""},filterTime:function(e){return e?e.slice(0,10):e},getName:function(e){for(var t=0;t<this.retailerOptions.length;t++)if(e===this.retailerOptions[t].id)return this.retailerOptions[t].name},getDictionaryName:function(e){for(var t=0;t<this.typeOptions.length;t++)if(e===this.typeOptions[t].code)return this.typeOptions[t].name},getDictionaryName2:function(e){for(var t=0;t<this.amountUnitOptions.length;t++)if(e===this.amountUnitOptions[t].code)return this.amountUnitOptions[t].name},getDictionaryName3:function(e){for(var t=0;t<this.baseOperationOptions.length;t++)if(e===this.baseOperationOptions[t].code)return this.baseOperationOptions[t].name}}},c=l,u=(r("7562"),r("2877")),d=Object(u["a"])(c,a,i,!1,null,"061b0586",null);t["default"]=d.exports},"3a61":function(e,t,r){"use strict";r("cace")},"414f":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("种植管理")]),r("el-breadcrumb-item",[e._v("生长环境管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("产品名称:")]),r("el-select",{staticStyle:{width:"240px"},attrs:{filterable:"",clearable:"",placeholder:"请选择产品"},model:{value:e.params.productId,callback:function(t){e.$set(e.params,"productId",t)},expression:"params.productId"}},e._l(e.productOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",plain:"",type:"primary",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{size:"mini",plain:"",type:"warning",icon:"el-icon-view"},on:{click:function(r){return e.showSensorData(t.row)}}},[e._v("查看数据")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"产品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getName(t.row.productId))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"传感器名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.deviceSensor.name)+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"生长环境信息",center:"",visible:e.dialogShow,width:"800px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"120px",rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"产品名称:",prop:"productId"}},[r("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择产品"},model:{value:e.row.productId,callback:function(t){e.$set(e.row,"productId",t)},expression:"row.productId"}},e._l(e.productOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"分组名称:",prop:"groupId"}},[r("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择分组"},on:{change:e.changeGroup},model:{value:e.row.groupId,callback:function(t){e.$set(e.row,"groupId",t)},expression:"row.groupId"}},e._l(e.groupLists,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"传感器名称:",prop:"deviceSensorId"}},[r("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择传感器"},on:{change:e.updateData},model:{value:e.row.deviceSensorId,callback:function(t){e.$set(e.row,"deviceSensorId",t)},expression:"row.deviceSensorId"}},e._l(e.sensorLists,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"传感器数据",center:"",visible:e.dialogSensorShow,width:"1000px",top:"10vh"},on:{"update:visible":function(t){e.dialogSensorShow=t}}},[r("el-table",{staticStyle:{"margin-top":"0"},attrs:{data:e.sensorRows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight}},[r("el-table-column",{attrs:{align:"center",label:"序号",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.sensorCurrentPage-1)*e.sensorPageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.recordTime)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:e.name},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.recordData)+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.sensorCurrentPage,"page-sizes":[10,20,30,40],"page-size":e.sensorPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.sensorTotal},on:{"size-change":e.handleSizeChange2,"current-change":e.handleCurrentChange2}})],1)],1)},i=[],s=(r("99af"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,productId:null,deviceName:null,name:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},params2:{recordTimeS:null,recordTimeE:null,interval:1,sensorId:null},rows:[],row:{},flag:"",currentPage:1,pageSize:20,total:0,sensorRows:[],sensorRow:{},name:"",sensorCurrentPage:1,sensorPageSize:20,sensorTotal:0,curHeight:0,dialogShow:!1,dialogSensorShow:!1,selectRows:[],productOptions:[],groupLists:[],sensorLists:[],rules:{productId:[{required:!0,message:"请选择产品",trigger:"blur"}],groupId:[{required:!0,message:"请选择分组",trigger:"blur"}],deviceSensorId:[{required:!0,message:"请选择传感器",trigger:"blur"}]}}},created:function(){var e=this;this.getProductDictionary(),this.getAllList(),this.getAllGroup(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAllGroup:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/DeviceGroup/pageByCId",{params:{creatorId:window.sessionStorage.getItem("enterpriseId")}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取全部分组失败!"));case 6:e.groupLists=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},changeGroup:function(e){this.row.deviceSensorId=null,this.getSensorByGroupId(e)},getSensorByGroupId:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("zsSys/DeviceSensor/pageByGId",{params:{groupId:e,type:1}});case 2:if(a=r.sent,i=a.data,200===i.status){r.next=6;break}return r.abrupt("return",t.$message.error("获取传感器数据失败!"));case 6:t.sensorLists=i.data.rows;case 7:case"end":return r.stop()}}),r)})))()},getProductDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/Product/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取产品数据失败！"}));case 6:e.productOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/GrowEnvironment/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取生长环境数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},getSensroData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.params2.page=t.sensorCurrentPage,t.params2.limit=t.sensorPageSize,t.params2.sensorId=e,r.next=5,t.$http.get("zsSys/DeviceSensorData/pageBySId",{params:t.params2});case 5:a=r.sent,i=a.data,t.sensorRows=i.data.rows,t.sensorTotal=i.data.total;case 9:case"end":return r.stop()}}),r)})))()},showSensorData:function(e){this.sensorRows=[],this.sensorRow=e,this.name=e.deviceSensor.unit?"".concat(e.deviceSensor.name,"(").concat(e.deviceSensor.unit,")"):e.deviceSensor.name,this.getTime(e.productId),this.getSensroData(e.deviceSensorId),this.dialogSensorShow=!0},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleSizeChange2:function(e){this.sensorPageSize=e,this.getSensroData(this.sensorRow.deviceSensorId)},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},handleCurrentChange2:function(e){this.sensorCurrentPage=e,this.getSensroData(this.sensorRow.deviceSensorId)},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},closeDialog:function(){this.row={},this.sensorLists=[],this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){this.row=e,this.row.groupId=e.deviceSensor.groupId,this.getSensorByGroupId(this.row.groupId),this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/GrowEnvironment/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除生长环境失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除生长环境成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:if("add"!==e.flag){t.next=14;break}return t.next=5,e.$http.post("zsSys/GrowEnvironment",e.row);case 5:if(a=t.sent,i=a.data,200===i.status){t.next=9;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增生长环境失败！"}));case 9:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增生长环境成功！"}),t.next=24;break;case 14:if("edit"!==e.flag){t.next=24;break}return t.next=17,e.$http.put("zsSys/GrowEnvironment",e.row);case 17:if(s=t.sent,n=s.data,200===n.status){t.next=21;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改生长环境失败！"}));case 21:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改生长环境成功！"});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),getName:function(e){for(var t=0;t<this.productOptions.length;t++)if(e===this.productOptions[t].id)return this.productOptions[t].name},getTime:function(e){for(var t=0;t<this.productOptions.length;t++)e===this.productOptions[t].id&&(this.params2.recordTimeS=this.productOptions[t].startDate,this.params2.recordTimeE=this.productOptions[t].endDate)},updateData:function(){this.$forceUpdate()}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,null,null);t["default"]=u.exports},"44e7":function(e,t,r){var a=r("861d"),i=r("c6b6"),s=r("b622"),n=s("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[n])?!!t:"RegExp"==i(e))}},4751:function(e,t,r){"use strict";r("1b48")},"4c44":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("种植管理")]),r("el-breadcrumb-item",[e._v("基本作业管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("产品名称:")]),r("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"",clearable:"",placeholder:"请选择产品"},model:{value:e.params.productId,callback:function(t){e.$set(e.params,"productId",t)},expression:"params.productId"}},e._l(e.productOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("div",{staticClass:"query-item"},[r("span",[e._v("作业类型:")]),r("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择作业类型"},model:{value:e.params.workType,callback:function(t){e.$set(e.params,"workType",t)},expression:"params.workType"}},e._l(e.baseOperationOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1),r("div",{staticClass:"query-item"},[r("span",[e._v("作业开始日期:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date","picker-options":e.pickerStartDate,placeholder:"请选择开始日期"},model:{value:e.params.startDateS,callback:function(t){e.$set(e.params,"startDateS",t)},expression:"params.startDateS"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("作业结束日期:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date","picker-options":e.pickerCloseDate,placeholder:"请选择结束日期"},model:{value:e.params.endDateE,callback:function(t){e.$set(e.params,"endDateE",t)},expression:"params.endDateE"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"产品名称","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getName(t.row.productId))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"使用物品类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getDictionaryName2(t.row.workType))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"使用物品名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.workObjectName)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"使用物品数量",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.workObjectAmount+e.getDictionaryName(t.row.workObjectAmountUnit))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"作业开始时间",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.startDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"作业结束时间",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.endDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"天气状况",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.weather)+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"基本作业信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"160px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"产品名称:",prop:"productId"}},[r("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择产品"},model:{value:e.row.productId,callback:function(t){e.$set(e.row,"productId",t)},expression:"row.productId"}},e._l(e.productOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"作业类型:",prop:"workType"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择作业类型"},model:{value:e.row.workType,callback:function(t){e.$set(e.row,"workType",t)},expression:"row.workType"}},e._l(e.baseOperationOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"使用物品名称:",prop:"workObjectName"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入使用物品名称"},model:{value:e.row.workObjectName,callback:function(t){e.$set(e.row,"workObjectName",t)},expression:"row.workObjectName"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"使用物品类型:",prop:"workObjectType"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入使用物品类型"},model:{value:e.row.workObjectType,callback:function(t){e.$set(e.row,"workObjectType",t)},expression:"row.workObjectType"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"使用物品来源:",prop:"workObjectSource"}},[r("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入使用物品来源"},model:{value:e.row.workObjectSource,callback:function(t){e.$set(e.row,"workObjectSource",t)},expression:"row.workObjectSource"}},e._l(e.supplyOptions,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"天气状况:",prop:"weather"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入天气状况"},model:{value:e.row.weather,callback:function(t){e.$set(e.row,"weather",t)},expression:"row.weather"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"使用物品数量:",prop:"workObjectAmount"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入使用物品数量"},on:{blur:e.workObjectAmountChange},model:{value:e.row.workObjectAmount,callback:function(t){e.$set(e.row,"workObjectAmount",t)},expression:"row.workObjectAmount"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"数量单位:",prop:"workObjectAmountUnit"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择数量单位"},model:{value:e.row.workObjectAmountUnit,callback:function(t){e.$set(e.row,"workObjectAmountUnit",t)},expression:"row.workObjectAmountUnit"}},e._l(e.amountUnitOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"作业开始日期:",prop:"startDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择作业开始日期","picker-options":e.pickerStartDate2},model:{value:e.row.startDate,callback:function(t){e.$set(e.row,"startDate",t)},expression:"row.startDate"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"作业结束日期:",prop:"endDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择作业结束日期","picker-options":e.pickerCloseDate2},model:{value:e.row.endDate,callback:function(t){e.$set(e.row,"endDate",t)},expression:"row.endDate"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"作业图片",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleOperationPicturePreview,"on-remove":e.handleOperationPictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeOperationPicturePhoto,"file-list":e.fileOperationPictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogOperationPictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogOperationPictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogOperationPictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgOperationPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileOperationPictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("d81d"),r("fb6a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,productId:null,workType:null,startDateS:null,endDateE:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,activeName:"first",dialogShow:!1,selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],picOperationPictureListPhoto:[],dialogOperationPictureImageUrl:"",dialogOperationPictureVisible:!1,imgOperationPictureLists:[],fileOperationPictureLists:[],productOptions:[],baseOperationOptions:[],amountUnitOptions:[],rules:{productId:[{required:!0,message:"请选择产品",trigger:"blur"}],workType:[{required:!0,message:"请选择作业类型",trigger:"blur"}],workObjectName:[{required:!0,message:"请输入使用物品名称",trigger:"blur"}],workObjectType:[{required:!0,message:"请输入使用物品类型",trigger:"blur"}],workObjectSource:[{required:!0,message:"请输入使用物品来源",trigger:"blur"}],workObjectAmount:[{required:!0,message:"请输入使用物品数量",trigger:"blur"}],workObjectAmountUnit:[{required:!0,message:"请选择数量单位",trigger:"blur"}],startDate:[{required:!0,message:"请选择作业开始日期",trigger:"blur"}],endDate:[{required:!0,message:"请选择作业结束日期",trigger:"blur"}]},supplyOptions:[]}},created:function(){var e=this;this.getAmountUnitDictionary(),this.getBaseOperationDictionary(),this.getProductDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},computed:{pickerStartDate:function(){var e=this;return{disabledDate:function(t){if(e.params.endDateE&&""!==e.params.endDateE)return t.getTime()>new Date(e.params.endDateE).getTime()}}},pickerCloseDate:function(){var e=this;return{disabledDate:function(t){if(e.params.startDateS&&""!==e.params.startDateS)return t.getTime()+864e5<new Date(e.params.startDateS).getTime()}}},pickerStartDate2:function(){var e=this;return{disabledDate:function(t){if(e.row.endDate&&""!==e.row.endDate)return t.getTime()>new Date(e.row.endDate).getTime()}}},pickerCloseDate2:function(){var e=this;return{disabledDate:function(t){if(e.row.startDate&&""!==e.row.startDate)return t.getTime()+864e5<new Date(e.row.startDate).getTime()}}}},methods:{getAmountUnitDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"数量单位"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取数量单位失败！"}));case 6:e.amountUnitOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getBaseOperationDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"种植作业类型",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取种植作业类型失败！"}));case 6:e.baseOperationOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getProductDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/Product/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取产品数据失败！"}));case 6:e.productOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/BaseWork/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取基本作业数据失败！"}));case 8:return e.rows=a.data.rows,e.total=a.data.total,t.next=12,e.$http.get("zsSys/Supplier/pageByEId",{params:e.params});case 12:i=t.sent,s=i.data,200==s.status&&(e.supplyOptions=s.data.rows.map((function(e){return{value:e.id,label:e.name}})));case 15:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogOperationPictureImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleOperationPicturePreview:function(e){this.dialogOperationPictureImageUrl=e.url,this.dialogOperationPictureVisible=!0},handleOperationPictureRemove:function(e,t){for(var r in this.picOperationPictureListPhoto)this.picOperationPictureListPhoto[r].key===e.uid&&this.picOperationPictureListPhoto.splice(r,1);this.fileOperationPictureLists=t},handleChangeOperationPicturePhoto:function(e,t){this.fileOperationPictureLists=t},fileOperationPictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgOperationPictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.picOperationPictureListPhoto=[],this.imgOperationPictureLists=[],this.fileOperationPictureLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.row.delFileIds=[],e.workPictureList&&0!==e.workPictureList.length){this.imgOperationPictureLists=e.workPictureList;for(var t=0;t<this.imgOperationPictureLists.length;t++)this.srcList.push(this.baseUrl+this.imgOperationPictureLists[t].url)}this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/BaseWork/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除基本作业失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除基本作业成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"workPictureList"===i||null!==s&&a.append(i,s);if(null!=e.fileOperationPictureLists)for(n=0;n<e.fileOperationPictureLists.length;n++)a.append("workPictureFiles\t",e.fileOperationPictureLists[n].raw);if("add"!==e.flag){t.next=17;break}return t.next=8,e.$http.post("zsSys/BaseWork/addDataAndFile",a);case 8:if(o=t.sent,l=o.data,200===l.status){t.next=12;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增基本作业失败！"}));case 12:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增基本作业成功！"}),t.next=27;break;case 17:if("edit"!==e.flag){t.next=27;break}return t.next=20,e.$http.put("zsSys/BaseWork/updateDataAndFile",a);case 20:if(c=t.sent,u=c.data,200===u.status){t.next=24;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改基本作业失败！"}));case 24:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改基本作业成功！"});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},workObjectAmountChange:function(e){this.$set(this.row,"workObjectAmount",e.target.value)},getName:function(e){for(var t=0;t<this.productOptions.length;t++)if(e===this.productOptions[t].id)return this.productOptions[t].name},getDictionaryName:function(e){for(var t=0;t<this.amountUnitOptions.length;t++)if(e===this.amountUnitOptions[t].code)return this.amountUnitOptions[t].name},getDictionaryName2:function(e){for(var t=0;t<this.baseOperationOptions.length;t++)if(e===this.baseOperationOptions[t].code)return this.baseOperationOptions[t].name}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"21722735",null);t["default"]=u.exports},"4d63":function(e,t,r){var a=r("83ab"),i=r("da84"),s=r("94ca"),n=r("7156"),o=r("9bf2").f,l=r("241c").f,c=r("44e7"),u=r("ad6d"),d=r("9f7f"),p=r("6eeb"),h=r("d039"),g=r("69f3").set,m=r("2626"),f=r("b622"),b=f("match"),w=i.RegExp,v=w.prototype,y=/a/g,_=/a/g,P=new w(y)!==y,x=d.UNSUPPORTED_Y,k=a&&s("RegExp",!P||x||h((function(){return _[b]=!1,w(y)!=y||w(_)==_||"/a/i"!=w(y,"i")})));if(k){var L=function(e,t){var r,a=this instanceof L,i=c(e),s=void 0===t;if(!a&&i&&e.constructor===L&&s)return e;P?i&&!s&&(e=e.source):e instanceof L&&(s&&(t=u.call(e)),e=e.source),x&&(r=!!t&&t.indexOf("y")>-1,r&&(t=t.replace(/y/g,"")));var o=n(P?new w(e,t):w(e,t),a?this:v,L);return x&&r&&g(o,{sticky:r}),o},C=function(e){e in L||o(L,e,{configurable:!0,get:function(){return w[e]},set:function(t){w[e]=t}})},S=l(w),R=0;while(S.length>R)C(S[R++]);v.constructor=L,L.prototype=v,p(i,"RegExp",L)}m("RegExp")},"567f":function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return l}));r("4d63"),r("ac1f"),r("25f0");var a=function(e){var t=/^[1-9][0-9]/,r={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江 ",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北 ",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门"};return!(!t.test(e)||!r[e])},i=function(e){var t=/^(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)$/;if(t.test(e)){var r=e.substring(0,4),a=e.substring(4,6),i=e.substring(6,8),s=new Date(r+"-"+a+"-"+i);if(s&&s.getMonth()==parseInt(a)-1)return!0}return!1},s=function(e){var t=/^[1-9]\d{5}(18|19|20)\d{2}((0[1-9])|(1[0-2]))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,r=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],a=[1,0,"X",9,8,7,6,5,4,3,2],i=e.substring(17);if(t.test(e)){for(var s=0,n=0;n<17;n++)s+=e[n]*r[n];if(a[s%11]==i.toUpperCase())return!0}return!1};function n(e){if(s(e)){var t=e.substring(6,14);if(i(t)&&a(e.substring(0,2)))return!0}return!1}function o(e){var t=new RegExp(/^[1]([3-9])[0-9]{9}$/);return!!t.test(e)}var l=function(e,t){var r,a=t||1e3;return function(){var t=arguments;r&&clearTimeout(r);var i=!r;r=setTimeout((function(){r=null}),a),i&&e.apply(this,t)}}},"578a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login_container"},[r("div",{staticClass:"login_box"},[e._m(0),r("el-form",{ref:"loginFormRef",staticClass:"login_form",attrs:{model:e.loginForm,"label-width":"0",rules:e.loginFormRules}},[r("el-form-item",{attrs:{prop:"username"}},[r("span",{staticClass:"login_head_text"},[e._v("用户名:")]),r("el-input",{attrs:{"prefix-icon":"el-icon-user",placeholder:"请输入用户名"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),r("el-form-item",{attrs:{prop:"password"}},[r("span",{staticClass:"login_head_text"},[e._v("密 码:")]),r("el-input",{attrs:{"prefix-icon":"el-icon-lock","show-password":"",placeholder:"请输入密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),r("span",[r("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登 录")]),r("el-button",{attrs:{type:"primary"},on:{click:e.register}},[e._v("注 册")])],1)],1)],1),r("div",{staticClass:"login_footer"},[r("span",[r("span",{domProps:{innerHTML:e._s(e.foot1)}}),e._m(1),r("span",{domProps:{innerHTML:e._s(e.foot2)}}),e._m(2),r("span",{domProps:{innerHTML:e._s(e.foot3)}}),r("br"),r("p",{staticStyle:{"font-size":"12px"}},[e._v(" 地址：湖北监利市江城路69号 电话号码：0716-3300339 ")])])])])},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login_top"},[r("div",[e._v("监利市农产品质量安全追溯应用系统")]),r("div",[e._v("(种植企业版)")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a",{staticStyle:{display:"inline-block","text-decoration":"none",height:"20px","line-height":"20px"},attrs:{target:"_blank",href:"http://www.jianli.gov.cn/"}},[r("p",[e._v("监利市农业农村局")])])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a",{staticStyle:{display:"inline-block","text-decoration":"none",height:"20px","line-height":"20px"},attrs:{target:"_blank",href:"http://www.zd-tech.net/"}},[r("p",[e._v("武汉中迪联创科技有限公司")])])}],s=(r("96cf"),r("1da1")),n={data:function(){return{foot1:"Copyright  &copy; &nbsp;",foot2:"&nbsp;版权所有&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",foot3:"&nbsp;技术支持",loginForm:{},loginFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:4,max:18,message:"长度在 4 到 18个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}]}}},created:function(){var e=this;document.onkeydown=function(t){t=window.event||t,"/login"!=e.$route.path||13!=t.keyCode&&13!=t.which||e.login()}},methods:{login:function(){var e=this;this.loginForm.sysName="X2",this.$refs.loginFormRef.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.$http.post("comSys/login/user",e.loginForm);case 4:if(a=t.sent,i=a.data,200===i.status){t.next=8;break}return t.abrupt("return",e.$message.error(i.message));case 8:return e.$message({duration:1e3,type:"success",message:"登录成功！"}),t.next=11,window.sessionStorage.setItem("retrospectToken",i.data);case 11:return t.next=13,e.getList();case 13:e.$router.push("/home");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/getCurrentUser");case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message.error(a.message));case 6:return t.next=8,window.sessionStorage.setItem("enterpriseId",a.data.enterpriseId);case 8:return t.next=10,window.sessionStorage.setItem("userName",a.data.username);case 10:case"end":return t.stop()}}),t)})))()},register:function(){this.$router.push("/register")}}},o=n,l=(r("3a61"),r("2877")),c=Object(l["a"])(o,a,i,!1,null,"12ed6cc5",null);t["default"]=c.exports},"57da":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{staticClass:"home-container"},[r("el-header",{attrs:{height:"70px"}},[r("h2",[e._v("监利市农产品质量安全追溯应用系统（种植企业版）")]),r("div",{staticClass:"user-section"},[r("div",{staticClass:"user-name"},[e._v("用户："+e._s(e.userName))]),r("el-tooltip",{attrs:{effect:"light",content:"退出登录",placement:"left"}},[r("span",{staticClass:"iconfont icon-tuichu",on:{click:e.logout}})])],1)]),r("el-container",[r("el-aside",{attrs:{width:e.isCollapse?"64px":"300px"}},[r("div",{staticClass:"toggle-button",on:{click:e.toggleCollapse}},[e._v("|||")]),r("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":e.activePath,"background-color":"#333744","text-color":"#fff","active-text-color":"#409eff","unique-opened":"",collapse:e.isCollapse,"collapse-transition":!1,router:""}},[r("el-menu-item",{attrs:{index:"/user"},on:{click:function(t){return e.saveNavState("/user")}}},[r("i",{staticClass:"iconfont icon-qiyejibenxinxi"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("企业基本信息")])]),r("el-submenu",{attrs:{index:"1"}},[r("template",{slot:"title"},[r("i",{staticClass:"iconfont icon-icon"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("基本配置")])]),r("el-menu-item-group",[r("el-menu-item",{attrs:{index:"/qualification"},on:{click:function(t){return e.saveNavState("/qualification")}}},[e._v("企业资质管理")]),r("el-menu-item",{attrs:{index:"/retailer"},on:{click:function(t){return e.saveNavState("/retailer")}}},[e._v("销售商管理")]),r("el-menu-item",{attrs:{index:"/supply"},on:{click:function(t){return e.saveNavState("/supply")}}},[e._v("供应商管理")]),r("el-menu-item",{attrs:{index:"/plantingbase"},on:{click:function(t){return e.saveNavState("/plantingbase")}}},[e._v("种植基地管理")]),r("el-menu-item",{attrs:{index:"/productionbase"},on:{click:function(t){return e.saveNavState("/productionbase")}}},[e._v("生产基地管理")])],1)],2),r("el-menu-item",{attrs:{index:"/product"},on:{click:function(t){return e.saveNavState("/product")}}},[r("i",{staticClass:"iconfont icon-chanpinpeizhi"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("产品管理")])]),r("el-submenu",{attrs:{index:"/basicoperation"}},[r("template",{slot:"title"},[r("i",{staticClass:"iconfont icon-zhongzhi"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("种植管理")])]),r("el-menu-item-group",[r("el-menu-item",{attrs:{index:"/basicoperation"},on:{click:function(t){return e.saveNavState("/basicoperation")}}},[e._v("基本作业管理")]),r("el-menu-item",{attrs:{index:"/growingenviroment"},on:{click:function(t){return e.saveNavState("/growingenviroment")}}},[e._v("生长环境管理")])],1)],2),r("el-submenu",{attrs:{index:"/harvest"}},[r("template",{slot:"title"},[r("i",{staticClass:"iconfont icon-shengchanguanli"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("生产管理")])]),r("el-menu-item-group",[r("el-menu-item",{attrs:{index:"/harvest"},on:{click:function(t){return e.saveNavState("/harvest")}}},[e._v("采收管理")]),r("el-menu-item",{attrs:{index:"/buy"},on:{click:function(t){return e.saveNavState("/buy")}}},[e._v("收购管理")]),r("el-menu-item",{attrs:{index:"/processbatch"},on:{click:function(t){return e.saveNavState("/processbatch")}}},[e._v("加工批次管理")]),r("el-menu-item",{attrs:{index:"/inspection"},on:{click:function(t){return e.saveNavState("/inspection")}}},[e._v("检验报告")])],1)],2),r("el-menu-item",{attrs:{index:"/order"},on:{click:function(t){return e.saveNavState("/order")}}},[r("i",{staticClass:"iconfont icon-xiaoshouguanli_icox"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("销售管理")])]),r("el-menu-item",{attrs:{index:"/retrospect"},on:{click:function(t){return e.saveNavState("/retrospect")}}},[r("i",{staticClass:"iconfont icon-zhuisu"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("追溯管理")])]),r("el-menu-item",{attrs:{index:"/statistics"},on:{click:function(t){return e.saveNavState("/statistics")}}},[r("i",{staticClass:"iconfont icon-tongji"}),r("span",{attrs:{slot:"title"},slot:"title"},[e._v("统计详情")])])],1)],1),r("el-main",[r("router-view")],1)],1)],1)},i=[],s={data:function(){return{isCollapse:!1,activePath:"/user",userName:""}},created:function(){this.userName=window.sessionStorage.getItem("userName"),this.activePath=window.sessionStorage.getItem("activePath")?window.sessionStorage.getItem("activePath"):this.activePath},methods:{logout:function(){var e=this;this.$confirm("此操作将退出登录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.sessionStorage.clear(),e.$router.push("/login")})).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},toggleCollapse:function(){this.isCollapse=!this.isCollapse},saveNavState:function(e){window.sessionStorage.setItem("activePath",e),this.activePath=e}}},n=s,o=(r("638d"),r("2877")),l=Object(o["a"])(n,a,i,!1,null,"03431a9c",null);t["default"]=l.exports},"617a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("基本配置")]),r("el-breadcrumb-item",[e._v("种植基地管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("种植基地名称:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入种植基地名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"种植基地名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"基地面积/规模",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.area+"亩")+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"基地负责人",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lender)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"基地负责人电话",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lenderPhone)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"种植环境检验结果",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isReportQualified?r("el-tag",{attrs:{type:"success"}},[e._v("合格")]):r("el-tag",{attrs:{type:"danger"}},[e._v("不合格")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"种植基地位置","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.address,placement:"top"}},[r("span",[e._v(e._s(t.row.address))])])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"种植基地信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"150px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植基地名称:",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入种植基地名称"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植基地位置:",prop:"address"}},[r("el-input",{attrs:{clearable:"",maxlength:"255",placeholder:"请输入种植基地位置"},model:{value:e.row.address,callback:function(t){e.$set(e.row,"address",t)},expression:"row.address"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"基地面积/规模(亩):",prop:"area"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入基地面积/规模(亩)"},on:{blur:e.areaChange},model:{value:e.row.area,callback:function(t){e.$set(e.row,"area",t)},expression:"row.area"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"种植环境检验结果:",prop:"isReportQualified"}},[r("el-radio",{attrs:{label:1},model:{value:e.row.isReportQualified,callback:function(t){e.$set(e.row,"isReportQualified",t)},expression:"row.isReportQualified"}},[e._v("合格")]),r("el-radio",{attrs:{label:0},model:{value:e.row.isReportQualified,callback:function(t){e.$set(e.row,"isReportQualified",t)},expression:"row.isReportQualified"}},[e._v("不合格")])],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"基地负责人:",prop:"lender"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入基地负责人姓名"},model:{value:e.row.lender,callback:function(t){e.$set(e.row,"lender",t)},expression:"row.lender"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"基地负责人电话:",prop:"lenderPhone"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",onkeyup:"value=value.replace(/[^\\d]/g,'')",placeholder:"请输入基地负责人电话"},on:{blur:e.lenderPhoneChange},model:{value:e.row.lenderPhone,callback:function(t){e.$set(e.row,"lenderPhone",t)},expression:"row.lenderPhone"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"基地图片",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest2,"list-type":"picture-card","on-preview":e.handleBasePicturePreview,"on-remove":e.handleBasePictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeBasePicturePhoto,"file-list":e.fileBasePictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogBasePictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogBasePictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogBasePictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgBasePictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileBasePictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList2}})],1)})),0)],1),r("el-tab-pane",{attrs:{label:"检验报告",name:"third"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleInspectionReportPreview,"on-remove":e.handleInspectionReportRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeInspectionReportPhoto,"file-list":e.fileInspectionReportLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogInspectionReportVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogInspectionReportVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogInspectionReportImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgInspectionReportLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileInspectionReportDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("a434"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){var e=function(e,t,r){Object(n["c"])(t)?r():r(new Error("手机号不正确!"))};return{params:{page:null,limit:null,name:null,baseType:"种植基地",enterpriseId:window.sessionStorage.getItem("enterpriseId")},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,activeName:"first",dialogShow:!1,selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],srcList2:[],picInspectionReportListPhoto:[],dialogInspectionReportImageUrl:"",dialogInspectionReportVisible:!1,imgInspectionReportLists:[],fileInspectionReportLists:[],picBasePictureListPhoto:[],dialogBasePictureImageUrl:"",dialogBasePictureVisible:!1,imgBasePictureLists:[],fileBasePictureLists:[],rules:{name:[{required:!0,message:"请输入种植基地名称",trigger:"blur"}],address:[{required:!0,message:"请输入种植基地位置",trigger:"blur"}],area:[{required:!0,message:"请输入基地面积/规模",trigger:"blur"}],isReportQualified:[{required:!0,message:"请选择种植环境检验结果",trigger:"blur"}],lender:[{required:!0,message:"请输入基地负责人",trigger:"blur"}],lenderPhone:[{required:!0,message:"请输入基地负责人电话",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}]}}},created:function(){var e=this;this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/BaseInfo/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取种植基地数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogInspectionReportImageUrl=this.result}},httpRequest2:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogBasePictureImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleInspectionReportPreview:function(e){this.dialogInspectionReportImageUrl=e.url,this.dialogInspectionReportVisible=!0},handleInspectionReportRemove:function(e,t){for(var r in this.picInspectionReportListPhoto)this.picInspectionReportListPhoto[r].key===e.uid&&this.picInspectionReportListPhoto.splice(r,1);this.fileInspectionReportLists=t},handleChangeInspectionReportPhoto:function(e,t){this.fileInspectionReportLists=t},fileInspectionReportDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgInspectionReportLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},handleBasePicturePreview:function(e){this.dialogBasePictureImageUrl=e.url,this.dialogBasePictureVisible=!0},handleBasePictureRemove:function(e,t){for(var r in this.picBasePictureListPhoto)this.picBasePictureListPhoto[r].key===e.uid&&this.picBasePictureListPhoto.splice(r,1);this.fileBasePictureLists=t},handleChangeBasePicturePhoto:function(e,t){this.fileBasePictureLists=t},fileBasePictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgBasePictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.srcList2=[],this.picInspectionReportListPhoto=[],this.imgInspectionReportLists=[],this.fileInspectionReportLists=[],this.picBasePictureListPhoto=[],this.imgBasePictureLists=[],this.fileBasePictureLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.row.delFileIds=[],e.reportPictureList&&0!==e.reportPictureList.length){this.imgInspectionReportLists=e.reportPictureList;for(var t=0;t<this.imgInspectionReportLists.length;t++)this.srcList.push(this.baseUrl+this.imgInspectionReportLists[t].url)}if(e.basePictureList&&0!==e.basePictureList.length){this.imgBasePictureLists=e.basePictureList;for(var r=0;r<this.imgBasePictureLists.length;r++)this.srcList2.push(this.baseUrl+this.imgBasePictureLists[r].url)}this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/BaseInfo/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除种植基地失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除种植基地成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.row.baseType="种植基地",this.row.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"reportPictureList"==i||"basePictureList"==i||null!==s&&a.append(i,s);if(null!=e.fileInspectionReportLists)for(n=0;n<e.fileInspectionReportLists.length;n++)a.append("reportPictureFiles",e.fileInspectionReportLists[n].raw);if(null!=e.fileBasePictureLists)for(o=0;o<e.fileBasePictureLists.length;o++)a.append("basePictureFiles",e.fileBasePictureLists[o].raw);if("add"!==e.flag){t.next=18;break}return t.next=9,e.$http.post("zsSys/BaseInfo/addDataAndFile",a);case 9:if(l=t.sent,c=l.data,200===c.status){t.next=13;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增种植基地失败！"}));case 13:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增种植基地成功！"}),t.next=28;break;case 18:if("edit"!==e.flag){t.next=28;break}return t.next=21,e.$http.put("zsSys/BaseInfo/updateDataAndFile",a);case 21:if(u=t.sent,d=u.data,200===d.status){t.next=25;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改种植基地失败！"}));case 25:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改种植基地成功！"});case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),areaChange:function(e){this.$set(this.row,"area",e.target.value)},lenderPhoneChange:function(e){this.$set(this.row,"lenderPhone",e.target.value)}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"6a7cd100",null);t["default"]=u.exports},"638d":function(e,t,r){"use strict";r("66ed")},6547:function(e,t,r){var a=r("a691"),i=r("1d80"),s=function(e){return function(t,r){var s,n,o=String(i(t)),l=a(r),c=o.length;return l<0||l>=c?e?"":void 0:(s=o.charCodeAt(l),s<55296||s>56319||l+1===c||(n=o.charCodeAt(l+1))<56320||n>57343?e?o.charAt(l):s:e?o.slice(l,l+2):n-56320+(s-55296<<10)+65536)}};e.exports={codeAt:s(!1),charAt:s(!0)}},"65f0":function(e,t,r){var a=r("861d"),i=r("e8b5"),s=r("b622"),n=s("species");e.exports=function(e,t){var r;return i(e)&&(r=e.constructor,"function"!=typeof r||r!==Array&&!i(r.prototype)?a(r)&&(r=r[n],null===r&&(r=void 0)):r=void 0),new(void 0===r?Array:r)(0===t?0:t)}},"66ed":function(e,t,r){},7156:function(e,t,r){var a=r("861d"),i=r("d2bb");e.exports=function(e,t,r){var s,n;return i&&"function"==typeof(s=t.constructor)&&s!==r&&a(n=s.prototype)&&n!==r.prototype&&i(e,n),e}},7188:function(e,t,r){},7562:function(e,t,r){"use strict";r("7188")},"799a":function(e,t,r){},8418:function(e,t,r){"use strict";var a=r("c04e"),i=r("9bf2"),s=r("5c6c");e.exports=function(e,t,r){var n=a(t);n in e?i.f(e,n,s(0,r)):e[n]=r}},8781:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("基本配置")]),r("el-breadcrumb-item",[e._v("企业资质管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("企业资质代码:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入企业资质代码"},model:{value:e.params.aptitudeCode,callback:function(t){e.$set(e.params,"aptitudeCode",t)},expression:"params.aptitudeCode"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"企业资质代码",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.aptitudeCode)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"企业资质类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getDictionaryName(t.row.aptitudeType))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"发证单位",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.certificationUnitName)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"发证时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.certificationTime))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"有效时间",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.effectiveTime))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"许可范围","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.permitRange,placement:"top"}},[r("span",[e._v(e._s(e.textSubstr(t.row.permitRange,20)))])])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"企业资质信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"120px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"企业资质类型:",prop:"aptitudeType"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择企业资质类型"},model:{value:e.row.aptitudeType,callback:function(t){e.$set(e.row,"aptitudeType",t)},expression:"row.aptitudeType"}},e._l(e.aptitudeTypeOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"企业资质代码:",prop:"aptitudeCode"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入企业资质代码"},model:{value:e.row.aptitudeCode,callback:function(t){e.$set(e.row,"aptitudeCode",t)},expression:"row.aptitudeCode"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"发证时间:",prop:"certificationTime"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择发证时间"},model:{value:e.row.certificationTime,callback:function(t){e.$set(e.row,"certificationTime",t)},expression:"row.certificationTime"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"有效期至:",prop:"effectiveTime"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择有效期"},model:{value:e.row.effectiveTime,callback:function(t){e.$set(e.row,"effectiveTime",t)},expression:"row.effectiveTime"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"发证单位:",prop:"certificationUnitName"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入发证单位"},model:{value:e.row.certificationUnitName,callback:function(t){e.$set(e.row,"certificationUnitName",t)},expression:"row.certificationUnitName"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"许可范围:",prop:"permitRange"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入许可范围",maxlength:"255",clearable:""},model:{value:e.row.permitRange,callback:function(t){e.$set(e.row,"permitRange",t)},expression:"row.permitRange"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"资质证书",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleQualificationCertificatePreview,"on-remove":e.handleQualificationCertificateRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeQualificationCertificatePhoto,"file-list":e.fileQualificationCertificateLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogQualificationCertificateVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogQualificationCertificateVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogQualificationCertificateImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgQualificationCertificateLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("fb6a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,aptitudeCode:null,enterpriseId:window.sessionStorage.getItem("enterpriseId")},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,dialogShow:!1,activeName:"first",selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],picQualificationCertificateListPhoto:[],dialogQualificationCertificateImageUrl:"",dialogQualificationCertificateVisible:!1,imgQualificationCertificateLists:[],fileQualificationCertificateLists:[],aptitudeTypeOptions:[],rules:{aptitudeCode:[{required:!0,message:"请输入企业资质代码",trigger:"blur"}],aptitudeType:[{required:!0,message:"请选择企业资质类型",trigger:"blur"}],certificationTime:[{required:!0,message:"请选择发证时间",trigger:"blur"}]}}},created:function(){var e=this;this.getAptitudeTypeDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAptitudeTypeDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"企业资质类型",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业资质类型失败！"}));case 6:e.aptitudeTypeOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/EnterpriseQualification/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业资质数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogQualificationCertificateImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleQualificationCertificatePreview:function(e){this.dialogQualificationCertificateImageUrl=e.url,this.dialogQualificationCertificateVisible=!0},handleQualificationCertificateRemove:function(e,t){for(var r in this.picQualificationCertificateListPhoto)this.picQualificationCertificateListPhoto[r].key===e.uid&&this.picQualificationCertificateListPhoto.splice(r,1);this.fileQualificationCertificateLists=t},handleChangeQualificationCertificatePhoto:function(e,t){this.fileQualificationCertificateLists=t},fileQualificationCertificateDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgQualificationCertificateLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.picQualificationCertificateListPhoto=[],this.imgQualificationCertificateLists=[],this.fileQualificationCertificateLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.row.delFileIds=[],e.aptitudeCertificateList&&0!==e.aptitudeCertificateList.length){this.imgQualificationCertificateLists=e.aptitudeCertificateList;for(var t=0;t<this.imgQualificationCertificateLists.length;t++)this.srcList.push(this.baseUrl+this.imgQualificationCertificateLists[t].url)}this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的企业用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/EnterpriseQualification/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除企业资质失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除企业资质成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.row.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"aptitudeCertificateList"==i||null!==s&&a.append(i,s);if(null!=e.fileQualificationCertificateLists)for(n=0;n<e.fileQualificationCertificateLists.length;n++)a.append("aptitudeCertificateFiles",e.fileQualificationCertificateLists[n].raw);if("add"!==e.flag){t.next=17;break}return t.next=8,e.$http.post("zsSys/EnterpriseQualification/addDataAndFile",a);case 8:if(o=t.sent,l=o.data,200===l.status){t.next=12;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增企业资质失败！"}));case 12:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增企业资质成功！"}),t.next=27;break;case 17:if("edit"!==e.flag){t.next=27;break}return t.next=20,e.$http.put("zsSys/EnterpriseQualification/updateDataAndFile",a);case 20:if(c=t.sent,u=c.data,200===u.status){t.next=24;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改企业资质失败！"}));case 24:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改企业资质成功！"});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},getDictionaryName:function(e){for(var t=0;t<this.aptitudeTypeOptions.length;t++)if(e===this.aptitudeTypeOptions[t].code)return this.aptitudeTypeOptions[t].name},textSubstr:function(e,t){var r=e;return""==e||void 0==e?"":(e.length>t&&(r=r.substring(0,t)+"..."),r)}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"1a2f8814",null);t["default"]=u.exports},"8aa5":function(e,t,r){"use strict";var a=r("6547").charAt;e.exports=function(e,t,r){return t+(r?a(e,t).length:1)}},"922a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("基本配置")]),r("el-breadcrumb-item",[e._v("销售商管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("销售商名称:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入销售商名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"销售商名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"联系人",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.contactPerson)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"联系电话",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.phone)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"销售许可证号",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.saleLicenseNumber)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"销售商地址","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.address,placement:"top"}},[r("span",[e._v(e._s(t.row.address))])])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"销售商信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"140px",rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"销售商名称:",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入销售商名称"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"销售许可证号:",prop:"saleLicenseNumber"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入销售许可证号"},model:{value:e.row.saleLicenseNumber,callback:function(t){e.$set(e.row,"saleLicenseNumber",t)},expression:"row.saleLicenseNumber"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"联系人:",prop:"contactPerson"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入联系人姓名"},model:{value:e.row.contactPerson,callback:function(t){e.$set(e.row,"contactPerson",t)},expression:"row.contactPerson"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"联系电话:",prop:"phone"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",onkeyup:"value=value.replace(/[^\\d]/g,'')",placeholder:"请输入联系人电话"},on:{blur:e.phoneChange},model:{value:e.row.phone,callback:function(t){e.$set(e.row,"phone",t)},expression:"row.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"邮箱:",prop:"mailbox"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入邮箱"},model:{value:e.row.mailbox,callback:function(t){e.$set(e.row,"mailbox",t)},expression:"row.mailbox"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"销售商地址:",prop:"address"}},[r("el-input",{attrs:{clearable:"",maxlength:"255",placeholder:"请输入销售商地址"},model:{value:e.row.address,callback:function(t){e.$set(e.row,"address",t)},expression:"row.address"}})],1)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("96cf"),r("1da1")),n=r("567f"),o={data:function(){var e=function(e,t,r){Object(n["c"])(t)?r():r(new Error("手机号不正确!"))};return{params:{page:null,limit:null,name:null,enterpriseId:window.sessionStorage.getItem("enterpriseId")},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,dialogShow:!1,selectRows:[],rules:{name:[{required:!0,message:"请输入销售商名称",trigger:"blur"}],saleLicenseNumber:[{required:!0,message:"请输入销售许可证号",trigger:"blur"}],contactPerson:[{required:!0,message:"请输入联系人",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}]}}},created:function(){var e=this;this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/Seller/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取销售商数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},closeDialog:function(){this.row={},this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){this.row=e,this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/Seller/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除销售商失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除销售商成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.row.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:if("add"!==e.flag){t.next=14;break}return t.next=5,e.$http.post("zsSys/Seller",e.row);case 5:if(a=t.sent,i=a.data,200===i.status){t.next=9;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增销售商失败！"}));case 9:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增销售商成功！"}),t.next=24;break;case 14:if("edit"!==e.flag){t.next=24;break}return t.next=17,e.$http.put("zsSys/Seller",e.row);case 17:if(s=t.sent,n=s.data,200===n.status){t.next=21;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改销售商失败！"}));case 21:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改销售商成功！"});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),phoneChange:function(e){this.$set(this.row,"phone",e.target.value)}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"417bdbdd",null);t["default"]=u.exports},9263:function(e,t,r){"use strict";var a=r("ad6d"),i=r("9f7f"),s=RegExp.prototype.exec,n=String.prototype.replace,o=s,l=function(){var e=/a/,t=/b*/g;return s.call(e,"a"),s.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),c=i.UNSUPPORTED_Y||i.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],d=l||u||c;d&&(o=function(e){var t,r,i,o,d=this,p=c&&d.sticky,h=a.call(d),g=d.source,m=0,f=e;return p&&(h=h.replace("y",""),-1===h.indexOf("g")&&(h+="g"),f=String(e).slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==e[d.lastIndex-1])&&(g="(?: "+g+")",f=" "+f,m++),r=new RegExp("^(?:"+g+")",h)),u&&(r=new RegExp("^"+g+"$(?!\\s)",h)),l&&(t=d.lastIndex),i=s.call(p?r:d,f),p?i?(i.input=i.input.slice(m),i[0]=i[0].slice(m),i.index=d.lastIndex,d.lastIndex+=i[0].length):d.lastIndex=0:l&&i&&(d.lastIndex=d.global?i.index+i[0].length:t),u&&i&&i.length>1&&n.call(i[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i}),e.exports=o},"93c5":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("统计详情")])],1),r("el-card",{style:e.curHeight},[r("div",{staticClass:"box-container"},[r("div",{staticClass:"box"},[r("span",[e._v("收购数")]),r("span",[e._v(e._s(e.buys))])]),r("div",{staticClass:"box"},[r("span",[e._v("生产批次")]),r("span",[e._v(e._s(e.batchs))])]),r("div",{staticClass:"box"},[r("span",[e._v("销售订单")]),r("span",[e._v(e._s(e.orders))])]),r("div",{staticClass:"box"},[r("span",[e._v("检验报告")]),r("span",[e._v(e._s(e.inspections))])])]),r("div",{staticClass:"echart-container"},[r("div",{staticClass:"echart-box",attrs:{id:"main1"}}),r("div",{staticClass:"echart-box",attrs:{id:"main2"}})]),r("div",{staticClass:"time-select-container"},[r("div",{staticClass:"time-bar"},[r("span",{staticClass:"time-circle-point"}),r("span",{staticClass:"time-circle-point"}),r("span",{staticClass:"time-circle-point active-point"})]),r("div",{staticClass:"time-year"},e._l(e.yearLists,(function(t,a){return r("span",{key:a,staticClass:"time-year-text",on:{click:function(t){return e.selectChange(a)}}},[e._v(e._s(t))])})),0)])])],1)},i=[],s=(r("a15b"),r("ac1f"),r("1276"),r("96cf"),r("1da1")),n=r("164e"),o=r.n(n),l={data:function(){return{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地",before:null},curHeight:{height:"",overflow:"auto"},myChart01:null,myChart02:null,buys:0,batchs:0,orders:0,inspections:0,monthLists:[],dataProduction:[],dataOrder:[],yearLists:[]}},mounted:function(){var e=this,t=new Date,r=t.getFullYear();this.params.before=r+"-1",this.yearLists.push(r-2),this.yearLists.push(r-1),this.yearLists.push(r),this.getStatics(),this.setTableHeight(),window.onresize=function(){e.setTableHeight(),e.myChart01.resize(),e.myChart02.resize()}},methods:{getStatics:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/ProcessBatch/statisticsByEId",{params:e.params});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取统计数据失败！"}));case 6:for(e.buys=a.data.upper.aqzs_buy,e.batchs=a.data.upper.aqzs_process_batch,e.orders=a.data.upper.aqzs_sale,e.inspections=a.data.upper.aqzs_finish_product_test,e.monthLists=[],e.dataProduction=[],e.dataOrder=[],i=0;i<a.data.lower.length;i++)e.monthLists.push(a.data.lower[i].month),e.dataProduction.push(a.data.lower[i].aqzs_process_batch),e.dataOrder.push(a.data.lower[i].aqzs_sale);e.showGraphic();case 15:case"end":return t.stop()}}),t)})))()},showGraphic:function(){this.myChart01=o.a.init(document.getElementById("main1")),this.myChart02=o.a.init(document.getElementById("main2"));var e={title:{text:"生产批次数",left:"center"},tooltip:{appendToBody:!0},toolbox:{feature:{magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}},right:20},xAxis:{axisLabel:{interval:0,formatter:function(e){return e.split("").join("\n")}},data:this.monthLists},yAxis:{},series:[{name:"生产批次数",type:"bar",color:"#66bfbf",data:this.dataProduction,label:{normal:{show:!0,position:"top",fontSize:16}}}]},t={title:{text:"销售订单数",left:"center"},tooltip:{appendToBody:!0},toolbox:{feature:{magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}},right:20},xAxis:{axisLabel:{interval:0,formatter:function(e){return e.split("").join("\n")}},data:this.monthLists},yAxis:{},series:[{name:"销售订单数",type:"bar",color:"#66bfbf",data:this.dataOrder,label:{normal:{show:!0,position:"top",fontSize:16}}}]};this.myChart01.setOption(e),this.myChart02.setOption(t)},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight.height=e-180+"px"},selectChange:function(e){this.myChart01.clear(),this.myChart02.clear();for(var t=document.querySelectorAll(".time-circle-point"),r=document.querySelectorAll(".time-year-text"),a=0;a<r.length;a++)t[a].classList.remove("active-point"),e===a&&(t[a].classList.add("active-point"),this.params.before=this.yearLists[a]+"-1",this.getStatics())}}},c=l,u=(r("4751"),r("2877")),d=Object(u["a"])(c,a,i,!1,null,"2eb0636d",null);t["default"]=d.exports},"96cf":function(e,t){!function(t){"use strict";var r,a=Object.prototype,i=a.hasOwnProperty,s="function"===typeof Symbol?Symbol:{},n=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag",c="object"===typeof e,u=t.regeneratorRuntime;if(u)c&&(e.exports=u);else{u=t.regeneratorRuntime=c?e.exports:{},u.wrap=y;var d="suspendedStart",p="suspendedYield",h="executing",g="completed",m={},f={};f[n]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(A([])));w&&w!==a&&i.call(w,n)&&(f=w);var v=k.prototype=P.prototype=Object.create(f);x.prototype=v.constructor=k,k.constructor=x,k[l]=x.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(v),e},u.awrap=function(e){return{__await:e}},L(C.prototype),C.prototype[o]=function(){return this},u.AsyncIterator=C,u.async=function(e,t,r,a){var i=new C(y(e,t,r,a));return u.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},L(v),v[l]="Generator",v[n]=function(){return this},v.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){while(t.length){var a=t.pop();if(a in e)return r.value=a,r.done=!1,r}return r.done=!0,r}},u.values=A,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach($),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,i){return o.type="throw",o.arg=e,t.next=a,i&&(t.method="next",t.arg=r),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var n=this.tryEntries[s],o=n.completion;if("root"===n.tryLoc)return a("end");if(n.tryLoc<=this.prev){var l=i.call(n,"catchLoc"),c=i.call(n,"finallyLoc");if(l&&c){if(this.prev<n.catchLoc)return a(n.catchLoc,!0);if(this.prev<n.finallyLoc)return a(n.finallyLoc)}else if(l){if(this.prev<n.catchLoc)return a(n.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return a(n.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&i.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var n=s?s.completion:{};return n.type=e,n.arg=t,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(n)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),$(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var i=a.arg;$(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:A(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=r),m}}}function y(e,t,r,a){var i=t&&t.prototype instanceof P?t:P,s=Object.create(i.prototype),n=new D(a||[]);return s._invoke=S(e,r,n),s}function _(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(a){return{type:"throw",arg:a}}}function P(){}function x(){}function k(){}function L(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(e){function t(r,a,s,n){var o=_(e[r],e,a);if("throw"!==o.type){var l=o.arg,c=l.value;return c&&"object"===typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,s,n)}),(function(e){t("throw",e,s,n)})):Promise.resolve(c).then((function(e){l.value=e,s(l)}),n)}n(o.arg)}var r;function a(e,a){function i(){return new Promise((function(r,i){t(e,a,r,i)}))}return r=r?r.then(i,i):i()}this._invoke=a}function S(e,t,r){var a=d;return function(i,s){if(a===h)throw new Error("Generator is already running");if(a===g){if("throw"===i)throw s;return T()}r.method=i,r.arg=s;while(1){var n=r.delegate;if(n){var o=R(n,r);if(o){if(o===m)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===d)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=h;var l=_(e,t,r);if("normal"===l.type){if(a=r.done?g:p,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=g,r.method="throw",r.arg=l.arg)}}}function R(e,t){var a=e.iterator[t.method];if(a===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=r,R(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=_(a,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var s=i.arg;return s?s.done?(t[e.resultName]=s.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=r),t.delegate=null,m):s:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function $(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function A(e){if(e){var t=e[n];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function t(){while(++a<e.length)if(i.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=r,t.done=!0,t};return s.next=s}}return{next:T}}function T(){return{value:r,done:!0}}}(function(){return this}()||Function("return this")())},"99af":function(e,t,r){"use strict";var a=r("23e7"),i=r("d039"),s=r("e8b5"),n=r("861d"),o=r("7b0b"),l=r("50c4"),c=r("8418"),u=r("65f0"),d=r("1dde"),p=r("b622"),h=r("2d00"),g=p("isConcatSpreadable"),m=9007199254740991,f="Maximum allowed index exceeded",b=h>=51||!i((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),w=d("concat"),v=function(e){if(!n(e))return!1;var t=e[g];return void 0!==t?!!t:s(e)},y=!b||!w;a({target:"Array",proto:!0,forced:y},{concat:function(e){var t,r,a,i,s,n=o(this),d=u(n,0),p=0;for(t=-1,a=arguments.length;t<a;t++)if(s=-1===t?n:arguments[t],v(s)){if(i=l(s.length),p+i>m)throw TypeError(f);for(r=0;r<i;r++,p++)r in s&&c(d,p,s[r])}else{if(p>=m)throw TypeError(f);c(d,p++,s)}return d.length=p,d}})},"9f7f":function(e,t,r){"use strict";var a=r("d039");function i(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=a((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=a((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a15b:function(e,t,r){"use strict";var a=r("23e7"),i=r("44ad"),s=r("fc6a"),n=r("a640"),o=[].join,l=i!=Object,c=n("join",",");a({target:"Array",proto:!0,forced:l||!c},{join:function(e){return o.call(s(this),void 0===e?",":e)}})},a29b:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("销售管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("订单编号:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入订单编号"},model:{value:e.params.orderNumber,callback:function(t){e.$set(e.params,"orderNumber",t)},expression:"params.orderNumber"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("追溯码:")]),r("el-select",{staticStyle:{width:"220px"},attrs:{clearable:"",filterable:"",placeholder:"请选择追溯码"},model:{value:e.params.productBatchNumber,callback:function(t){e.$set(e.params,"productBatchNumber",t)},expression:"params.productBatchNumber"}},e._l(e.productBatchOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),r("div",{staticClass:"query-item"},[r("span",[e._v("销售商名称:")]),r("el-select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择销售商"},model:{value:e.params.sellerId,callback:function(t){e.$set(e.params,"sellerId",t)},expression:"params.sellerId"}},e._l(e.retailerOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),r("div",{staticClass:"query-item"},[r("span",[e._v("发货日期:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"请选择发货日期"},model:{value:e.params.sendDateS,callback:function(t){e.$set(e.params,"sendDateS",t)},expression:"params.sendDateS"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"订单编号",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.orderNumber)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"追溯码",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.productBatchNumber)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"销售商",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getName(t.row.sellerId))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"销售数量",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.saleAmount+e.getDictionaryName(t.row.saleAmountUnit))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"发货时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.sendDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"目的地","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.endPlace,placement:"top"}},[r("span",[e._v(e._s(t.row.endPlace))])])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"订单信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"120px",rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"订单编号:",prop:"orderNumber"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入订单编号"},model:{value:e.row.orderNumber,callback:function(t){e.$set(e.row,"orderNumber",t)},expression:"row.orderNumber"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"追溯码:",prop:"productBatchNumber"}},[r("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择追溯码"},model:{value:e.row.productBatchNumber,callback:function(t){e.$set(e.row,"productBatchNumber",t)},expression:"row.productBatchNumber"}},e._l(e.productBatchOptions,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"销售商名称:",prop:"sellerId"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择销售商"},model:{value:e.row.sellerId,callback:function(t){e.$set(e.row,"sellerId",t)},expression:"row.sellerId"}},e._l(e.retailerOptions,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"发货时间:",prop:"sendDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"选择发货时间"},model:{value:e.row.sendDate,callback:function(t){e.$set(e.row,"sendDate",t)},expression:"row.sendDate"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"发货人:",prop:"sender"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入发货人"},model:{value:e.row.sender,callback:function(t){e.$set(e.row,"sender",t)},expression:"row.sender"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收货人:",prop:"receiver"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入收货人"},model:{value:e.row.receiver,callback:function(t){e.$set(e.row,"receiver",t)},expression:"row.receiver"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"始发地:",prop:"startPlace"}},[r("el-input",{attrs:{clearable:"",maxlength:"255",placeholder:"请输入始发地"},model:{value:e.row.startPlace,callback:function(t){e.$set(e.row,"startPlace",t)},expression:"row.startPlace"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"目的地:",prop:"endPlace"}},[r("el-input",{attrs:{clearable:"",maxlength:"255",placeholder:"请输入目的地"},model:{value:e.row.endPlace,callback:function(t){e.$set(e.row,"endPlace",t)},expression:"row.endPlace"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"销售数量:",prop:"saleAmount"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入销售数量"},on:{blur:e.saleAmountChange},model:{value:e.row.saleAmount,callback:function(t){e.$set(e.row,"saleAmount",t)},expression:"row.saleAmount"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"销售数量单位:",prop:"saleAmountUnit"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择销售数量单位"},model:{value:e.row.saleAmountUnit,callback:function(t){e.$set(e.row,"saleAmountUnit",t)},expression:"row.saleAmountUnit"}},e._l(e.amountUnitOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("fb6a"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,orderNumber:null,productBatchNumber:null,sellerId:null,sendDateS:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,dialogShow:!1,selectRows:[],retailerOptions:[],amountUnitOptions:[],productBatchOptions:[],rules:{productBatchNumber:[{required:!0,message:"请输入追溯码",trigger:"blur"}],sellerId:[{required:!0,message:"请选择销售商",trigger:"blur"}],sendDate:[{required:!0,message:"请选择发货时间",trigger:"blur"}],endPlace:[{required:!0,message:"请输入目的地",trigger:"blur"}],saleAmount:[{required:!0,message:"请输入销售数量",trigger:"blur"}],saleAmountUnit:[{required:!0,message:"请选择销售数量单位",trigger:"blur"}]}}},created:function(){var e=this;this.getAmountUnitDictionary(),this.getProcessBatchDictionary(),this.getRetailerDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAmountUnitDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"数量单位"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取数量单位失败！"}));case 6:e.amountUnitOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getProcessBatchDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/ProcessBatch/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),baseType:"种植基地"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取追溯码数据失败！"}));case 6:for(i=0;i<a.data.rows.length;i++)e.productBatchOptions.push(a.data.rows[i].productBatchNumber);case 7:case"end":return t.stop()}}),t)})))()},getRetailerDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("zsSys/Seller/pageByEId",{params:{enterpriseId:window.sessionStorage.getItem("enterpriseId")}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取销售商数据失败！"}));case 6:e.retailerOptions=a.data.rows;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/Sale/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取销售数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},closeDialog:function(){this.row={},this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){this.row=e,this.dialogShow=!0,this.flag="edit",void 0==this.getName(e.sellerId)&&(this.row.sellerId="")},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/Sale/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除订单失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除订单成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.row.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:if("add"!==e.flag){t.next=14;break}return t.next=5,e.$http.post("zsSys/Sale",e.row);case 5:if(a=t.sent,i=a.data,200===i.status){t.next=9;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增订单失败！"}));case 9:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增订单成功！"}),t.next=24;break;case 14:if("edit"!==e.flag){t.next=24;break}return t.next=17,e.$http.put("zsSys/Sale",e.row);case 17:if(s=t.sent,n=s.data,200===n.status){t.next=21;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改订单失败！"}));case 21:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改订单成功！"});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},saleAmountChange:function(e){this.$set(this.row,"saleAmount",e.target.value)},getName:function(e){for(var t=0;t<this.retailerOptions.length;t++)if(e===this.retailerOptions[t].id)return this.retailerOptions[t].name},getDictionaryName:function(e){for(var t=0;t<this.amountUnitOptions.length;t++)if(e===this.amountUnitOptions[t].code)return this.amountUnitOptions[t].name}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"5b76fdac",null);t["default"]=u.exports},a434:function(e,t,r){"use strict";var a=r("23e7"),i=r("23cb"),s=r("a691"),n=r("50c4"),o=r("7b0b"),l=r("65f0"),c=r("8418"),u=r("1dde"),d=r("ae40"),p=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),g=Math.max,m=Math.min,f=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!p||!h},{splice:function(e,t){var r,a,u,d,p,h,w=o(this),v=n(w.length),y=i(e,v),_=arguments.length;if(0===_?r=a=0:1===_?(r=0,a=v-y):(r=_-2,a=m(g(s(t),0),v-y)),v+r-a>f)throw TypeError(b);for(u=l(w,a),d=0;d<a;d++)p=y+d,p in w&&c(u,d,w[p]);if(u.length=a,r<a){for(d=y;d<v-a;d++)p=d+a,h=d+r,p in w?w[h]=w[p]:delete w[h];for(d=v;d>v-a+r;d--)delete w[d-1]}else if(r>a)for(d=v-a;d>y;d--)p=d+a-1,h=d+r-1,p in w?w[h]=w[p]:delete w[h];for(d=0;d<r;d++)w[d+y]=arguments[d+2];return w.length=v-a+r,u}})},a640:function(e,t,r){"use strict";var a=r("d039");e.exports=function(e,t){var r=[][e];return!!r&&a((function(){r.call(null,t||function(){throw 1},1)}))}},ac1f:function(e,t,r){"use strict";var a=r("23e7"),i=r("9263");a({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(e,t,r){"use strict";var a=r("825a");e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},ae40:function(e,t,r){var a=r("83ab"),i=r("d039"),s=r("5135"),n=Object.defineProperty,o={},l=function(e){throw e};e.exports=function(e,t){if(s(o,e))return o[e];t||(t={});var r=[][e],c=!!s(t,"ACCESSORS")&&t.ACCESSORS,u=s(t,0)?t[0]:l,d=s(t,1)?t[1]:void 0;return o[e]=!!r&&!i((function(){if(c&&!a)return!0;var e={length:-1};c?n(e,1,{enumerable:!0,get:l}):e[1]=1,r.call(e,u,d)}))}},b0c0:function(e,t,r){var a=r("83ab"),i=r("9bf2").f,s=Function.prototype,n=s.toString,o=/^\s*function ([^ (]*)/,l="name";a&&!(l in s)&&i(s,l,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(e){return""}}})},b727:function(e,t,r){var a=r("0366"),i=r("44ad"),s=r("7b0b"),n=r("50c4"),o=r("65f0"),l=[].push,c=function(e){var t=1==e,r=2==e,c=3==e,u=4==e,d=6==e,p=7==e,h=5==e||d;return function(g,m,f,b){for(var w,v,y=s(g),_=i(y),P=a(m,f,3),x=n(_.length),k=0,L=b||o,C=t?L(g,x):r||p?L(g,0):void 0;x>k;k++)if((h||k in _)&&(w=_[k],v=P(w,k,y),e))if(t)C[k]=v;else if(v)switch(e){case 3:return!0;case 5:return w;case 6:return k;case 2:l.call(C,w)}else switch(e){case 4:return!1;case 7:l.call(C,w)}return d?-1:c||u?u:C}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},be7f:function(e,t,r){"use strict";r("fd31")},c0b4:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("企业基本信息")])],1),r("el-card",[r("el-form",{ref:"row",staticClass:"row-form",staticStyle:{width:"90%"},attrs:{model:e.row,"label-width":"160px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{style:e.curHeight,attrs:{label:"基本信息"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{prop:"name",label:"企业名称:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"由1-20个汉字组成"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{prop:"businessType",label:"企业类型:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择企业类型"},model:{value:e.row.businessType,callback:function(t){e.$set(e.row,"businessType",t)},expression:"row.businessType"}},e._l(e.businessTypeOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{prop:"socialCode",label:"统一社会信用代码:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"由18位组成"},model:{value:e.row.socialCode,callback:function(t){e.$set(e.row,"socialCode",t)},expression:"row.socialCode"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{prop:"district",label:"行政区规划:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择行政区"},model:{value:e.row.district,callback:function(t){e.$set(e.row,"district",t)},expression:"row.district"}},e._l(e.districtOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1)],1),r("el-col",{staticClass:"user-upload",attrs:{span:12}},[r("el-form-item",{attrs:{label:"企业形象图:"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.updateUrl,"show-file-list":!1,"http-request":e.httpRequest01,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?r("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"organizationForm",label:"组织形式:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择组织形式"},model:{value:e.row.organizationForm,callback:function(t){e.$set(e.row,"organizationForm",t)},expression:"row.organizationForm"}},e._l(e.organizationFormOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"subjectAttribute",label:"主体属性:"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择主体属性"},model:{value:e.row.subjectAttribute,callback:function(t){e.$set(e.row,"subjectAttribute",t)},expression:"row.subjectAttribute"}},e._l(e.subjectAttributeOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"registerAddress",label:"注册地址:"}},[r("el-input",{attrs:{clearable:"",maxlength:"255",placeholder:"营业执照上的地址"},model:{value:e.row.registerAddress,callback:function(t){e.$set(e.row,"registerAddress",t)},expression:"row.registerAddress"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"establishDate",label:"企业成立日期:"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"选择企业成立日期"},model:{value:e.row.establishDate,callback:function(t){e.$set(e.row,"establishDate",t)},expression:"row.establishDate"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"registerMoney",label:"注册资金(万元):"}},[r("el-input",{attrs:{clearable:"",placeholder:"请输入注册资金",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')"},on:{blur:e.registerMoneyChange},model:{value:e.row.registerMoney,callback:function(t){e.$set(e.row,"registerMoney",t)},expression:"row.registerMoney"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"contactPerson",label:"联系人:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入联系人姓名"},model:{value:e.row.contactPerson,callback:function(t){e.$set(e.row,"contactPerson",t)},expression:"row.contactPerson"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"phone",label:"联系人手机号:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入联系人手机号",onkeyup:"value=value.replace(/[^\\d]/g,'')"},on:{blur:e.phoneChange},model:{value:e.row.phone,callback:function(t){e.$set(e.row,"phone",t)},expression:"row.phone"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"mailbox",label:"电子邮箱:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入正确格式的邮箱"},model:{value:e.row.mailbox,callback:function(t){e.$set(e.row,"mailbox",t)},expression:"row.mailbox"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"deputyName",label:"法定代表人姓名:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入法定代表人姓名"},model:{value:e.row.deputyName,callback:function(t){e.$set(e.row,"deputyName",t)},expression:"row.deputyName"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"deputyIdCard",label:"法定代表人身份证号:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"身份证号由18位组成"},model:{value:e.row.deputyIdCard,callback:function(t){e.$set(e.row,"deputyIdCard",t)},expression:"row.deputyIdCard"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"deputyPhone",label:"法定代表人联系电话:"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入法定代表人联系电话",onkeyup:"value=value.replace(/[^\\d]/g,'')"},on:{blur:e.deputyPhoneChange},model:{value:e.row.deputyPhone,callback:function(t){e.$set(e.row,"deputyPhone",t)},expression:"row.deputyPhone"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{prop:"postcode",label:"邮政编码:"}},[r("el-input",{attrs:{clearable:"",maxlength:"6",placeholder:"请输入邮政编码",onkeyup:"value=value.replace(/[^\\d]/g,'')"},on:{blur:e.postcodeChange},model:{value:e.row.postcode,callback:function(t){e.$set(e.row,"postcode",t)},expression:"row.postcode"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"经纬度:",prop:"longitude"}},[r("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"longitude"}},[r("el-input",{staticStyle:{width:"244px","margin-right":"20px"},attrs:{readonly:"",placeholder:"请输入经度"},on:{focus:e.showMap},model:{value:e.row.longitude,callback:function(t){e.$set(e.row,"longitude",t)},expression:"row.longitude"}})],1),r("el-form-item",{staticStyle:{float:"left"},attrs:{prop:"latitude"}},[r("el-input",{staticStyle:{width:"244px"},attrs:{readonly:"",placeholder:"请输入纬度"},on:{focus:e.showMap},model:{value:e.row.latitude,callback:function(t){e.$set(e.row,"latitude",t)},expression:"row.latitude"}})],1)],1)],1)],1)],1),r("el-tab-pane",{style:e.curHeight,attrs:{label:"营业执照"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest02,"list-type":"picture-card","on-preview":e.handleBusinessLicensePreview,"on-remove":e.handleBusinessLicenseRemove,"before-upload":e.beforeAvatarUpload02,"on-change":e.handleChangeBusinessLicensePhoto,"file-list":e.fileBusinessLicenseLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogBusinessLicenseVisible,width:"70%",top:"5vh"},on:{"update:visible":function(t){e.dialogBusinessLicenseVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogBusinessLicenseImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgBusinessLicenseLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1),r("el-tab-pane",{style:e.curHeight,attrs:{label:"法人身份证照片（请上传身份证正面照片和反面照片）"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest03,"list-type":"picture-card","on-preview":e.handleCorporateIdentityCardPreview,"on-remove":e.handleCorporateIdentityCardRemove,"before-upload":e.beforeAvatarUpload02,"on-change":e.handleChangeCorporateIdentityCardPhoto,"file-list":e.fileCorporateIdentityCardLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogCorporateIdentityCardVisible,width:"70%",top:"5vh"},on:{"update:visible":function(t){e.dialogCorporateIdentityCardVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogCorporateIdentityCardImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgCorporateIdentityCardLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileCorporateIdentityCardDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList2}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn-user"},[r("el-button",{attrs:{type:"warning"},on:{click:function(t){e.dialogIoTVisible=!0}}},[e._v("物联网关联")]),r("el-button",{attrs:{type:"info"},on:{click:e.getList}},[e._v("重 置")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1),r("el-dialog",{attrs:{title:"经纬度",center:"",visible:e.dialogMapVisible,width:"50%"},on:{"update:visible":function(t){e.dialogMapVisible=t}}},[r("div",{staticClass:"container"},[r("div",{staticClass:"search-box"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.searchKey,expression:"searchKey"}],attrs:{type:"search",id:"search"},domProps:{value:e.searchKey},on:{input:function(t){t.target.composing||(e.searchKey=t.target.value)}}}),r("button",{on:{click:e.searchByHand}},[e._v("搜索")]),r("div",{staticClass:"tip-box",attrs:{id:"searchTip"}})]),r("el-amap",{staticClass:"amap-box",attrs:{"amap-manager":e.amapManager,vid:"amap-vue",zoom:e.zoom,center:e.center,plugin:e.plugin,events:e.events}},e._l(e.markers,(function(e,t){return r("el-amap-marker",{key:t,attrs:{position:e}})})),1)],1),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogMapVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.getCoordinate}},[e._v("确 定")])],1)]),r("el-dialog",{attrs:{title:"物联网账号",center:"",visible:e.dialogIoTVisible,width:"1000px"},on:{"update:visible":function(t){e.dialogIoTVisible=t}}},[r("div",{staticStyle:{"margin-top":"-20px"}},[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addIoTRow}},[e._v("新增")])],1),r("el-table",{ref:"myTable",attrs:{data:e.ioTRows,border:"",stripe:"",fit:"","highlight-current-row":"","cell-style":{padding:"5px 0"},height:e.curHeight2}},[r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"mini",plain:"",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editIoTRow(t.row)}}},[e._v("编辑")]),r("el-button",{attrs:{type:"danger",size:"mini",plain:"",icon:"el-icon-delete"},on:{click:function(r){return e.deleteIoTRow(t.row.id)}}},[e._v("删除")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"关联编号","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"物联网账号用户名",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.username)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"物联网账号密码",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.password)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"物联网设备供应商",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getDictionaryName(t.row.type))+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"物联网账号关联",center:"",visible:e.dialogIoTEditVisible,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogIoTEditVisible=t}}},[r("el-form",{ref:"ioTRow",staticClass:"demo-ruleForm",attrs:{model:e.ioTRow,"label-width":"160px",rules:e.rules2}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"关联编号:",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入关联编号"},model:{value:e.ioTRow.name,callback:function(t){e.$set(e.ioTRow,"name",t)},expression:"ioTRow.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"物联网设备供应商:",prop:"type"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择物联网设备供应商"},model:{value:e.ioTRow.type,callback:function(t){e.$set(e.ioTRow,"type",t)},expression:"ioTRow.type"}},e._l(e.ioTOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"物联网账号用户名:",prop:"username"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入用户名"},model:{value:e.ioTRow.username,callback:function(t){e.$set(e.ioTRow,"username",t)},expression:"ioTRow.username"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"物联网账号密码:",prop:"password"}},[r("el-input",{attrs:{"show-password":"",clearable:"",maxlength:"50",placeholder:"请输入密码"},model:{value:e.ioTRow.password,callback:function(t){e.$set(e.ioTRow,"password",t)},expression:"ioTRow.password"}})],1)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogIoTEditVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitIoTRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("d81d"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o=r("8f9b"),l=new o["AMapManager"],c={data:function(){var e=this,t=this,r=function(e,t,r){t&&!Object(n["c"])(t)?r(new Error("手机号不正确!")):r()},a=function(e,t,r){t&&!Object(n["b"])(t)?r(new Error("身份证号码不正确!")):r()},i=function(t,r,a){r&&e.ioTRows.length>0?e.ioTRows.map((function(e){e.name===r?a(new Error("关联编号不能相同!")):a()})):a()};return{curHeight:{height:"",overflow:"auto"},curHeight2:0,dialogMapVisible:!1,address:null,flag:"",params:{enterpriseId:window.sessionStorage.getItem("enterpriseId"),page:null,limit:null},dialogIoTVisible:!1,dialogIoTEditVisible:!1,ioTRows:[],ioTRow:{},currentPage:1,total:0,pageSize:20,searchKey:"",amapManager:l,markers:[],searchOption:{city:"全国",citylimit:!0},center:[121.329402,31.228667],zoom:17,lng:0,lat:0,loaded:!1,events:{init:function(){o["lazyAMapApiLoaderInstance"].load().then((function(){t.initSearch()}))},click:function(e){t.markers=[];var r=e.lnglat,a=r.lng,i=r.lat;t.lng=a,t.lat=i,t.center=[a,i],t.markers.push([a,i]);var s=new AMap.Geocoder({radius:1e3,extensions:"all"});s.getAddress([a,i],(function(e,r){"complete"===e&&"OK"===r.info&&r&&r.regeocode&&(t.address=r.regeocode.formattedAddress,t.searchKey=r.regeocode.formattedAddress,t.$nextTick())}))}},plugin:[{pName:"Geolocation",events:{init:function(e){e.getCurrentPosition((function(e,r){r&&r.position&&(t.center=[t.lng,t.lat],t.markers.push([t.lng,t.lat]),t.loaded=!0,t.$nextTick())}))}}},{pName:"ToolBar"},{pName:"PlaceSearch"}],row:{},updateUrl:"#",baseUrl:this.$baseImgUrl,imageUrl:"",srcList:[],srcList2:[],multfileImg:null,picBusinessLicenseListPhoto:[],dialogBusinessLicenseImageUrl:"",dialogBusinessLicenseVisible:!1,imgBusinessLicenseLists:[],fileBusinessLicenseLists:[],picCorporateIdentityCardListPhoto:[],dialogCorporateIdentityCardImageUrl:"",dialogCorporateIdentityCardVisible:!1,imgCorporateIdentityCardLists:[],fileCorporateIdentityCardLists:[],businessTypeOptions:[],organizationFormOptions:[],subjectAttributeOptions:[],districtOptions:[],ioTOptions:[],rules:{name:[{required:!0,message:"请输入企业名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20个字符",trigger:"blur"}],businessType:[{required:!0,message:"请选择企业类型",trigger:"blur"}],socialCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"},{min:18,max:18,message:"长度为18个字符",trigger:"blur"}],district:[{required:!0,message:"请选择行政区规划",trigger:"blur"}],organizationForm:[{required:!0,message:"请选择组织形式",trigger:"blur"}],subjectAttribute:[{required:!0,message:"请选择主体属性",trigger:"blur"}],contactPerson:[{required:!0,message:"请输入联系人",trigger:"blur"}],phone:[{required:!0,message:"请输入联系人手机号",trigger:"blur"},{required:!0,validator:r,trigger:"blur"}],deputyName:[{required:!0,message:"请输入法定代表人姓名",trigger:"blur"}],deputyIdCard:[{validator:a,trigger:"blur"}],deputyPhone:[{validator:r,trigger:"blur"}]},rules2:{name:[{required:!0,message:"请输入关联编号",trigger:"blur"},{validator:i,trigger:"blur"}],type:[{required:!0,message:"请选择物联网设备供应商",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},created:function(){var e=this;this.getBusinessTypeDictionary(),this.getOrganizationFormDictionary(),this.getSubjectAttributeDictionary(),this.getDistrictDictionary(),this.getIoTDictionary(),this.getList(),this.getIoTList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getBusinessTypeDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"企业类型",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业类型失败！"}));case 6:e.businessTypeOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getOrganizationFormDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"企业组织形式",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业组织形式失败！"}));case 6:e.organizationFormOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getSubjectAttributeDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"企业主体属性",remark:"X2"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业主体属性失败！"}));case 6:e.subjectAttributeOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getDistrictDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"镇乡"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取行政区规划失败！"}));case 6:e.districtOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getIoTDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"物联网供应"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"物联网设备供应商失败！"}));case 6:e.ioTOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},showMap:function(){this.dialogMapVisible=!0,this.lng=this.row.longitude,this.lat=this.row.latitude},getCoordinate:function(){this.$set(this.row,"longitude",this.lng),this.$set(this.row,"latitude",this.lat),this.dialogMapVisible=!1},initSearch:function(){var e=this,t=this.amapManager.getMap();AMapUI.loadUI(["misc/PoiPicker"],(function(r){var a=new r({input:"search",placeSearchOptions:{map:t,pageSize:10},suggestContainer:"searchTip",searchResultsContainer:"searchTip"});e.poiPicker=a,a.on("poiPicked",(function(t){var r=t.source,i=t.item;if("search"!==r)a.searchByKeyword(i.name);else{a.clearSearchResults(),e.markers=[];var s=i.location.lng,n=i.location.lat,o=i.cityname+i.adname+i.name;e.center=[s,n],e.markers.push([s,n]),e.lng=s,e.lat=n,e.address=o,e.searchKey=o}}))}))},searchByHand:function(){""!==this.searchKey&&this.poiPicker.searchByKeyword(this.searchKey)},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight.height=e-346+"px",this.curHeight2=e-500},getList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.row={},e.srcList=[],e.srcList2=[],e.fileBusinessLicenseLists=[],e.fileCorporateIdentityCardLists=[],e.imgBusinessLicenseLists=[],e.imgCorporateIdentityCardLists=[],t.next=9,e.$http.get("zsSys/Enterprise/"+window.sessionStorage.getItem("enterpriseId"));case 9:if(r=t.sent,a=r.data,200===a.status){t.next=13;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取企业基本信息失败！"}));case 13:if(e.row=a.data,e.row.delFileIds=[],a.data.enterpriseImageList&&0!==a.data.enterpriseImageList.length&&(e.imageUrl=e.baseUrl+a.data.enterpriseImageList[0].url),a.data.businessLicenseList&&0!==a.data.businessLicenseList.length)for(e.imgBusinessLicenseLists=a.data.businessLicenseList,i=0;i<e.imgBusinessLicenseLists.length;i++)e.srcList.push(e.baseUrl+e.imgBusinessLicenseLists[i].url);if(a.data.deputyIdCardPhotoList&&0!==a.data.deputyIdCardPhotoList.length)for(e.imgCorporateIdentityCardLists=a.data.deputyIdCardPhotoList,s=0;s<e.imgCorporateIdentityCardLists.length;s++)e.srcList2.push(e.baseUrl+e.imgCorporateIdentityCardLists[s].url);e.$nextTick((function(){e.$refs.row.clearValidate()}));case 19:case"end":return t.stop()}}),t)})))()},getIoTList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/EnterpriseWlUser/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取物联网账号信息失败！"}));case 8:e.ioTRows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getIoTList()},handleCurrentChange:function(e){this.currentPage=e,this.getIoTList()},closeDialog:function(){this.ioTRow={},this.getIoTList(),this.$refs.ioTRow.clearValidate()},addIoTRow:function(){this.dialogIoTEditVisible=!0,this.flag="add"},editIoTRow:function(e){this.ioTRow=e,this.dialogIoTEditVisible=!0,this.flag="edit"},deleteIoTRow:function(e){var t=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function r(){var a,i,s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.delete("zsSys/EnterpriseWlUser/"+e);case 2:if(a=r.sent,i=a.data,200===i.status){r.next=6;break}return r.abrupt("return",t.$message({duration:2e3,type:"error",message:"删除物联网账号失败！"}));case 6:return t.$message({duration:2e3,type:"success",message:"删除物联网账号成功！"}),r.next=9,t.getIoTList();case 9:if(0!==t.ioTRows.length){r.next=17;break}return t.row.isViewpoint=0,r.next=13,t.$http.put("zsSys/Enterprise",t.row);case 13:if(s=r.sent,n=s.data,200===n.status){r.next=17;break}return r.abrupt("return",t.$message.error("修改失败！"));case 17:case"end":return r.stop()}}),r)})))).catch((function(){t.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitIoTRow:Object(n["a"])((function(){var e=this;this.$refs.ioTRow.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:if(e.ioTRow.enterpriseId=window.sessionStorage.getItem("enterpriseId"),"add"!==e.flag){t.next=24;break}return t.next=6,e.$http.post("zsSys/EnterpriseWlUser",e.ioTRow);case 6:if(a=t.sent,i=a.data,200===i.status){t.next=10;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增物联网账号失败！"}));case 10:return t.next=12,e.getIoTList();case 12:if(0!==e.row.isViewpoint||0===e.ioTRows.length){t.next=20;break}return e.row.isViewpoint=1,t.next=16,e.$http.put("zsSys/Enterprise",e.row);case 16:if(s=t.sent,n=s.data,200===n.status){t.next=20;break}return t.abrupt("return",e.$message.error("修改失败！"));case 20:e.dialogIoTEditVisible=!1,e.$message({duration:2e3,type:"success",message:"新增物联网账号成功！"}),t.next=34;break;case 24:if("edit"!==e.flag){t.next=34;break}return t.next=27,e.$http.put("zsSys/EnterpriseWlUser",e.ioTRow);case 27:if(o=t.sent,l=o.data,200===l.status){t.next=31;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改物联网账号失败！"}));case 31:e.getIoTList(),e.dialogIoTEditVisible=!1,e.$message({duration:2e3,type:"success",message:"修改物联网账号成功！"});case 34:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),httpRequest01:function(e){var t=this,r=new FileReader,a=e.file;r.readAsDataURL(a),r.onloadend=function(){t.imageUrl=this.result,t.row.delFileIds.push(t.row.enterpriseImageList[0].id)}},httpRequest02:function(e){var t=this,r=new FileReader,a=e.file;r.readAsDataURL(a),r.onloadend=function(){t.dialogBusinessLicenseImageUrl=this.result}},httpRequest03:function(e){var t=this,r=new FileReader,a=e.file;r.readAsDataURL(a),r.onloadend=function(){t.dialogCorporateIdentityCardImageUrl=this.result}},beforeAvatarUpload:function(e){this.multfileImg=e;var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},beforeAvatarUpload02:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleBusinessLicensePreview:function(e){this.dialogBusinessLicenseImageUrl=e.url,this.dialogBusinessLicenseVisible=!0},handleBusinessLicenseRemove:function(e,t){for(var r in this.picBusinessLicenseListPhoto)this.picBusinessLicenseListPhoto[r].key===e.uid&&this.picBusinessLicenseListPhoto.splice(r,1);this.fileBusinessLicenseLists=t},handleChangeBusinessLicensePhoto:function(e,t){this.fileBusinessLicenseLists=t},fileBusinessLicenseDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgBusinessLicenseLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},handleCorporateIdentityCardPreview:function(e){this.dialogCorporateIdentityCardImageUrl=e.url,this.dialogCorporateIdentityCardVisible=!0},handleCorporateIdentityCardRemove:function(e,t){for(var r in this.picCorporateIdentityCardListPhoto)this.picCorporateIdentityCardListPhoto[r].key===e.uid&&this.picCorporateIdentityCardListPhoto.splice(r,1);this.fileCorporateIdentityCardLists=t},handleChangeCorporateIdentityCardPhoto:function(e,t){this.fileCorporateIdentityCardLists=t},fileCorporateIdentityCardDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgCorporateIdentityCardLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.$confirm("此操作将修改企业基本信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"enterpriseImageList"===i||"businessLicenseList"===i||"deputyIdCardPhotoList"===i||null!==s&&a.append(i,s);if(null!=e.multfileImg&&a.append("enterpriseImageFiles",e.multfileImg),null!=e.fileBusinessLicenseLists)for(n=0;n<e.fileBusinessLicenseLists.length;n++)a.append("businessLicenseFiles",e.fileBusinessLicenseLists[n].raw);if(null!=e.fileCorporateIdentityCardLists)for(o=0;o<e.fileCorporateIdentityCardLists.length;o++)a.append("deputyIdCardPhotoFiles\t",e.fileCorporateIdentityCardLists[o].raw);return t.next=9,e.$http.put("zsSys/Enterprise/updateDataAndFile",a);case 9:if(l=t.sent,c=l.data,200===c.status){t.next=13;break}return t.abrupt("return",e.$message.error("修改失败！"));case 13:e.$message.success("修改成功！"),e.getList();case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))}),3e3),registerMoneyChange:function(e){this.$set(this.row,"registerMoney",e.target.value)},phoneChange:function(e){this.$set(this.row,"phone",e.target.value)},deputyPhoneChange:function(e){this.$set(this.row,"deputyPhone",e.target.value)},postcodeChange:function(e){this.$set(this.row,"postcode",e.target.value)},getDictionaryName:function(e){for(var t=0;t<this.ioTOptions.length;t++)if(e===this.ioTOptions[t].code)return this.ioTOptions[t].name}}},u=c,d=(r("c44f"),r("d87e"),r("2877")),p=Object(d["a"])(u,a,i,!1,null,"4a89d24c",null);t["default"]=p.exports},c44f:function(e,t,r){"use strict";r("2a0a")},cace:function(e,t,r){},cfef:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("基本配置")]),r("el-breadcrumb-item",[e._v("供应商管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("供应商名称:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入供应商名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"供应商名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"联系人",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.contactPerson)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"联系电话",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.phone)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"供应商地址","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.address,placement:"top"}},[r("span",[e._v(e._s(t.row.address))])])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"供应商信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"140px",rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"供应商名称:",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入供应商名称"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"联系人:",prop:"contactPerson"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入联系人姓名"},model:{value:e.row.contactPerson,callback:function(t){e.$set(e.row,"contactPerson",t)},expression:"row.contactPerson"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"联系电话:",prop:"phone"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",onkeyup:"value=value.replace(/[^\\d]/g,'')",placeholder:"请输入联系人电话"},on:{blur:e.phoneChange},model:{value:e.row.phone,callback:function(t){e.$set(e.row,"phone",t)},expression:"row.phone"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"邮箱:",prop:"mailbox"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入邮箱"},model:{value:e.row.mailbox,callback:function(t){e.$set(e.row,"mailbox",t)},expression:"row.mailbox"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"供应商地址:",prop:"address"}},[r("el-input",{attrs:{clearable:"",maxlength:"255",placeholder:"请输入供应商地址"},model:{value:e.row.address,callback:function(t){e.$set(e.row,"address",t)},expression:"row.address"}})],1)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("96cf"),r("1da1")),n=r("567f"),o={data:function(){var e=function(e,t,r){Object(n["c"])(t)?r():r(new Error("手机号不正确!"))};return{params:{page:null,limit:null,name:null,enterpriseId:window.sessionStorage.getItem("enterpriseId")},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,dialogShow:!1,selectRows:[],rules:{name:[{required:!0,message:"请输入供应商名称",trigger:"blur"}],contactPerson:[{required:!0,message:"请输入联系人",trigger:"blur"}],phone:[{required:!0,message:"请输入联系电话",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}]}}},created:function(){var e=this;this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/Supplier/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取供应商数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},closeDialog:function(){this.row={},this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){this.row=e,this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/Supplier/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除供应商失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除供应商成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.row.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:if("add"!==e.flag){t.next=14;break}return t.next=5,e.$http.post("zsSys/Supplier",e.row);case 5:if(a=t.sent,i=a.data,200===i.status){t.next=9;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增供应商失败！"}));case 9:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增供应商成功！"}),t.next=24;break;case 14:if("edit"!==e.flag){t.next=24;break}return t.next=17,e.$http.put("zsSys/Supplier",e.row);case 17:if(s=t.sent,n=s.data,200===n.status){t.next=21;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改供应商失败！"}));case 21:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改供应商成功！"});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),phoneChange:function(e){this.$set(this.row,"phone",e.target.value)}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"46c5d862",null);t["default"]=u.exports},d044:function(e,t,r){var a;(function(t,r){e.exports=r()})(0,(function(){function e(e){this.mode=r.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,a=this.data.length;t<a;t++){var i=[],s=this.data.charCodeAt(t);s>65536?(i[0]=240|(1835008&s)>>>18,i[1]=128|(258048&s)>>>12,i[2]=128|(4032&s)>>>6,i[3]=128|63&s):s>2048?(i[0]=224|(61440&s)>>>12,i[1]=128|(4032&s)>>>6,i[2]=128|63&s):s>128?(i[0]=192|(1984&s)>>>6,i[1]=128|63&s):i[0]=s,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,r=this.parsedData.length;t<r;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var r=new e(t);this.dataList.push(r),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,r){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var a=0;a<this.moduleCount;a++){this.modules[a]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[a][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,r),this.typeNumber>=7&&this.setupTypeNumber(e),null==this.dataCache&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,r)},setupPositionProbePattern:function(e,t){for(var r=-1;r<=7;r++)if(!(e+r<=-1||this.moduleCount<=e+r))for(var a=-1;a<=7;a++)t+a<=-1||this.moduleCount<=t+a||(this.modules[e+r][t+a]=0<=r&&r<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=a&&a<=4)},getBestMaskPattern:function(){for(var e=0,t=0,r=0;r<8;r++){this.makeImpl(!0,r);var a=n.getLostPoint(this);(0==r||e>a)&&(e=a,t=r)}return t},createMovieClip:function(e,t,r){var a=e.createEmptyMovieClip(t,r),i=1;this.make();for(var s=0;s<this.modules.length;s++)for(var n=s*i,o=0;o<this.modules[s].length;o++){var l=o*i,c=this.modules[s][o];c&&(a.beginFill(0,100),a.moveTo(l,n),a.lineTo(l+i,n),a.lineTo(l+i,n+i),a.lineTo(l,n+i),a.endFill())}return a},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0);for(var t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var e=n.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var r=0;r<e.length;r++){var a=e[t],i=e[r];if(null==this.modules[a][i])for(var s=-2;s<=2;s++)for(var o=-2;o<=2;o++)this.modules[a+s][i+o]=-2==s||2==s||-2==o||2==o||0==s&&0==o}},setupTypeNumber:function(e){for(var t=n.getBCHTypeNumber(this.typeNumber),r=0;r<18;r++){var a=!e&&1==(t>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=a}for(r=0;r<18;r++){a=!e&&1==(t>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=a}},setupTypeInfo:function(e,t){for(var r=this.errorCorrectLevel<<3|t,a=n.getBCHTypeInfo(r),i=0;i<15;i++){var s=!e&&1==(a>>i&1);i<6?this.modules[i][8]=s:i<8?this.modules[i+1][8]=s:this.modules[this.moduleCount-15+i][8]=s}for(i=0;i<15;i++){s=!e&&1==(a>>i&1);i<8?this.modules[8][this.moduleCount-i-1]=s:i<9?this.modules[8][15-i-1+1]=s:this.modules[8][15-i-1]=s}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){for(var r=-1,a=this.moduleCount-1,i=7,s=0,o=this.moduleCount-1;o>0;o-=2){6==o&&o--;while(1){for(var l=0;l<2;l++)if(null==this.modules[a][o-l]){var c=!1;s<e.length&&(c=1==(e[s]>>>i&1));var u=n.getMask(t,a,o-l);u&&(c=!c),this.modules[a][o-l]=c,i--,-1==i&&(s++,i=7)}if(a+=r,a<0||this.moduleCount<=a){a-=r,r=-r;break}}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,r,a){for(var i=u.getRSBlocks(e,r),s=new d,o=0;o<a.length;o++){var l=a[o];s.put(l.mode,4),s.put(l.getLength(),n.getLengthInBits(l.mode,e)),l.write(s)}var c=0;for(o=0;o<i.length;o++)c+=i[o].dataCount;if(s.getLengthInBits()>8*c)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*c+")");s.getLengthInBits()+4<=8*c&&s.put(0,4);while(s.getLengthInBits()%8!=0)s.putBit(!1);while(1){if(s.getLengthInBits()>=8*c)break;if(s.put(t.PAD0,8),s.getLengthInBits()>=8*c)break;s.put(t.PAD1,8)}return t.createBytes(s,i)},t.createBytes=function(e,t){for(var r=0,a=0,i=0,s=new Array(t.length),o=new Array(t.length),l=0;l<t.length;l++){var u=t[l].dataCount,d=t[l].totalCount-u;a=Math.max(a,u),i=Math.max(i,d),s[l]=new Array(u);for(var p=0;p<s[l].length;p++)s[l][p]=255&e.buffer[p+r];r+=u;var h=n.getErrorCorrectPolynomial(d),g=new c(s[l],h.getLength()-1),m=g.mod(h);o[l]=new Array(h.getLength()-1);for(p=0;p<o[l].length;p++){var f=p+m.getLength()-o[l].length;o[l][p]=f>=0?m.get(f):0}}var b=0;for(p=0;p<t.length;p++)b+=t[p].totalCount;var w=new Array(b),v=0;for(p=0;p<a;p++)for(l=0;l<t.length;l++)p<s[l].length&&(w[v++]=s[l][p]);for(p=0;p<i;p++)for(l=0;l<t.length;l++)p<o[l].length&&(w[v++]=o[l][p]);return w};for(var r={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},i={L:1,M:0,Q:3,H:2},s={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},n={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){var t=e<<10;while(n.getBCHDigit(t)-n.getBCHDigit(n.G15)>=0)t^=n.G15<<n.getBCHDigit(t)-n.getBCHDigit(n.G15);return(e<<10|t)^n.G15_MASK},getBCHTypeNumber:function(e){var t=e<<12;while(n.getBCHDigit(t)-n.getBCHDigit(n.G18)>=0)t^=n.G18<<n.getBCHDigit(t)-n.getBCHDigit(n.G18);return e<<12|t},getBCHDigit:function(e){var t=0;while(0!=e)t++,e>>>=1;return t},getPatternPosition:function(e){return n.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,r){switch(e){case s.PATTERN000:return(t+r)%2==0;case s.PATTERN001:return t%2==0;case s.PATTERN010:return r%3==0;case s.PATTERN011:return(t+r)%3==0;case s.PATTERN100:return(Math.floor(t/2)+Math.floor(r/3))%2==0;case s.PATTERN101:return t*r%2+t*r%3==0;case s.PATTERN110:return(t*r%2+t*r%3)%2==0;case s.PATTERN111:return(t*r%3+(t+r)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new c([1],0),r=0;r<e;r++)t=t.multiply(new c([1,o.gexp(r)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case r.MODE_NUMBER:return 10;case r.MODE_ALPHA_NUM:return 9;case r.MODE_8BIT_BYTE:return 8;case r.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case r.MODE_NUMBER:return 12;case r.MODE_ALPHA_NUM:return 11;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case r.MODE_NUMBER:return 14;case r.MODE_ALPHA_NUM:return 13;case r.MODE_8BIT_BYTE:return 16;case r.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){for(var t=e.getModuleCount(),r=0,a=0;a<t;a++)for(var i=0;i<t;i++){for(var s=0,n=e.isDark(a,i),o=-1;o<=1;o++)if(!(a+o<0||t<=a+o))for(var l=-1;l<=1;l++)i+l<0||t<=i+l||0==o&&0==l||n==e.isDark(a+o,i+l)&&s++;s>5&&(r+=3+s-5)}for(a=0;a<t-1;a++)for(i=0;i<t-1;i++){var c=0;e.isDark(a,i)&&c++,e.isDark(a+1,i)&&c++,e.isDark(a,i+1)&&c++,e.isDark(a+1,i+1)&&c++,0!=c&&4!=c||(r+=3)}for(a=0;a<t;a++)for(i=0;i<t-6;i++)e.isDark(a,i)&&!e.isDark(a,i+1)&&e.isDark(a,i+2)&&e.isDark(a,i+3)&&e.isDark(a,i+4)&&!e.isDark(a,i+5)&&e.isDark(a,i+6)&&(r+=40);for(i=0;i<t;i++)for(a=0;a<t-6;a++)e.isDark(a,i)&&!e.isDark(a+1,i)&&e.isDark(a+2,i)&&e.isDark(a+3,i)&&e.isDark(a+4,i)&&!e.isDark(a+5,i)&&e.isDark(a+6,i)&&(r+=40);var u=0;for(i=0;i<t;i++)for(a=0;a<t;a++)e.isDark(a,i)&&u++;var d=Math.abs(100*u/t/t-50)/5;return r+=10*d,r}},o={glog:function(e){if(e<1)throw new Error("glog("+e+")");return o.LOG_TABLE[e]},gexp:function(e){while(e<0)e+=255;while(e>=256)e-=255;return o.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},l=0;l<8;l++)o.EXP_TABLE[l]=1<<l;for(l=8;l<256;l++)o.EXP_TABLE[l]=o.EXP_TABLE[l-4]^o.EXP_TABLE[l-5]^o.EXP_TABLE[l-6]^o.EXP_TABLE[l-8];for(l=0;l<255;l++)o.LOG_TABLE[o.EXP_TABLE[l]]=l;function c(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);var r=0;while(r<e.length&&0==e[r])r++;this.num=new Array(e.length-r+t);for(var a=0;a<e.length-r;a++)this.num[a]=e[a+r]}function u(e,t){this.totalCount=e,this.dataCount=t}function d(){this.buffer=[],this.length=0}c.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),r=0;r<this.getLength();r++)for(var a=0;a<e.getLength();a++)t[r+a]^=o.gexp(o.glog(this.get(r))+o.glog(e.get(a)));return new c(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;for(var t=o.glog(this.get(0))-o.glog(e.get(0)),r=new Array(this.getLength()),a=0;a<this.getLength();a++)r[a]=this.get(a);for(a=0;a<e.getLength();a++)r[a]^=o.gexp(o.glog(e.get(a))+t);return new c(r,0).mod(e)}},u.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],u.getRSBlocks=function(e,t){var r=u.getRsBlockTable(e,t);if(void 0==r)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);for(var a=r.length/3,i=[],s=0;s<a;s++)for(var n=r[3*s+0],o=r[3*s+1],l=r[3*s+2],c=0;c<n;c++)i.push(new u(o,l));return i},u.getRsBlockTable=function(e,t){switch(t){case i.L:return u.RS_BLOCK_TABLE[4*(e-1)+0];case i.M:return u.RS_BLOCK_TABLE[4*(e-1)+1];case i.Q:return u.RS_BLOCK_TABLE[4*(e-1)+2];case i.H:return u.RS_BLOCK_TABLE[4*(e-1)+3];default:return}},d.prototype={get:function(e){var t=Math.floor(e/8);return 1==(this.buffer[t]>>>7-e%8&1)},put:function(e,t){for(var r=0;r<t;r++)this.putBit(1==(e>>>t-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]];function h(){return"undefined"!=typeof CanvasRenderingContext2D}function g(){var e=!1,t=navigator.userAgent;if(/android/i.test(t)){e=!0;var r=t.toString().match(/android ([0-9]\.[0-9])/i);r&&r[1]&&(e=parseFloat(r[1]))}return e}var m=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){var t=this._htOption,r=this._el,a=e.getModuleCount();Math.floor(t.width/a),Math.floor(t.height/a);function i(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg",e);for(var a in t)t.hasOwnProperty(a)&&r.setAttribute(a,t[a]);return r}this.clear();var s=i("svg",{viewBox:"0 0 "+String(a)+" "+String(a),width:"100%",height:"100%",fill:t.colorLight});s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),r.appendChild(s),s.appendChild(i("rect",{fill:t.colorLight,width:"100%",height:"100%"})),s.appendChild(i("rect",{fill:t.colorDark,width:"1",height:"1",id:"template"}));for(var n=0;n<a;n++)for(var o=0;o<a;o++)if(e.isDark(n,o)){var l=i("use",{x:String(o),y:String(n)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),s.appendChild(l)}},e.prototype.clear=function(){while(this._el.hasChildNodes())this._el.removeChild(this._el.lastChild)},e}(),f="svg"===document.documentElement.tagName.toLowerCase(),b=f?m:h()?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}if(this._android&&this._android<=2.1){var t=1/window.devicePixelRatio,r=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,a,i,s,n,o,l,c,u){if("nodeName"in e&&/img/i.test(e.nodeName))for(var d=arguments.length-1;d>=1;d--)arguments[d]=arguments[d]*t;else"undefined"==typeof c&&(arguments[1]*=t,arguments[2]*=t,arguments[3]*=t,arguments[4]*=t);r.apply(this,arguments)}}function a(e,t){var r=this;if(r._fFail=t,r._fSuccess=e,null===r._bSupportDataURI){var a=document.createElement("img"),i=function(){r._bSupportDataURI=!1,r._fFail&&r._fFail.call(r)},s=function(){r._bSupportDataURI=!0,r._fSuccess&&r._fSuccess.call(r)};return a.onabort=i,a.onerror=i,a.onload=s,void(a.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}!0===r._bSupportDataURI&&r._fSuccess?r._fSuccess.call(r):!1===r._bSupportDataURI&&r._fFail&&r._fFail.call(r)}var i=function(e,t){this._bIsPainted=!1,this._android=g(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(e){var t=this._elImage,r=this._oContext,a=this._htOption,i=e.getModuleCount(),s=a.width/i,n=a.height/i,o=Math.round(s),l=Math.round(n);t.style.display="none",this.clear();for(var c=0;c<i;c++)for(var u=0;u<i;u++){var d=e.isDark(c,u),p=u*s,h=c*n;r.strokeStyle=d?a.colorDark:a.colorLight,r.lineWidth=1,r.fillStyle=d?a.colorDark:a.colorLight,r.fillRect(p,h,s,n),r.strokeRect(Math.floor(p)+.5,Math.floor(h)+.5,o,l),r.strokeRect(Math.ceil(p)-.5,Math.ceil(h)-.5,o,l)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&a.call(this,e)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(e){return e?Math.floor(1e3*e)/1e3:e},i}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){for(var t=this._htOption,r=this._el,a=e.getModuleCount(),i=Math.floor(t.width/a),s=Math.floor(t.height/a),n=['<table style="border:0;border-collapse:collapse;">'],o=0;o<a;o++){n.push("<tr>");for(var l=0;l<a;l++)n.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+s+"px;background-color:"+(e.isDark(o,l)?t.colorDark:t.colorLight)+';"></td>');n.push("</tr>")}n.push("</table>"),r.innerHTML=n.join("");var c=r.childNodes[0],u=(t.width-c.offsetWidth)/2,d=(t.height-c.offsetHeight)/2;u>0&&d>0&&(c.style.margin=d+"px "+u+"px")},e.prototype.clear=function(){this._el.innerHTML=""},e}();function w(e,t){for(var r=1,a=v(e),s=0,n=p.length;s<=n;s++){var o=0;switch(t){case i.L:o=p[s][0];break;case i.M:o=p[s][1];break;case i.Q:o=p[s][2];break;case i.H:o=p[s][3];break}if(a<=o)break;r++}if(r>p.length)throw new Error("Too long data");return r}function v(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}return a=function(e,t){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:i.H},"string"===typeof t&&(t={text:t}),t)for(var r in t)this._htOption[r]=t[r];"string"==typeof e&&(e=document.getElementById(e)),this._htOption.useSVG&&(b=m),this._android=g(),this._el=e,this._oQRCode=null,this._oDrawing=new b(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},a.prototype.makeCode=function(e){this._oQRCode=new t(w(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},a.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},a.prototype.clear=function(){this._oDrawing.clear()},a.CorrectLevel=i,a}))},d784:function(e,t,r){"use strict";r("ac1f");var a=r("6eeb"),i=r("d039"),s=r("b622"),n=r("9263"),o=r("9112"),l=s("species"),c=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),d=s("replace"),p=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),h=!i((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));e.exports=function(e,t,r,d){var g=s(e),m=!i((function(){var t={};return t[g]=function(){return 7},7!=""[e](t)})),f=m&&!i((function(){var t=!1,r=/a/;return"split"===e&&(r={},r.constructor={},r.constructor[l]=function(){return r},r.flags="",r[g]=/./[g]),r.exec=function(){return t=!0,null},r[g](""),!t}));if(!m||!f||"replace"===e&&(!c||!u||p)||"split"===e&&!h){var b=/./[g],w=r(g,""[e],(function(e,t,r,a,i){return t.exec===n?m&&!i?{done:!0,value:b.call(t,r,a)}:{done:!0,value:e.call(r,t,a)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),v=w[0],y=w[1];a(String.prototype,e,v),a(RegExp.prototype,g,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}d&&o(RegExp.prototype[g],"sham",!0)}},d81d:function(e,t,r){"use strict";var a=r("23e7"),i=r("b727").map,s=r("1dde"),n=r("ae40"),o=s("map"),l=n("map");a({target:"Array",proto:!0,forced:!o||!l},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},d87e:function(e,t,r){"use strict";r("1099")},db7d:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("生产管理")]),r("el-breadcrumb-item",[e._v("收购管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("收购产品名称:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入收购产品名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("收购起始时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择起始时间"},model:{value:e.params.buyDateS,callback:function(t){e.$set(e.params,"buyDateS",t)},expression:"params.buyDateS"}})],1),r("div",{staticClass:"query-item"},[r("span",[e._v("收购结束时间:")]),r("el-date-picker",{staticStyle:{width:"160px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择结束时间"},model:{value:e.params.buyDateE,callback:function(t){e.$set(e.params,"buyDateE",t)},expression:"params.buyDateE"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"收购码",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.traceCode)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收购产品名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收购总价(元)",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.buyTotal)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收购数量",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.buyAmount+e.getDictionaryName(t.row.buyAmountUnit))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"收购时间",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.filterTime(t.row.buyDate))+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"描述","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.description)+" ")]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"收购信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"120px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购码:",prop:"traceCode"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入收购码"},model:{value:e.row.traceCode,callback:function(t){e.$set(e.row,"traceCode",t)},expression:"row.traceCode"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购产品名称:",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入收购产品名称"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购总价(元):",prop:"buyTotal"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入收购总价(元)"},on:{blur:e.buyTotalChange},model:{value:e.row.buyTotal,callback:function(t){e.$set(e.row,"buyTotal",t)},expression:"row.buyTotal"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购时间:",prop:"buyDate"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",clearable:"",placeholder:"请选择收购时间"},model:{value:e.row.buyDate,callback:function(t){e.$set(e.row,"buyDate",t)},expression:"row.buyDate"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购数量:",prop:"buyAmount"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入收购数量"},on:{blur:e.buyAmountChange},model:{value:e.row.buyAmount,callback:function(t){e.$set(e.row,"buyAmount",t)},expression:"row.buyAmount"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"收购数量单位:",prop:"buyAmountUnit"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择收购数量单位"},model:{value:e.row.buyAmountUnit,callback:function(t){e.$set(e.row,"buyAmountUnit",t)},expression:"row.buyAmountUnit"}},e._l(e.amountUnitOptions,(function(e){return r("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})})),1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{attrs:{label:"描述:",prop:"description"}},[r("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入商品介绍",maxlength:"255"},model:{value:e.row.description,callback:function(t){e.$set(e.row,"description",t)},expression:"row.description"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"收购图片",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleBuyPicturePreview,"on-remove":e.handleBuyPictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeBuyPicturePhoto,"file-list":e.fileBuyPictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogBuyPictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogBuyPictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogBuyPictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgBuyPictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileBuyPictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("fb6a"),r("a434"),r("b0c0"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){return{params:{page:null,limit:null,name:null,buyDateS:null,buyDateE:null,enterpriseId:window.sessionStorage.getItem("enterpriseId"),sysModule:2},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,activeName:"first",dialogShow:!1,selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],picBuyPictureListPhoto:[],dialogBuyPictureImageUrl:"",dialogBuyPictureVisible:!1,imgBuyPictureLists:[],fileBuyPictureLists:[],amountUnitOptions:[],rules:{traceCode:[{required:!0,message:"请输入收购码",trigger:"blur"}],name:[{required:!0,message:"请输入收购产品名称",trigger:"blur"}],buyDate:[{required:!0,message:"请选择收购时间",trigger:"blur"}],buyAmount:[{required:!0,message:"请输入收购数量",trigger:"blur"}],buyAmountUnit:[{required:!0,message:"请选择收购数量单位",trigger:"blur"}]}}},created:function(){var e=this;this.getAmountUnitDictionary(),this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAmountUnitDictionary:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("comSys/DataDictionary/getAllMayToCondition",{params:{type:"数量单位"}});case 2:if(r=t.sent,a=r.data,200===a.status){t.next=6;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取数量单位失败！"}));case 6:e.amountUnitOptions=a.data;case 7:case"end":return t.stop()}}),t)})))()},getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/BuyInfo/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取收购数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogBuyPictureImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleBuyPicturePreview:function(e){this.dialogBuyPictureImageUrl=e.url,this.dialogBuyPictureVisible=!0},handleBuyPictureRemove:function(e,t){for(var r in this.picBuyPictureListPhoto)this.picBuyPictureListPhoto[r].key===e.uid&&this.picBuyPictureListPhoto.splice(r,1);this.fileBuyPictureLists=t},handleChangeBuyPicturePhoto:function(e,t){this.fileBuyPictureLists=t},fileBuyPictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgBuyPictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.picBuyPictureListPhoto=[],this.imgBuyPictureLists=[],this.fileBuyPictureLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.row.delFileIds=[],e.buyPictureList&&0!==e.buyPictureList.length){this.imgBuyPictureLists=e.buyPictureList;for(var t=0;t<this.imgBuyPictureLists.length;t++)this.srcList.push(this.baseUrl+this.imgBuyPictureLists[t].url)}this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/BuyInfo/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除收购失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除收购成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.row.sysModule=2,this.row.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"buyPictureList"===i||null!==s&&a.append(i,s);if(null!=e.fileBuyPictureLists)for(n=0;n<e.fileBuyPictureLists.length;n++)a.append("buyPictureFiles\t",e.fileBuyPictureLists[n].raw);if("add"!==e.flag){t.next=17;break}return t.next=8,e.$http.post("zsSys/BuyInfo/addDataAndFile",a);case 8:if(o=t.sent,l=o.data,200===l.status){t.next=12;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增收购失败！"}));case 12:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增收购成功！"}),t.next=27;break;case 17:if("edit"!==e.flag){t.next=27;break}return t.next=20,e.$http.put("zsSys/BuyInfo/updateDataAndFile",a);case 20:if(c=t.sent,u=c.data,200===u.status){t.next=24;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改收购失败！"}));case 24:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改收购成功！"});case 27:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),filterTime:function(e){return e?e.slice(0,10):e},buyAmountChange:function(e){this.$set(this.row,"buyAmount",e.target.value)},buyTotalChange:function(e){this.$set(this.row,"buyTotal",e.target.value)},getDictionaryName:function(e){for(var t=0;t<this.amountUnitOptions.length;t++)if(e===this.amountUnitOptions[t].code)return this.amountUnitOptions[t].name}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"7a4ebe0a",null);t["default"]=u.exports},e8b5:function(e,t,r){var a=r("c6b6");e.exports=Array.isArray||function(e){return"Array"==a(e)}},e9c3:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("首页")]),r("el-breadcrumb-item",[e._v("基本配置")]),r("el-breadcrumb-item",[e._v("生产基地管理")])],1),r("el-card",[r("div",{staticClass:"query-condition"},[r("div",{staticClass:"query-item"},[r("span",[e._v("生产基地名称:")]),r("el-input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入生产基地名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1),r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchRow}},[e._v("查询")])],1),r("div",[r("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-plus"},on:{click:e.addRow}},[e._v("新增")]),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.deleteList}},[e._v("删除")])],1),r("el-table",{ref:"myTable",attrs:{data:e.rows,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"},height:e.curHeight},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",align:"center"}}),r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.currentPage-1)*e.pageSize+t.$index+1)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",icon:"el-icon-edit-outline"},on:{click:function(r){return e.editRow(t.row)}}},[e._v("编辑")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"生产基地名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.name)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"基地面积/规模",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.area+"亩")+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"基地负责人",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lender)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"基地负责人电话",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.lenderPhone)+" ")]}}])}),r("el-table-column",{attrs:{align:"center",label:"生产环境检验结果",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isReportQualified?r("el-tag",{attrs:{type:"success"}},[e._v("合格")]):r("el-tag",{attrs:{type:"danger"}},[e._v("不合格")])]}}])}),r("el-table-column",{attrs:{align:"center",label:"生产基地位置","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tooltip",{attrs:{effect:"light",content:t.row.address,placement:"top"}},[r("span",[e._v(e._s(t.row.address))])])]}}])})],1),r("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{staticClass:"row-form",attrs:{title:"生产基地信息",center:"",visible:e.dialogShow,width:"1000px"},on:{close:e.closeDialog,"update:visible":function(t){e.dialogShow=t}}},[r("el-form",{ref:"row",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"150px",rules:e.rules}},[r("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地名称:",prop:"name"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入生产基地名称"},model:{value:e.row.name,callback:function(t){e.$set(e.row,"name",t)},expression:"row.name"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产基地位置:",prop:"address"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入生产基地位置"},model:{value:e.row.address,callback:function(t){e.$set(e.row,"address",t)},expression:"row.address"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"基地面积/规模(亩):",prop:"area"}},[r("el-input",{attrs:{clearable:"",onkeyup:"value=value.replace(/[^\\d^\\.]/g,'')",placeholder:"请输入基地面积/规模(亩)"},on:{blur:e.areaChange},model:{value:e.row.area,callback:function(t){e.$set(e.row,"area",t)},expression:"row.area"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"生产环境检验结果:",prop:"isReportQualified"}},[r("el-radio",{attrs:{label:1},model:{value:e.row.isReportQualified,callback:function(t){e.$set(e.row,"isReportQualified",t)},expression:"row.isReportQualified"}},[e._v("合格")]),r("el-radio",{attrs:{label:0},model:{value:e.row.isReportQualified,callback:function(t){e.$set(e.row,"isReportQualified",t)},expression:"row.isReportQualified"}},[e._v("不合格")])],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"基地负责人:",prop:"lender"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入基地负责人姓名"},model:{value:e.row.lender,callback:function(t){e.$set(e.row,"lender",t)},expression:"row.lender"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"基地负责人电话:",prop:"lenderPhone"}},[r("el-input",{attrs:{clearable:"",maxlength:"50",onkeyup:"value=value.replace(/[^\\d]/g,'')",placeholder:"请输入基地负责人电话"},on:{blur:e.lenderPhoneChange},model:{value:e.row.lenderPhone,callback:function(t){e.$set(e.row,"lenderPhone",t)},expression:"row.lenderPhone"}})],1)],1)],1)],1),r("el-tab-pane",{attrs:{label:"基地图片",name:"second"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest2,"list-type":"picture-card","on-preview":e.handleBasePicturePreview,"on-remove":e.handleBasePictureRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeBasePicturePhoto,"file-list":e.fileBasePictureLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogBasePictureVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogBasePictureVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogBasePictureImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgBasePictureLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileBasePictureDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList2}})],1)})),0)],1),r("el-tab-pane",{attrs:{label:"检验报告",name:"third"}},[r("el-upload",{attrs:{action:e.updateUrl,multiple:"","http-request":e.httpRequest,"list-type":"picture-card","on-preview":e.handleInspectionReportPreview,"on-remove":e.handleInspectionReportRemove,"before-upload":e.beforeAvatarUpload,"on-change":e.handleChangeInspectionReportPhoto,"file-list":e.fileInspectionReportLists}},[r("i",{staticClass:"el-icon-plus"})]),r("el-dialog",{attrs:{visible:e.dialogInspectionReportVisible,width:"70%",top:"5vh","append-to-body":!0},on:{"update:visible":function(t){e.dialogInspectionReportVisible=t}}},[r("img",{attrs:{width:"100%",src:e.dialogInspectionReportImageUrl,alt:""}})]),r("div",{staticClass:"upload-div"},e._l(e.imgInspectionReportLists,(function(t,a){return r("div",{key:a,staticClass:"upload-div-list"},[r("div",{staticClass:"upload-div-top"},[r("span",{staticClass:"upload-div-del",on:{click:function(r){return e.fileInspectionReportDelIdPhoto(a,t.id)}}},[e._v("X")])]),r("el-image",{attrs:{src:e.baseUrl+t.url,"preview-src-list":e.srcList}})],1)})),0)],1)],1),r("span",{staticClass:"t-btn"},[r("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},i=[],s=(r("a434"),r("96cf"),r("1da1")),n=r("567f"),o={data:function(){var e=function(e,t,r){Object(n["c"])(t)?r():r(new Error("手机号不正确!"))};return{params:{page:null,limit:null,name:null,baseType:"加工基地",enterpriseId:window.sessionStorage.getItem("enterpriseId")},rows:[],row:{},flag:"",currentPage:1,total:0,pageSize:20,curHeight:0,activeName:"first",dialogShow:!1,selectRows:[],updateUrl:"#",baseUrl:this.$baseImgUrl,srcList:[],srcList2:[],picInspectionReportListPhoto:[],dialogInspectionReportImageUrl:"",dialogInspectionReportVisible:!1,imgInspectionReportLists:[],fileInspectionReportLists:[],picBasePictureListPhoto:[],dialogBasePictureImageUrl:"",dialogBasePictureVisible:!1,imgBasePictureLists:[],fileBasePictureLists:[],rules:{name:[{required:!0,message:"请输入生产基地名称",trigger:"blur"}],address:[{required:!0,message:"请输入生产基地位置",trigger:"blur"}],area:[{required:!0,message:"请输入基地面积/规模",trigger:"blur"}],isReportQualified:[{required:!0,message:"请选择生产环境检验结果",trigger:"blur"}],lender:[{required:!0,message:"请输入基地负责人",trigger:"blur"}],lenderPhone:[{required:!0,message:"请输入基地负责人电话",trigger:"blur"},{required:!0,validator:e,trigger:"blur"}]}}},created:function(){var e=this;this.getAllList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{getAllList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.params.page=e.currentPage,e.params.limit=e.pageSize,t.next=4,e.$http.get("zsSys/BaseInfo/pageByEId",{params:e.params});case 4:if(r=t.sent,a=r.data,200===a.status){t.next=8;break}return t.abrupt("return",e.$message({duration:1e3,type:"error",message:"获取生产基地数据失败！"}));case 8:e.rows=a.data.rows,e.total=a.data.total;case 10:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.pageSize=e,this.getAllList()},handleCurrentChange:function(e){this.currentPage=e,this.getAllList()},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-380},handleSelectionChange:function(e){this.selectRows=e},clearFilter:function(){this.$refs.myTable.clearSelection()},httpRequest:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogInspectionReportImageUrl=this.result}},httpRequest2:function(e){var t=new FileReader,r=e.file;t.readAsDataURL(r),t.onloadend=function(){this.dialogBasePictureImageUrl=this.result}},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type;return t||r||this.$message.error("上传图片格式只能为.jpg或.png!"),t||r},handleInspectionReportPreview:function(e){this.dialogInspectionReportImageUrl=e.url,this.dialogInspectionReportVisible=!0},handleInspectionReportRemove:function(e,t){for(var r in this.picInspectionReportListPhoto)this.picInspectionReportListPhoto[r].key===e.uid&&this.picInspectionReportListPhoto.splice(r,1);this.fileInspectionReportLists=t},handleChangeInspectionReportPhoto:function(e,t){this.fileInspectionReportLists=t},fileInspectionReportDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgInspectionReportLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},handleBasePicturePreview:function(e){this.dialogBasePictureImageUrl=e.url,this.dialogBasePictureVisible=!0},handleBasePictureRemove:function(e,t){for(var r in this.picBasePictureListPhoto)this.picBasePictureListPhoto[r].key===e.uid&&this.picBasePictureListPhoto.splice(r,1);this.fileBasePictureLists=t},handleChangeBasePicturePhoto:function(e,t){this.fileBasePictureLists=t},fileBasePictureDelIdPhoto:function(e,t){var r=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){r.row.delFileIds.push(t),r.imgBasePictureLists.splice(e,1)})).catch((function(){r.$message({duration:1e3,type:"info",message:"已取消操作"})}))},closeDialog:function(){this.row={},this.srcList=[],this.srcList2=[],this.picInspectionReportListPhoto=[],this.imgInspectionReportLists=[],this.fileInspectionReportLists=[],this.picBasePictureListPhoto=[],this.imgBasePictureLists=[],this.fileBasePictureLists=[],this.activeName="first",this.getAllList(),this.$refs.row.clearValidate()},editRow:function(e){if(this.row=e,this.row.delFileIds=[],e.reportPictureList&&0!==e.reportPictureList.length){this.imgInspectionReportLists=e.reportPictureList;for(var t=0;t<this.imgInspectionReportLists.length;t++)this.srcList.push(this.baseUrl+this.imgInspectionReportLists[t].url)}if(e.basePictureList&&0!==e.basePictureList.length){this.imgBasePictureLists=e.basePictureList;for(var r=0;r<this.imgBasePictureLists.length;r++)this.srcList2.push(this.baseUrl+this.imgBasePictureLists[r].url)}this.dialogShow=!0,this.flag="edit"},addRow:function(){this.dialogShow=!0,this.flag="add"},searchRow:function(){this.currentPage=1,this.getAllList()},deleteList:function(){var e=this;this.$confirm("此操作将删除选中的数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function t(){var r,a,i,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(r=[],a=0;a<e.selectRows.length;a++)i=e.selectRows[a],r.push(i.id);return t.next=4,e.$http.post("zsSys/BaseInfo/batchDelete",r);case 4:if(s=t.sent,n=s.data,200===n.status){t.next=8;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"删除生产基地失败！"}));case 8:e.$message({duration:2e3,type:"success",message:"删除生产基地成功！"}),e.clearFilter(),e.getAllList();case 11:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({duration:1e3,type:"info",message:"已取消操作"})}))},submitRow:Object(n["a"])((function(){var e=this;this.row.baseType="加工基地",this.row.enterpriseId=window.sessionStorage.getItem("enterpriseId"),this.$refs.row.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var a,i,s,n,o,l,c,u,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("信息填写不完整或不准确，请检查再提交！"));case 2:for(i in a=new FormData,e.row)s=e.row[i],"reportPictureList"===i||"basePictureList"==i||null!==s&&a.append(i,s);if(null!=e.fileInspectionReportLists)for(n=0;n<e.fileInspectionReportLists.length;n++)a.append("reportPictureFiles",e.fileInspectionReportLists[n].raw);if(null!=e.fileBasePictureLists)for(o=0;o<e.fileBasePictureLists.length;o++)a.append("basePictureFiles",e.fileBasePictureLists[o].raw);if("add"!==e.flag){t.next=18;break}return t.next=9,e.$http.post("zsSys/BaseInfo/addDataAndFile",a);case 9:if(l=t.sent,c=l.data,200===c.status){t.next=13;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"新增生产基地失败！"}));case 13:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"新增生产基地成功！"}),t.next=28;break;case 18:if("edit"!==e.flag){t.next=28;break}return t.next=21,e.$http.put("zsSys/BaseInfo/updateDataAndFile",a);case 21:if(u=t.sent,d=u.data,200===d.status){t.next=25;break}return t.abrupt("return",e.$message({duration:2e3,type:"error",message:"修改生产基地失败！"}));case 25:e.getAllList(),e.dialogShow=!1,e.$message({duration:2e3,type:"success",message:"修改生产基地成功！"});case 28:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),3e3),areaChange:function(e){this.$set(this.row,"area",e.target.value)},lenderPhoneChange:function(e){this.$set(this.row,"lenderPhone",e.target.value)}}},l=o,c=r("2877"),u=Object(c["a"])(l,a,i,!1,null,"f8aa58e0",null);t["default"]=u.exports},fb6a:function(e,t,r){"use strict";var a=r("23e7"),i=r("861d"),s=r("e8b5"),n=r("23cb"),o=r("50c4"),l=r("fc6a"),c=r("8418"),u=r("b622"),d=r("1dde"),p=r("ae40"),h=d("slice"),g=p("slice",{ACCESSORS:!0,0:0,1:2}),m=u("species"),f=[].slice,b=Math.max;a({target:"Array",proto:!0,forced:!h||!g},{slice:function(e,t){var r,a,u,d=l(this),p=o(d.length),h=n(e,p),g=n(void 0===t?p:t,p);if(s(d)&&(r=d.constructor,"function"!=typeof r||r!==Array&&!s(r.prototype)?i(r)&&(r=r[m],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return f.call(d,h,g);for(a=new(void 0===r?Array:r)(b(g-h,0)),u=0;h<g;h++,u++)h in d&&c(a,u,d[h]);return a.length=u,a}})},fd31:function(e,t,r){}}]);
//# sourceMappingURL=about.a9bf0ccd.js.map