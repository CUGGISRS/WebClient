(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29af794f"],{"3b7a":function(e,t,a){},4536:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article-page"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("农产品追溯信息系统")]),a("el-breadcrumb-item",[e._v("文章管理")])],1),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"文章管理",name:"first"}}),a("el-tab-pane",{attrs:{label:"未发布文章管理",name:"second"}})],1),a("el-card",{staticClass:"article-card"},[a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete"},on:{click:function(t){return e.handleBatchRemoveArticle()}}},[e._v("批量删除文章")]),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-circle-plus"},on:{click:e.addArticle}},[e._v("添加文章")]),a("el-select",{staticClass:"article-select-admin",attrs:{placeholder:"请选择文章类型"},on:{change:e.selectArticleTypeList},model:{value:e.articleType,callback:function(t){e.articleType=t},expression:"articleType"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-input",{staticStyle:{width:"120px","margin-left":"10px"},attrs:{size:"small",clearable:"",placeholder:"标题"},model:{value:e.listQuery.title,callback:function(t){e.$set(e.listQuery,"title",t)},expression:"listQuery.title"}}),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"0.5rem"},attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v(" 查询 ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{height:e.curHeight,data:e.articleList,border:"",stripe:"",fit:"","highlight-current-row":"","row-style":{height:"5px"},"cell-style":{padding:"5px 0"}},on:{"selection-change":e.checkSelect}},[a("el-table-column",{attrs:{type:"selection",width:"40",label:"全选"}}),a("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s((e.pageNum-1)*e.pageSize+t.$index+1)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"标题","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{attrs:{effect:"light",content:t.row.title,placement:"top"}},[a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return e.editDialogRow(t.row.id)}}},[e._v(e._s(t.row.title))])],1)]}}])}),a("el-table-column",{attrs:{align:"center",label:"浏览量",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.hasOwnProperty("pageviews")?a("el-tag",{attrs:{type:"success"}},[e._v(" "+e._s(t.row.pageviews))]):a("el-tag",{attrs:{type:"success"}},[e._v("0")])]}}])}),a("el-table-column",{attrs:{align:"center",label:"文章状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return["first"===e.activeName?a("el-button",{staticStyle:{width:"80px"},attrs:{type:"success",size:"mini"},on:{click:function(a){return e.handleModifyStatus(t.row,0)}}},[e._v(" 已发布 ")]):e._e(),"second"===e.activeName?a("el-button",{staticStyle:{width:"80px"},attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleModifyStatus(t.row,1)}}},[e._v(" 待发布 ")]):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",label:"发布时间",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.pub_time)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"作者",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.author))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.editDialogRow(t.row.id)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.deleteRow(t.row)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[15,20,25,30],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{staticClass:"row-form",attrs:{title:"文章管理",center:"",visible:e.dialogShow,top:"7vh",width:"80%"},on:{close:function(t){return e.DialogClose()},"update:visible":function(t){e.dialogShow=t}}},[a("el-form",{ref:"addFormRef",staticClass:"demo-ruleForm",attrs:{model:e.row,"label-width":"100px",rules:e.rules}},[a("el-tabs",{attrs:{type:"border-card"}},[a("el-tab-pane",{attrs:{label:"基本信息"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章分类:",prop:"articleTypeid"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"请选择文章分类"},on:{change:e.selectArticleType},model:{value:e.row.articleTypeid,callback:function(t){e.$set(e.row,"articleTypeid",t)},expression:"row.articleTypeid"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章作者:",prop:"author"}},[a("el-input",{attrs:{clearable:"",maxlength:"20",placeholder:"请输入文章作者"},model:{value:e.row.author,callback:function(t){e.$set(e.row,"author",t)},expression:"row.author"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"发布系统:",prop:"systemId"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择发布系统"},model:{value:e.row.systemId,callback:function(t){e.$set(e.row,"systemId",t)},expression:"row.systemId"}},e._l(e.sysOptions,(function(e){return a("el-option",{key:e.label,attrs:{label:e.label,value:e.label,disabled:e.disabled}})})),1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章状态:",prop:"articleStatus"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.row.articleStatus,callback:function(t){e.$set(e.row,"articleStatus",t)},expression:"row.articleStatus"}},[e._v("立即发布")]),a("el-radio",{attrs:{label:"0"},model:{value:e.row.articleStatus,callback:function(t){e.$set(e.row,"articleStatus",t)},expression:"row.articleStatus"}},[e._v("暂存未发布")])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"文章标题:",prop:"title"}},[a("el-input",{attrs:{clearable:"",maxlength:"50",placeholder:"请输入文章标题"},model:{value:e.row.title,callback:function(t){e.$set(e.row,"title",t)},expression:"row.title"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"发布时间:",prop:"pubTime"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间","value-format":"yyyy-MM-dd HH:mm:ss"},on:{input:function(t){return e.$forceUpdate()}},model:{value:e.row.pubTime,callback:function(t){e.$set(e.row,"pubTime",t)},expression:"row.pubTime"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"文章内容:",prop:"content"}},[a("quill-editor",{ref:"myTextEditor",staticClass:"editor",attrs:{options:e.editorOption},model:{value:e.row.content,callback:function(t){e.$set(e.row,"content",t)},expression:"row.content"}})],1)],1)],1)],1)],1),a("span",{staticClass:"t-btn"},[a("el-button",{attrs:{type:"info"},on:{click:function(t){e.dialogShow=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"success"},on:{click:e.submitRow}},[e._v("提 交")])],1)],1)],1)],1)},r=[],l=(a("7db0"),a("4160"),a("d81d"),a("fb6a"),a("d3b7"),a("6062"),a("3ca3"),a("159b"),a("ddb0"),a("96cf"),a("1da1")),s=a("2909"),n=a("a66f"),o=a("5e5d"),c={data:function(){return{listQuery:{title:""},flag:"add",pageNum:1,pageSize:15,listLoading:!1,sysType:"追溯信息系统",articleType:"政策法规",status:1,total:0,articleList:[],activeName:"first",row:{articleTypeid:"",author:"",articleStatus:"1",title:"",content:"",simple:"",systemId:[],pubTime:""},curHeight:0,ids:[],dialogShow:!1,editorOption:{modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]]},placeholder:"请在这里添加文章内容",readyOnly:!1,theme:"snow",syntax:!0},rules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"}],pubTime:[{required:!0,message:"请选择日期和时间",trigger:"change"}],content:[{required:!0,message:"请输入文章内容",trigger:"blur"}],systemId:[{required:!0,message:"请选择系统分类",trigger:"blur"}],articleTypeid:[{required:!0,message:"请选择文章分类",trigger:"blur"}],author:[{required:!0,message:"请输入作者",trigger:"blur"}],articleStatus:[{required:!0,message:"请输入状态",trigger:"blur"}]},options:o["c"],sysOptions:[{value:"1",label:"追溯信息系统",disabled:!1},{value:"2",label:"电子商务系统",disabled:!0},{value:"3",label:"公益性系统",disabled:!0}]}},created:function(){var e=this;this.getArticleList(),this.setTableHeight(),window.onresize=function(){e.setTableHeight()}},methods:{addArticle:function(){var e=this;this.row.articleTypeid=this.articleType,"政策法规"===this.row.articleTypeid?this.sysOptions.map((function(t){e.row.systemId.push(t.label)})):this.sysOptions.map((function(t){!1===t.disabled&&e.row.systemId.push(t.label)})),this.dialogShow=!0},setTableHeight:function(){var e=document.documentElement.clientHeight||document.body.clientHeight;this.curHeight=e-320},checkSelect:function(e){var t=this;e.forEach((function(e){t.ids.push(e.id)})),this.ids=Object(s["a"])(new Set(this.ids))},handleBatchRemoveArticle:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.ids.length){t.next=2;break}return t.abrupt("return",e.$message.warning("请先选中要删除的文章"));case 2:return t.next=4,e.$confirm("此操作将删除选中文章,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 4:if(a=t.sent,"confirm"===a){t.next=7;break}return t.abrupt("return",e.$message.info("已经取消删除"));case 7:e.ids.forEach((function(t){var a={id:t,sysType:e.sysType};n["a"].articleDelete(a).then((function(t){if(200!==t.status)return e.$message.error("删除文章失败");e.getArticleList()}))}));case 8:case"end":return t.stop()}}),t)})))()},handleClick:function(){this.pageNum=1,this.getArticleList()},selectArticleType:function(e){var t=this;this.row.systemId=[];var a={};a=this.options.find((function(t){return t.value===e})),this.row.articleTypeid=a.label,"政策法规"==this.row.articleTypeid?this.sysOptions.map((function(e){e.disabled=!1})):this.sysOptions.slice(1).map((function(e){e.disabled=!0})),"政策法规"===this.row.articleTypeid?this.sysOptions.map((function(e){t.row.systemId.push(e.label)})):this.sysOptions.map((function(e){!1===e.disabled&&t.row.systemId.push(e.label)})),this.getArticleList()},selectArticleTypeList:function(e){var t={};t=this.options.find((function(t){return t.value===e})),this.articleType=t.label,this.getArticleList()},handleFilter:function(){this.pageNum=1,this.getArticleList()},getArticleList:function(){var e=this,t="first"==this.activeName?"1":"0";this.listLoading=!0;var a={pageNum:this.pageNum,pageRow:this.pageSize,sysType:this.sysType,articleType:this.articleType,status:t};""!==this.listQuery.title&&(a.title=this.listQuery.title),n["a"].getArticleList(a).then((function(t){if(200!==t.status)return e.$message.error("获取文章列表失败");e.listLoading=!1,e.articleList=t.data.rows,e.total=t.data.total}))},handleSizeChange:function(e){this.pageSize=e,this.getArticleList()},handleCurrentChange:function(e){this.pageNum=e,this.getArticleList()},editDialogRow:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.flag="edit",i="first"==t.activeName?"1":"0",n["a"].getArticleId(e).then((function(a){var r=[];a.data.articleSysList.map((function(e){r.push(e.systemId)})),t.row.articleTypeid=a.data.articleSysList[0].articleTypeid,t.row.author=a.data.author,t.row.articleStatus=i,t.row.systemId=r,t.row.title=a.data.title,t.row.content=a.data.content,t.row.pubTime=a.data.pubTime,t.row.id=e,t.dialogShow=!0}));case 3:case"end":return a.stop()}}),a)})))()},deleteRow:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={id:e.id,sysType:t.sysType},a.next=3,t.$confirm("此操作将删除该文章,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((function(e){return e}));case 3:if(r=a.sent,"confirm"===r){a.next=6;break}return a.abrupt("return",t.$message.info("已经取消删除"));case 6:n["a"].articleDelete(i).then((function(e){if(200!==e.status)return t.$message.error("删除文章失败");t.$message.success("删除文章成功"),t.getArticleList()}));case 7:case"end":return a.stop()}}),a)})))()},DialogClose:function(){this.row={articleTypeid:"",author:"",articleStatus:"",title:"",content:"",systemId:[]},this.flag="add",this.$refs.addFormRef.resetFields()},submitRow:function(){var e=this;"add"==this.flag?this.$refs.addFormRef.validate((function(t){if(!t)return e.$message.error("信息填写不完整或不准确，请检查再提交！");e.row.simple=e.$refs.myTextEditor.quill.getText().substring(0,200),n["a"].articleAdd(e.row).then((function(t){if(200!==t.status)return e.$message.error("失败");e.$message.success("新增文章成功"),e.dialogShow=!1,e.getArticleList()}))})):"edit"==this.flag&&this.editArticleSubmit()},handleModifyStatus:function(e,t){var a,i=this;0===t&&(a="待发布"),1===t&&(a="已发布"),this.$confirm("是否将文章状态修改为 ".concat(a," ?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["a"].getArticleId(e.id).then((function(a){var r=[];r.push(i.sysType),i.row.articleTypeid=a.data.articleSysList[0].articleTypeid,i.row.author=a.data.author,i.row.articleStatus=t,i.row.systemId=r,i.row.title=a.data.title,i.row.content=a.data.content,i.row.id=e.id,n["a"].articleUpdate(i.row).then((function(e){if(200!==e.status)return i.$message.error("更新失败");i.getArticleList(),i.$message.success("更新成功")}))}))})).catch((function(){i.$message({type:"info",message:"已取消操作"})}))},editArticleSubmit:function(){var e=this;this.row.simple=this.$refs.myTextEditor.quill.getText().substring(0,200),this.$refs.addFormRef.validate((function(t){if(!t)return e.$message.error("信息填写不完整或不准确，请检查再提交！");n["a"].articleUpdate(e.row).then((function(t){if(200!==t.status)return e.$message.error("更新文章信息失败");e.dialogShow=!1,e.getArticleList(),e.$message.success("更新文章成功")}))}))}}},u=c,d=(a("c952"),a("2877")),p=Object(d["a"])(u,i,r,!1,null,null,null);t["default"]=p.exports},"5e5d":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return l}));var i=[{value:"1",label:"政策法规"},{value:"2",label:"农业要闻"},{value:"3",label:"灾害预警"},{value:"4",label:"种植技术"},{value:"5",label:"水产养殖"},{value:"6",label:"畜牧兽医"},{value:"7",label:"农机技术"},{value:"8",label:"科技要闻"}],r=[{value:"1",label:"政策法规"},{value:"2",label:"种植知识"},{value:"3",label:"农事指导"},{value:"4",label:"农业资讯"},{value:"5",label:"工作动态"}],l=[{value:"1",label:"政策法规"},{value:"2",label:"农业新闻"},{value:"3",label:"工作动态"},{value:"4",label:"监督管理"},{value:"5",label:"安全知识"}]},"7db0":function(e,t,a){"use strict";var i=a("23e7"),r=a("b727").find,l=a("44d2"),s=a("ae40"),n="find",o=!0,c=s(n);n in[]&&Array(1)[n]((function(){o=!1})),i({target:"Array",proto:!0,forced:o||!c},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),l(n)},c952:function(e,t,a){"use strict";var i=a("3b7a"),r=a.n(i);r.a}}]);
//# sourceMappingURL=chunk-29af794f.3a94572e.js.map